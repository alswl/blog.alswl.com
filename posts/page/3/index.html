<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Posts | Log4D</title>
<meta name="keywords" content="">
<meta name="description" content="Posts - Log4D">
<meta name="author" content="alswl">
<link rel="canonical" href="https://blog.alswl.com/posts/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fcb8ff387cda8551f3867e8c0e2af5aae9b5df9ce2e143e58af5cd709b4e94a3.css" integrity="sha256-/Lj/OHzahVHzhn6MDir1qum135zi4UPlivXNcJtOlKM=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://blog.alswl.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.alswl.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.alswl.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://blog.alswl.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://blog.alswl.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://blog.alswl.com/posts/atom.xml">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-8822123-3', 'auto');
	
	ga('send', 'pageview');
}
</script><meta property="og:title" content="Posts" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://blog.alswl.com/posts/" /><meta property="og:site_name" content="Log4D" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Posts"/>
<meta name="twitter:description" content=""/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://blog.alswl.com/posts/"
    }
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.alswl.com" accesskey="h" title="Log4D (Alt + H)">Log4D</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://en.blog.alswl.com/" title="English Blog">
                    <span>English Blog</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://blog.alswl.com/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://blog.alswl.com/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://blog.alswl.com/archives/" title="存档">
                    <span>存档</span>
                </a>
            </li>
            <li>
                <a href="https://blog.alswl.com/about/" title="关于我">
                    <span>关于我</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="https://blog.alswl.com">Home</a></div>
  <h1>
    Posts
  </h1>
</header>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>当我们在聊监控，我们在聊什么？
    </h2>
  </header>
  <div class="entry-content">
    <p>最近在团队中给大家做了一个分享，泛泛地聊了一些有关「监控」的话题。 其实做分享对分享者的作用往往大于参与者。 这是一次将自己知识的梳理的过程，于是我将这次分享整理成这篇文章。
目的 🎯 我们先来聊聊，什么是「监控」，以及我们期望通过「监控」完成哪些目的？
传统意义上的监控，是指：
通过一些手段和工具，关注运行中的硬件、软件、用户体验的关键数据，将其暴露出来。 当关键数据出现异常时候发出警告，进行人工或者自动的响应。
我们平时看到的最常见的监控系统，比如 Zabbix，提供了丰富的模板， 可以监控服务器的 Load / CPU Usage / Alive 这些常规指标。 并在出现问题时候，对其进行报警通知。 随后运维工程师们会上线进行应急操作，case by case 的处理故障。
我将上面的使用目的归纳为：
故障发生时提供数据报警 提供历史数据以供分析 故事到这里似乎可以结束了，可监控真的是这么简单的么？ 当然没，随着时代的进步，用户对服务提出了更为严苛的要求， 同时我们也有能力进一步控制平均故障修复时间 （MTBF）， 上述描述的做法已经不能满足我们了。
现在让我们切换一下视角，从传统的 OPS 的视角切换到 SRE （Site Reliability Engineering）的视角。 当我们在关注网站整体的可用性时，我们会发现： 故障警报处理当然很重要，但是我们根本上想减少甚至避免 MTBF。 我们有两种手段： 一种是去除单点故障，让问题自然发生，但是不对线上造成影响； 另一种是在问题出现的早期就发现并进行及时修复。 前者是高可用范畴，后者就是我们今天关注的「监控」了。
监控的目的是要将灾难消灭在襁褓里；在灾难即将出现或者发生问题时， 给大家展示直接的原因。
那为了达成这两个目标，我们需要回到问题的本质，重新思考两个问题：
监控哪些对象？ 如何识别故障？ 对象 🐘🐘 我们说的监控对象，一般指的都是某个资源， 资源即持有某种其他方需要的某些属性的载体，包括硬件、软件。 除了资源这种类型，还有一种常见的监控对象是「体验」，即终端用户的访问感受， 这块内容我们暂时略去。
让我们来先看一下常见的资源：
硬件 服务器 网络设备 软件 Application Infrastructure 这个分类是粗粒度的描述，为了落地地描述监控对象对象的健康状况， 我们还要进一步细化。以「服务器」为例，我们可以将其监控的内容细化为以下监控项：
CPU Memory Network interface Storage devices Controllers 如何评估这些监控项的健康状况？我们使用 SLI（Service Level Indicator）。 比如可用性就是一个最容易理解的 SLI。 这里我将资源归为两类，面向用户提供服务的资源和面向存储的资源， 以下是针对这两类资源的常见 SLI：...</p>
  </div>
  <footer class="entry-footer"><span title='2017-06-08 15:40:41 +0800 +0800'>2017-06-08</span>&nbsp;·&nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to 当我们在聊监控，我们在聊什么？" href="https://blog.alswl.com/2017/06/monitoring-introducing/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>XSS 攻击的处理
    </h2>
  </header>
  <div class="entry-content">
    <p>这是一年前写的项目笔记，一直在我的待办事项里等待做总结，今天偶然翻到，就整理成文章发出来。 谨以此文怀念 乌云。
事情缘由 春节前的某一天，收到一封来自乌云（国内知名白帽子团队）的邮件， 告知我厂网站上出现一例 XSS 漏洞。 因为以前对 XSS 输入做过防御，还以为是某个前端 DOM 上的 XSS 漏洞， 后来仔细一看，不妙，是个影响甚大的存储型 XSS 漏洞。
这里简单科普一下 XSS 跨网站脚本 -维基百科，自由的百科全书 中介绍到：
跨网站脚本（Cross-site scripting，通常简称为XSS或跨站脚本或跨站脚本攻击）是一种网站应用程序的安全漏洞攻击，是代码注入的一种。 它允许恶意用户将代码注入到网页上，其他用户在观看网页时就会受到影响。这类攻击通常包含了HTML以及用户端脚本语言。
XSS 攻击可以分成两种，反射性 XSS / 存储型 XSS。前者是需要用户触发的 XSS， 针对当前用户的攻击行为。而后者存储型 XSS 则更为严重，一旦攻击代码被保存， 所有访问被攻击的页面，都会触发用户被攻击行为。
这次爆出的问题就是最严重的存储型 XSS，意味着每个访问到有问题页面的用户都会中招。 时间紧迫，问题必须被解决。
XSS 实现手段 在解决问题之前，需要对这个问题有必要的基础认识。 我们先看看 XSS 攻击是如何工作的，以及攻击者的目的是什么。
XSS 的原理是通过构造特殊的数据，并通过传递参数或者保存表单数据的方式， 让这些构建的数据破坏 DOM 结构，从而让自己预先构造数据中的 JS 脚本被执行。
检查存储型 XSS 漏洞的方法，可以在对应的 input field 里放入一些构造的数据，如果保存后可以被执行，就说明存在 XSS 漏洞。
常见的检测方法（来自 跨网站脚本 - 维基百科，自由的百科全书：
&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt; =&#39;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt; &#34;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt; &lt;script&gt;alert(document.cookie)&lt;/script&gt; &lt;script&gt;alert (vulnerable)&lt;/script&gt; %3Cscript%3Ealert(&#39;XSS&#39;)%3C/script%3E &lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt; &lt;img src=&#34;javascript:alert(&#39;XSS&#39;)&#34;&gt; &lt;img src=&#34;http://xxx....</p>
  </div>
  <footer class="entry-footer"><span title='2017-05-31 22:04:00 +0800 +0800'>2017-05-31</span>&nbsp;·&nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to XSS 攻击的处理" href="https://blog.alswl.com/2017/05/xss/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>👁️ 预测未来？
    </h2>
  </header>
  <div class="entry-content">
    <p>拉普拉斯之妖 未来是可以被预测的么？
专家在预测股票趋势变化，天气预报员可以预测未来一周甚至更长时间的天气。 如果给他们更多的信息和参数，是否可以将未来预测的更准确？ 如果精确的粒度可以达到基本粒子级别，同时给一个计算力超群的计算器，能否精确的推衍未来变化？
这些想法在我刚接触经典力学时浮现，学习了牛顿三定律之后，异常激动。 感觉人类可以凭借技术的进步，逐步对未来精确预测。彼时可以解决人类即将遇到的任何问题了，化问题于无形。
这想法其实在 200 年前就出现了。法国伟大的数学家拉普拉斯（Laplace）在他的著作「概率论」里面， 提出了这样的观点：
我们可以把宇宙现在的状态视为其过去的果以及未来的因。假若一位智者会知道在某一时刻所有促使自然运动的力和所有组构自然的物体的位置，假若他也能够对这些数据进行分析，则在宇宙里，从最大的物体到最小的粒子，它们的运动都包含在一条简单公式里。对于这位智者来说，没有任何事物会是含糊的，并且未来只会像过去般出现在他眼前。
「根据当前已知即可预测未来」，这种决定论，就是拉普拉斯之妖。
打破 除了拉普拉斯的决定论，这个世纪末还发生了另外一件事情。 开尔文男爵在 19 世纪的最后一天，发表了「物理大厦已经落成，所剩只是一些装饰性工作」的言论。 然而，在随后的岁月里，经典物理大厦却开始被量子力学逐步击破，轰然倒地。
在决定论这个方面，根据海森堡的不确定性理论，粒子的位置与动量不可同时被确定。 这个结论说明目前技术下面，无法精准测量粒子的状态。 既然无法准确测量粒子的状态，就失去了演算未来可能性的基础，更无法预测未来了。
那既然是无法预测，是否表示，预测未来这件事情是无稽之谈，未来是不成规律的？
混沌：被理解错误的「蝴蝶效应」 针对未来的预测，动力系统中，有相当多的研究和思考，其中比较注明的一项是：蝴蝶效应。
关于「蝴蝶效应」，不用过多解释。命名的来源据说是发现者 Edward Lorenz 觉得图形像是蝴蝶。 而有另一种另一说法是，Edward 的一个比喻「巴西蝴蝶煽动，引起德克萨斯的龙卷风」。
事实上这种说法是不精准的。Edward 在预测天气模型中，发现起始数据的微小差异， 会导致数日之后计算结果的巨大差异。 从点在于在预测模型上，忽略了一个蝴蝶煽动引起的力量，即起始条件的设定，会导致结果的巨大差异。 而不是表名龙卷风是蝴蝶煽动产生的。
如果蝴蝶煽动能够产生龙卷风。那么一个普通人的呼吸，也可以造成同样的效果。😂
分形和混沌 和混沌相关的，还有一个重要概念「分形」：
一个粗糙或零碎的几何形状，可以分成数个部分，且每一部分都（至少近似地）是整体缩小后的形状”[2]，即具有自相似的性质。分形的核心是自相似。
随机从这种自相似的图形中提取样本，样本集表现出不可预测的特性。
混沌的定义：
非线性系统在一定参数条件下展现分岔（bifurcation）、周期运动与非周期运动相互纠缠，以至于通向某种非周期有序运动。这种运动是不可预测，呈现出失序的状态。三体问题，即是一例混沌的场景。
为什么混沌和分形是具有相关性的呢？这里有一个重要概念 IFS。 IFS（Iterated Function System）是迭代函数系统，即在数学上被认为一个完全向量空间上收缩映射的有限集。 分形的图案，部分可以抽象出 IFS 公式。
这个公式的奇妙之处是在于，在公式渐进推算过程之中，初始看到的结果是混沌无序的，而在逐步运算之后，可以看出分形的特征。
下图是根据一个 IFS 公式，逐步构造出一个分形图片的过程：
图片来自 Wikipedia https://en.wikipedia.org/wiki/Iterated_function_system
这种由初期混沌，逐渐表现为分形的情况，被学者总结为：「混沌在（生成）时间上是分形的；而分形的在空间（展示）上是混沌的。」 混沌中可以找到有序，在非线性中找到理性，混沌中可以演化出非规则，也可以演化出在规则中混沌。
哲学上的象征 感谢你迷迷糊糊的读到这里，混沌不仅仅在数学和物理上面，吸引着一代代人的探索。 在哲学生活指导方面，也有重大的意义。早在古人说「分久必合，合久必分」， 就是一种稳定线性的表现，具有预测性的表现。 而「一生二、二生三，三生万物」则体现了古人对分形的理解。 经典的「马蹄毁了一场战争」故事，讲的是混沌理论。
这些对未来预测能力的渴望，表现了对生活的掌控欲望，对未来可行性的探索， 在低谷期可以带来希望，大跃进时期可以带来警醒。
对于我个人而言，虽然失去了能够预测未来的理论基础而略感遗憾。 但是反过来想想，如果真的发明了一台机器，能够精确预言到未来， 那么在发明实现的当天，就能够推衍出未来所有出现的科学理论、文学、艺术创作， 那给后人创造了一个多么再无新事物的未来，这该是一个多么无趣的世界啊。</p>
  </div>
  <footer class="entry-footer"><span title='2017-01-31 11:12:43 +0800 +0800'>2017-01-31</span>&nbsp;·&nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to 👁️ 预测未来？" href="https://blog.alswl.com/2017/01/prophecy/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>👷如何做年前大扫除
    </h2>
  </header>
  <div class="entry-content">
    <p>今年过年特别早，离春节只剩下二十多天了。 为期 7 天的春节里，工程师们不上班，那万一线上业务出现了故障怎么办？ 大公司的朋友们会安排专门的人进行值班（此处心疼一下那些需要大年三十还要值班保证高峰的工程师们）， 而作为创业团队人少，难做到在线值守，就需要对线上进行一些整理盘点，找出潜在问题，为春节长假做一些准备。
我们称之为年前大扫除。
大扫除需要做些什么呢，且听我一一道来。
PS: 冷知识，大扫除英文是 spring cleaning，所以春节大扫除是 Spring Festival spring cleaning。
大扫除的内容 大扫除其实是一个查漏补缺&#43;囤积粮草的事情。
查漏补缺，即找出潜在的问题。这些问题平时可能不会特意去查看， 借助大扫除这个运动，恰好进行盘点。 计算机的世界里，有一个方法论非常好使，在极多场景可以见到其身影：分层。 TCP 的七层模型，架构设计的 N 层 模型，都是对分层思想的使用。 查漏补缺也不例外，我们可以按照业务访问流程，将需要排查的问题拆分为：业务、应用、中间件、网络、物理、存储 etc。
通过分层，不仅仅完成了自上而下地遍历整个技术栈，也同时将不同模块的内容交给不同的责任方， 确保任务的分割。
分完模块，还要告知大家如何具体查找问题。 这里我介绍一个通用的方法：USE1：
For every resource, check Utilization, Saturation, and Errors.
USE 方法是从 Brend Gregg 那里学来的。 在技术设施的领域里，Resource 即是指各种类型的资源，比如 CPU、磁盘、网络、内存， Utilization 指的是使用率，可以简单分为百分制和非百分制。 Saturation 是指饱和率，支持 queue 的资源，就会有这个指标。 Error 即错误，可以从错误统计和日志得知。2
业务领域里面，USE 也有相对应的含义。以审核系统举例， 对应的 USE 可以理解为「审核应用实例跑的 CPU 占用如何，任务队列是否塞满，业务日志是否有异常」。
除了 USE 里面提到的指标，还有几个指标特别重要： TPS 、Latency 和 Capacity。 这几个指标对性能敏感的尤为重要。 检查 USE 的同时，我们必须关注一下这三个指标， 确保 TPS / Latency 是否满足我们预期的 SLA。 哦？压根没有制定 SLA，不要慌，和历史数据对比，先制定一个粗糙的 SLA。 哦？连历史数据都没有？那只能找你 Leader 让他考量一下了。...</p>
  </div>
  <footer class="entry-footer"><span title='2017-01-03 23:20:50 +0800 +0800'>2017-01-03</span>&nbsp;·&nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to 👷如何做年前大扫除" href="https://blog.alswl.com/2017/01/spring-cleaning/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>🔑 也谈 HTTPS - 如何内测
    </h2>
  </header>
  <div class="entry-content">
    <p>(图片来自 茶杯中的可爱小白鼠 壁纸 - 2560x1920－堆糖，美好生活研究所)
在上篇文章 🔒 也谈 HTTPS - HTTPDNS &#43; HTTPS 中， 我们谈了如何基于 HTTPDNS 来部署无坚不摧的 HTTPS 通信环境， 这次我们讨论另外一个比较头疼的问题：部署。
小站点部署 HTTPS 相对成本低，改改前端代码，就可以上线了。 但作为业务有一定复杂度的大网站，就没办法这么暴力上线了。
前端在基础库中调整 Scheme 之后，仍然可能存在很多边边角角没有覆盖到。 比如 JS 里面写死了 HTTP，那在 HTTPS 下请求 HTTP XHR 的话， 浏览器会将请求拦截掉。 一旦出现这种故障，用户就无法正常使用业务，小白用户往往也不懂得自己将 https:// 换成 http:// 使用。
解决的思路是足够的内测，找一群人帮我在 HTTPS 环境下使用足够长时间。 让他们当小白鼠，提前发现问题并解决。 于是，我把目光转向了身边的一大大群小白鼠，整个办公室的同事~😄
没错，我要强制所有同事使用 HTTPS 的公司网站，从而靠他们帮我发现问题。
靠发邮件、QQ 广播呼吁大家使用 HTTPS 站点的方法，估计是不行的。 没有利益驱动，推动力是不足的，我必须想点强制的手段让他们使用 HTTPS。
有三种方法来达到这个效果：
业务系统内入口判断用户身份，是雇员的话，切换到 HTTPS Nginx 入口系统判断 IP 来源，办公室 IP 则切换到 HTTPS 改造办公室网络，访问站点时候，自动切换到 HTTPS 为了避免对线上业务系统、基础设施造成影响，我采用了第三条方案。...</p>
  </div>
  <footer class="entry-footer"><span title='2016-12-08 20:16:26 +0800 +0800'>2016-12-08</span>&nbsp;·&nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to 🔑 也谈 HTTPS - 如何内测" href="https://blog.alswl.com/2016/12/https-2/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>教你在上海挑房子
    </h2>
  </header>
  <div class="entry-content">
    <p>点开的同学别失望，这并不是教你如何快速致富的 😂 ……
上海政府在 11-28 出了房屋新政 via，对房价进行进一步调控。 其核心思想是「认房又认贷」。3 月份的政策 via 是限制购房资格。 这次 11 月份调整则是提高二套房首付比例。 双管齐下，进一步给上海房市进行降温。
在这种严苛的政策下面，如何挑选一套自己满意，家人住得安心的房子就尤为关键了。 我对房市一直比较关注，也曾有几位朋友咨询我的一些经验。之前我是将 Evernote 笔记链接贴给别人，这次我就详细讲讲，如何在上海挑房子。
第一步，是建立有价值的 Indicator，并对具体房源进行计算。 Indicator 的含义是建立一系列评价指标，比如价格、户型、位置， 再根据这些 Indicator 给房源进行打分。 如果我是一个购房者，我挺希望我的置业顾问告诉我这套房有哪些优点、缺点，综合评价得几份。 （当然实际情况下这些置业顾问都是吹得天花乱坠，尽睁眼说瞎话。） 看房的过程可能长达数月，而人的记忆会随着时间逐步失真，只对最近看到的事物有深刻印象。 使用客观的数字评价房源，则可以进行精准的评价，避免产生主观臆断。
我使用的 Indicator 和评价细项罗列如下，供参考：
价格 面积 地理位置：内环、中环、外环 交通：离地铁距离，换乘便利性；多地铁线换乘； 户型：南北通透；客厅朝南；全明；户型方正；无暗室 装修：毛胚；简装；普通；精装；豪装 商圈：购物中心；超市；菜场 学区房 产权：满五唯一 楼层 房龄：5 / 10 / 15 / 20 政策发展前景 停车 第二步，就是和家人达成一致的期望，避免潜在的纠纷。 每个人对未来的住房有自己的期望，即便是一家人， 各自看中的点也不会太一样。不管平时家庭决策是什么流程，我都建议坐下来一起讨论讨论。 将 Indicator 依次列出，大家讨论各自心中的优先级。
除了优先级的讨论，还要考虑一下各自对 Indicator 划分等级的理解。 比如对房型、装修这两项，评价标准就会很模糊，这一切都需要讨论清楚。
我个人最为看中价格、位置、交通，可以放弃的有学区房、停车、户型。
第三步，划定圈子，判断趋势。 众多 Indicator 里面，价格是固定的，户型、楼层等是和具体房源相关的， 我们能够撬动的最重要因素，其实就是位置。
作为上海这个拥有 2500w 人口的超大型城市，是不可能把各个位置的房源都扫一遍的， 所以必须重点规划自己准备实地考察的区域。 那么我们就在上海地图上面划几个圈了，数据可以通过链家、中原地产等多网站收集。 安居客有一个大颗粒度的圈子，展示了社区集中点 via， 下图是我筛选条件之后形成的几个簇：...</p>
  </div>
  <footer class="entry-footer"><span title='2016-12-05 21:29:37 +0800 +0800'>2016-12-05</span>&nbsp;·&nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to 教你在上海挑房子" href="https://blog.alswl.com/2016/12/house/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>🔒 也谈 HTTPS - HTTPDNS &#43; HTTPS
    </h2>
  </header>
  <div class="entry-content">
    <p>最近谈论 HTTPS 的文章很多，其原因之一是运营商作恶底线越来越低，动不动就插播广告， 前两天小米还联合几家公司发文 关于抵制流量劫持等违法行为的联合声明 痛斥某些运营商。 另一方面也是苹果 ATS 政策的大力推动，逼迫大家在 APP 中全部使用 HTTPS 通信。 上 HTTPS 的好处很多：保护用户的数据不外泄，避免中间人篡改数据， 对企业信息进行鉴权。
关于 HTTPS 如何购买证书，如何部署，网上的教程已经太多了，实践起来没有太大的难处。 我们在部署 HTTPS 的时候，遇到了一些新问题，首当其冲的就是 HTTPS 部分网络不可访问的问题：
尽管使用了 HTTPS 技术，部分邪恶的运营商，仍然使用 DNS 污染技术，让域名指向的他们自己服务器 而这些服务器并没有部署 SSL 服务（就算部署了，也会触发 SSL 证书 Common name 不一致报警）， 导致 443 端口直接被拒绝。
这个问题不解决，强行上 HTTPS 的话，会导致一部分用户出现无法访问网站 一旦用户不爽了，轻则对产品不信任，重则直接导致用户流失。
运营商为了赚广告钱、省网间结算是不择手段的。 他们普遍使用的劫持手段是通过 ISP提供的 DNS 伪造域名。 那有没有什么方法可以解决 DNS 劫持呢？ 业界有一套解决这类场景的方案，即 HTTPDNS。
HTTPDNS 的原理很简单，将 DNS 这种容易被劫持的协议，转为使用 HTTP 协议请求 Domain &lt;-&gt; IP 映射。 获得正确 IP 之后，Client 自己组装 HTTP 协议，从而避免 ISP 篡改数据。...</p>
  </div>
  <footer class="entry-footer"><span title='2016-11-30 22:02:23 +0800 +0800'>2016-11-30</span>&nbsp;·&nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to 🔒 也谈 HTTPS - HTTPDNS &#43; HTTPS" href="https://blog.alswl.com/2016/11/https-1/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>API 集成测试实践
    </h2>
  </header>
  <div class="entry-content">
    <p>为了提高测试，工程师需要对自己提交的产物进行测试，一般是单元测试、集成测试。 之后提交物流转到 QA 团队，QA 团队根据需求描述对提交物进行测试， 这个测试过程非常耗费人力。 尤其是当开发交付的质量不高时候，很可能自身没有经过测试，会遇到主干流程都无法进行的状况。
如果在 QA 人工介入测试之前，就进行一轮黑盒自动化集成测试，可以大大地提高 QA 团队的工作效率。 基于这样的判断，我们团队花了一些时间，将基于 API 的自动化测试系统搭建起来。 现在将这个系统的选型和运行状况拎出来，和大家分享。
确认测试范围、目标和意义 范围 后台输出的 API 级别 URL 使用场景 打包时候的冒烟 Dev / QA 手工添加添加新特性用例 目标 覆盖大部分的 URL，当期设计为 top 10 URL，仅包含 GET 接口 选型时，需要考虑非幂等（POST / DELETE / PUT）等接口 意义 提高开发效率，一种自动化的 IT 测试方案 提高测试效率，减少人工集成测试成本 提高工程质量，通过覆盖率提升，保证工程质量逐步提升，放心开发新功能 特性需求 选型一个系统，不是看市面上有哪些可以供选择，而是看我需要什么样特性的一款产品。 如果自己的需求和市面上的现成产品差异过大，也可以考虑自己定制。
Required 开源 免费 使用 DSL 或者简单代码描述测试用例 支持细粒度的单 API 测试和构建带过程的测试用例 HTTP API Optional CI 集成 UI 挑选出来的选型和评价 API Monitoring and Testing · Runscope 收费 非开源 有监控特性 Bamboo - Continuous integration, deployment &amp; release management | Atlassian 收费 CI Continuous Integration Product and Features - CircleCI CI 收费 Sauce Labs 客户端测试，收费 Apiary API 设计工具 &#43; API Test http://frisbyjs....</p>
  </div>
  <footer class="entry-footer"><span title='2016-08-14 19:08:20 +0800 +0800'>2016-08-14</span>&nbsp;·&nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to API 集成测试实践" href="https://blog.alswl.com/2016/08/api-integration-test/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>搞定暴涨的流量
    </h2>
  </header>
  <div class="entry-content">
    <p>2013 年左右，我司业务发展迅速，每天晚上都会面临服务器濒临崩溃情况。 我相信每个高速发展的互联网企业在某个阶段都会面临这样的情形，比如去年爆红的「足迹」。 过程往往是：线上出现故障，手机会收到报警，然后登录到服务器上去解决问题。 处理这种问题工种现在有一个时髦的名称，叫做「SRE（Site Reliability Engineer）」系统可用性工程师。
虽然我常常救火，但是我还是想尽可能避免线上发生故障。「最好的消息，就是没有消息。」 减少故障出现概率，增强系统可用性，降低故障处理时间是 SRE 的最大课题。 在这里有最常用的两个手段，一个是优化性能，一个是做好容量规划和扩展。 这里我着重讨论后者「容量规划」。
^ 看我的一堆报警消息
面临的问题 面对暴涨流量，一边是业务方的满心欢喜，一边就是工程师的烦恼和压力了。 也许是一个受欢迎的功能上线了，或者是某个社会活动导致流量爆发，系统开始出现高延迟，磁盘 IO 不够用了。 也许是 DB 第一个倒下，也许是 RPC 系统第一个倒下…… 呃，大神可能会说，我艹，RPC 系统第一个倒下还搞个屁啊，赶紧倒闭算了。
核心的问题就是，在现有性能下面，在面临可能的大流量冲击时候，如何做到不慌不忙，能够 handle 住突如其来的流量？
设定容量目标 在解决这个问题之前，我们得先考虑清楚，我们到底要多强的流量处理能力。 如果今天我们只是一个两三台服务器的小团队，却企图设计一个能够抗住 1 亿 pv 访问的系统， 显然是不现实的，至少是不经济的。
衡量系统容量的指标可以简化为在什么流量下面，提供什么样的可用性保证。 一个实际的样例是，在 1 亿 pv 下面，提供 99.99% 的可用性， 其可用性的评判标准是「服务器在 200ms 内返回正确的数据」。
这里有一个重要的概念，可用性保证，术语是服务等级协议（SLA）。 这个指标可以从大部分标准云供应商的标准条款里看到，比如我司机房供应商提供的可用性保证是 99.9%。 阿里云 ECS 的 SLA 是「99.95%」，统计周期是 1 个月 （如果故障时间低于 5 min，不计入故障时间，云供应商都这样，特别霸权）。
一个对 SLA 的直观认识是（具体数据来自 High availability - Wikipedia, the free encyclopedia）：...</p>
  </div>
  <footer class="entry-footer"><span title='2016-06-19 23:57:39 +0800 +0800'>2016-06-19</span>&nbsp;·&nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to 搞定暴涨的流量" href="https://blog.alswl.com/2016/06/capacity-planning/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>一次「分答」记录
    </h2>
  </header>
  <div class="entry-content">
    <p>尝试在团队内部发起一次类似「分答」的沟通方式，一对一面聊。 回答其他工程师的问题，这种沟通的方式暨在提供一个特定的场合，帮助加强双方了解， 解决团队中其他工程师的一些实际的问题。
在征得对方同意之后，我将他的问题和我的回答 PO 出来。
喜欢什么游戏，玩游戏的问题 喜欢和人玩游戏，不喜欢和不认识网友玩游戏 小学从红月开始玩，传奇、CS、魔兽、真三、DOTA，大学时候和舍友玩游戏，毕业后不玩 minecraft 尝试着玩过，没有玩下去，找不到人 日活的桌面游戏，三国杀等蛮喜欢 不喜欢浪费时间，怕没控制 从玩游戏里面学习什么么？不，就是纯粹享受游戏，不会想这么多 喜欢什么语言 看场合，小东西，小场景用 Python，生产环境用 Java，生产环境又有时间，考虑 Scala 只允许选一门语言，就用 Python 最吸引的特点，熟悉程度高，生产效率高，第三方库丰富，粘合性强 为 Python 做一些功能扩展？不同时期答案会不一样，目前来说，希望有一个开发效率更高的 framework；有时间的话，会考虑如何绕过底层 GIL 问题 有什么事情投入精力，铩羽而归 工具向重的人，推广 git 花了两年，推广 Restful 不利 做业务开发 leader，和 tsu、小管一起做，项目管理、团队管理没做好，没做好，有挫败感。 职业迷茫期 我作为一个学渣，并且长期以来没有人给予职业生涯规划，一直对自己未来发展有困惑 如何在无领导的情况之下，探索未来道路，规划自己工作内容？跟优秀的人聊，跟外部的人聊，看博客，看书 迷茫是客观存在的，并且可能持续存在很久，正视它 现实中一定会遇到各种挑战和困难的，用挑战和困难填充自己，丰富自己的生活 迷茫是未知，有恐惧，有兴奋。对当前的我来说，恐惧可能更多，但是要面对 职业生涯里面，前期的同质度更高，资深工程师可以会给初级工程师规划清晰一些，但是越往后期，越难规划，需要自己探索 推荐书 https://book.douban.com/people/alswl/collect?sort=rating&amp;start=0&amp;filter=all&amp;mode=list&amp;tags_sort=count 学习来源 博客，infoq 等专业信息来源 书籍 周围的人 尽可能从每天时间挤出时间阅读 生活和工作平衡点 不同的人，同一个人的不同时期所需要的平衡不一样 对自己人生期望不一样的人，平衡点不一样 对我来说，目前阶段不存在明显边界，尽可能投入工作 如何保持激情 人总是有低谷期的，不可能一直保持亢奋，除非是甲亢 短期情绪会有起伏，长期来看，保持梦想和对自己高要求，可以帮助保持激情 我有低谷期，低谷期适合反思 如何擦屁股 现实是残酷的，总有屁股要擦，自己也有脏屁股，今天要给昨天的自己擦屁股 现实中存在脏屁股，尽可能了解它，看代码、文档，设计方案，了解的人，让自己变舒服 责任心的体现，做好当下的事情；解决这样的问题，解决当前的问题；避免留下脏屁股，设计好，规划好 责任心的话很虚。一个人做擦屁股、低产值的事情，从长远来看，是错的；短期需要撑下来；并且帮助团队避免这样的事情发生 最有成就感的事情 顶着家庭压力，到上海来 在堆糖改造环境，提升自己心智水平，不害怕问题，自信，自省 </p>
  </div>
  <footer class="entry-footer"><span title='2016-06-15 09:59:16 +0800 +0800'>2016-06-15</span>&nbsp;·&nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to 一次「分答」记录" href="https://blog.alswl.com/2016/06/q-and-a/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="https://blog.alswl.com/posts/page/2/">
      «&nbsp;Prev&nbsp;
    </a>
    <a class="next" href="https://blog.alswl.com/posts/page/4/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://blog.alswl.com">Log4D</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
