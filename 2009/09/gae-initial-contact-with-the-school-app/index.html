<!DOCTYPE html><html lang=en> <head><title>GAE+校内App初接触 - Log4D</title><!-- Using the latest rendering mode for IE --><meta http-equiv=X-UA-Compatible content="IE=edge"><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0"><meta http-equiv=Content-Security-Policy content=block-all-mixed-content><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link href=https://blog.alswl.com/2009/09/gae-initial-contact-with-the-school-app/ rel=canonical><meta name=author content=alswl><meta name=keywords content=Python,GAE,Google,人人><meta name=description content="下午刚有了在Google App Engine上写校内（人人网）App的想法，下午就迫不及待的开始动手。下面我以一个简单的Hello World来介绍一个开发步骤。 1.创建GAE应用 建立一个Google App Engine空间，需要一个Google帐号，仅此而已。拥有帐号，进入 App Engine ，激活这个服务，就可以创建新的应用。如何创建不是我这里要讲的重点，现在GAE支持简体中文版本，应该没有任何问题。 一个简单的App控制台 2.部署GAE App 刚才建立的GAE App其实还是空的，如果访问xxx.appspot.com时候，你会发现什么都出不来（按理应该是404页面，但是由于连404页面都没有设置 ，所以Nothing,检查http状态会发现返回的是404状态）。 这时候我们就要开始部署这个GAE App了：1.下载一个Google App Engine SDK for Python-Win，这样就可以在本地测试项目 …"><!-- Bootstrap --><link rel=stylesheet href=https://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css type=text/css><link href=https://cdn.staticfile.org/font-awesome/4.1.0/css/font-awesome.min.css rel=stylesheet><link href=https://blog.alswl.com/theme/css/pygments/native.css rel=stylesheet><link rel=stylesheet href=https://blog.alswl.com/theme/css/style.css type=text/css><link href=https://blog.alswl.com/atom.xml type=application/atom+xml rel=alternate title="Log4D Atom Feed"><link href=https://blog.alswl.com/rss.xml type=application/rss+xml rel=alternate title="Log4D RSS Feed"></head> <body> <div class="navbar navbar-default" role=navigation> <div class="container  col-lg-8 col-lg-offset-2"> <div class=navbar-header> <button type=button class=navbar-toggle data-toggle=collapse data-target=.navbar-ex1-collapse> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a href=https://blog.alswl.com/ class=navbar-brand> Log4D </a> </div> <div class="collapse navbar-collapse navbar-ex1-collapse"> <ul class="nav navbar-nav"> <li><a href=/tags/ >Tags</a></li> <li><a href=/links/ >Links</a></li> <li><a href=/about/ >About</a></li> </ul> <ul class="nav navbar-nav navbar-right"> <li><a href=https://blog.alswl.com/archives/ ><i class="fa fa-th-list"></i><span class=icon-label>Archives</span></a></li> </ul> </div> <!-- /.navbar-collapse --> </div> </div> <!-- /.navbar --> <div class=container> <div class=row> <div class="col-lg-8 col-lg-offset-2"> <section id=content> <article class=article-detail> <header class=page-header> <h1 class=title> <a href=https://blog.alswl.com/2009/09/gae-initial-contact-with-the-school-app/ rel=bookmark title="Permalink to GAE+校内App初接触"> GAE+校内App初接触 </a> </h1> <nav class="toc col-lg-2"> <div id=toc><ul><li><a class=toc-href href=#创建gae应用 title=1.创建GAE应用>1.创建GAE应用</a></li><li><a class=toc-href href=#部署gae-app title="2.部署GAE App">2.部署GAE App</a></li><li><a class=toc-href href=#校内应用 title=3.校内应用>3.校内应用</a></li><li><a class=toc-href href=#噩耗 title=4.噩耗>4.噩耗</a></li><li><a class=toc-href href=#结合 title=5.结合>5.结合</a></li></ul></div> </nav> </header> <div class=entry-content> <div class=panel> <div class=panel-body> <footer class=post-info> <span class="label label-default">Date</span> <span class=published> <i class="fa fa-calendar"></i><time datetime=2009-09-28T00:00:00+08:00> 2009-09-28</time> </span> <span class="label label-default">Tags</span> <a href=https://blog.alswl.com/tag/python/ >Python</a> / <a href=https://blog.alswl.com/tag/gae/ >GAE</a> / <a href=https://blog.alswl.com/tag/google/ >Google</a> / <a href=https://blog.alswl.com/tag/ren-ren/ >人人</a> </footer><!-- /.post-info --> </div> </div> <p>下午刚有了在Google App Engine上写校内（人人网）App的想法，下午就迫不及待的开始动手。下面我以一个简单的Hello World来介绍一个开发步骤。</p> <h2 id=创建gae应用>1.创建GAE应用</h2> <p>建立一个Google App Engine空间，需要一个Google帐号，仅此而已。拥有帐号，进入 <img alt="App Engine" src=https://www.google.com/accounts/ah/ah20x20.gif> <a href=http://code.google.com/appengine/ >App Engine</a> ，激活这个服务，就可以<a href=https://appengine.google.com/ >创建新的应用</a>。如何创建不是我这里要讲的重点，现在GAE支持简体中文版本，应该没有任何问题。</p> <p><img alt=image src=https://4ocf5n.dijingchao.com/upload_dropbox/200909/image3.png> 一个简单的App控制台</p> <h2 id=部署gae-app>2.部署GAE App</h2> <p>刚才建立的GAE App其实还是空的，如果访问xxx.appspot.com时候，你会发现什么都出不来（按理应该是404页面，但是由于连404页面都没有设置 ，所以Nothing,检查http状态会发现返回的是404状态）。</p> <p>这时候我们就要开始部署这个GAE App了：1.下载一个<a href=http://googleappengine.googlecode.com/files/GoogleAppEngine_1.2.5.msi>Google App Engine SDK for Python-Win</a>，这样就可以在本地测试项目，然后发布到 GAE。</p> <p>用这个GAE Launcher在本地创建了一个Application，注意标识符和你网上申请的要一致。然后会自动生成一个包含&rdquo;」Hello Word!「的main.py和app.yaml的文件夹。其中app.yaml的内容是用来配置项目的。</p> <p>相关链接：<a href=http://code.google.com/intl/zh-CN/appengine/docs/python/config/appconfig.html>app.yaml的具体设置</a></p> <p><img alt=xnapp_gae_launcher src=https://4ocf5n.dijingchao.com/upload_dropbox/200909/xnapp_gae_launcher2.jpg> 我创建了一个名为jasontidemo的App，并且启动服务器，可以进行浏览。</p> <p>在一切没有问题之后，我们就可以惦记Deploy部署这个项目了，这时候要输入帐号和密码，然后出现console控制台等待信息。出现下面提示时候，就说明上传成功 了。</p> <pre><code>Closing update: new version is ready to start serving.
Uploading index definitions.
Password for alswlwangzi@gmail.com: 2009-09-27 16:00:36 (Process exited with code 0)</code></pre> <p>这时候我们就可以打开xxx.appspot.com查看刚才部署的网站。</p> <h2 id=校内应用>3.校内应用</h2> <p>拥有校内帐号，就可以创建校内应用。第一步是需要安装一个名为「<a href=http://app.renren.com/developers/home.do>开发者</a>」 的应用。通过这个应用，可以链接到其他一些有帮助的内容：<a href=http://wiki.dev.renren.com/wiki/ >开放平台文档</a>、<a href=http://dev.renren.com/center/tools.do>测试工具</a>、<a href="http://group.renren.com/GetTribe.do?id=237768885">讨论区</a>。</p> <p>第二步是创建一个新的应用，按部就班的填上相关资料。</p> <p><a href=https://4ocf5n.dijingchao.com/upload_dropbox/200909/image51.png><img alt=image src=https://4ocf5n.dijingchao.com/upload_dropbox/200909/image5.png></a></p> <p>校内开发者，右上角可以申请开发应用（看讨论区貌似童鞋们都不满意这个开发平台呢）</p> <p><a href=https://4ocf5n.dijingchao.com/upload_dropbox/200909/xnapp_main2.jpg><img alt=xnapp_main src=https://4ocf5n.dijingchao.com/upload_dropbox/200909/xnapp_main.jpg></a></p> <p>我的应用程序，在这里可以编辑应用的属性</p> <p>创建之后，就可以填上Canvas的基本选项中的「应用展示地址」和「Canvas Callback URL」，后者就是实际的地址，我们将填上刚才的xxx.appspot.com这种形式的网址。</p> <p><a href=https://4ocf5n.dijingchao.com/upload_dropbox/200909/xnapp_config2.jpg><img alt=xnapp_config src=https://4ocf5n.dijingchao.com/upload_dropbox/200909/xnapp_config.jpg></a></p> <p>最后测试自己的应用，也就是刚才「应用展示地址」，形式类似于apps.renren.com/xxx/，就可以看到我们的应用了，这时候基本框架就差不多了。</p> <h2 id=噩耗>4.噩耗</h2> <p>此时当满天欢喜时候打开刚才的「应用展示地址」，你会惊奇的发现校内居然报错了，直接报了405错误。什么是405错误，就是服务器没有权限访问。</p> <p>我花了一下午时间才解决这个问题，因为问题可能出在校内，也可能是GAE的功能限制上。</p> <p>在appspot上测试这个应用是没有任何问题的</p> <p><a href=https://4ocf5n.dijingchao.com/upload_dropbox/200909/xnapp_show_ori1.jpg><img alt=xnapp_show_ori src=https://4ocf5n.dijingchao.com/upload_dropbox/200909/xnapp_show_ori.jpg></a></p> <p>显示的源码，其中的xnml校内服务器自己可以解析出来的，这段代码在校内测试工具也能通过</p> <p>调试之后，终于把问题锁定在get 和post上，具体原因是因为校内发起请求GAE服务器用的是Post方法，而我们的main.py中目前只相应get方法，导致了校内请求GAE Post方法，服务器没有这个方法调用，就返回了405错误。</p> <p>修复这个问题只给main.py的MainHandler这个类加上post方法</p> <pre><code>class MainHandler(webapp.RequestHandler):</code></pre> <p>def head(self, *args):</p> <p>return self.get(*args)</p> <p>def post(self):</p> <p>self.response.out.write&rsquo;Hello world!&rsquo;)</p> <h2 id=结合>5.结合</h2> <p>最后我加上一个简单的<xn:profile-pic></xn:profile-pic>来展示一下整个App</p> <p>下面我发布我的这个简单的Hello World!（其实因为要使用XNML，所以已经不是单纯的打出Hello World了）</p> <p>app.yaml：定义了main.py和404页面</p> <pre><code>application: jasontidemo
version: 1
runtime: python
api_version: 1</code></pre> <p>handlers:</p> <ul> <li><p>url: /<br> script: main.py</p></li> <li><p>url: /index.html<br> script: main.py</p></li> <li><p>url: /.*<br> script: not_found.py main.py：我把post 和get写的比较Dirty，其实可以封装在一个函数里的。</p> <p>import wsgiref.handlers from google.appengine.ext import webapp</p></li> </ul> <p>class MainHandler(webapp.RequestHandler):</p> <p>def head(self, *args):</p> <p>return self.get(*args)</p> <p>def post(self):</p> <p>self.response.out.write(&rsquo;&rsquo;&rsquo;<b>使用者的名称及其大中小三种头像：</b></p> <div style="text-align: center;"> <p>图片：</p> <p><xn:profile-pic linked=true size=tiny uid=loggedinuser></xn:profile-pic></p> <p><xn:profile-pic linked=true size=normal uid=loggedinuser></xn:profile-pic></p> <p><xn:profile-pic linked=true size=main uid=loggedinuser></xn:profile-pic></p> <p><br></p> <p>姓名：</p> <p><xn:name linked=true shownetwork=true uid=loggedinuser></xn:name></p> </div> <p>&rsquo;&rsquo;&rsquo;)</p> <p>def get(self):</p> <p>self.response.out.write(&rsquo;&rsquo;&rsquo;<b>使用者的名称及其大中小三种头像：</b></p> <div style="text-align: center;"> <p>图片：</p> <p><xn:profile-pic linked=true size=tiny uid=loggedinuser></xn:profile-pic></p> <p><xn:profile-pic linked=true size=normal uid=loggedinuser></xn:profile-pic></p> <p><xn:profile-pic linked=true size=main uid=loggedinuser></xn:profile-pic></p> <p><br></p> <p>姓名：</p> <p><xn:name linked=true shownetwork=true uid=loggedinuser></xn:name></p> </div> <p>&rsquo;&rsquo;&rsquo;)</p> <p>def main():</p> <p>application = webapp.WSGIApplication([(&rsquo;/.*&rsquo;, MainHandler)], debug=True)</p> <p>wsgiref.handlers.CGIHandler().run(application)</p> <p>if <strong>name</strong> == &lsquo;<strong>main</strong>&rsquo;:</p> <p>main() not_found.py：自定义的404页面，其实就是简单的在MainHandler里面的get加入简单的文本。</p> <pre><code>  def get(self):
    self.response.out.write('404 Not Found')</code></pre> <p>把这个GAE App部署，然后就可以在校内的apps.renren.com/xxx/使用这个应用了。</p> <p><a href=https://4ocf5n.dijingchao.com/upload_dropbox/200909/xnapp_show1.jpg><img alt=xnapp_show src=https://4ocf5n.dijingchao.com/upload_dropbox/200909/xnapp_show.jpg></a></p> <p>我的头像，按理应该有三个，我怀疑是校内的一个服务器出问题了，只刷出来两张。</p> <p><a href=https://4ocf5n.dijingchao.com/upload_dropbox/200909/xnapp_sidebar1.jpg><img alt=xnapp_sidebar src=https://4ocf5n.dijingchao.com/upload_dropbox/200909/xnapp_sidebar.jpg></a></p> <p>可以收藏这个应用，看到侧边栏的海绵宝宝了么？呵呵</p> </div> <!-- /.entry-content --> <hr> <div class=panel> <div class=panel-body> <small>原文链接: <a href=https://blog.alswl.com/2009/09/gae-initial-contact-with-the-school-app/ >https://blog.alswl.com/2009/09/gae-initial-contact-with-the-school-app/</a></small><br> <small>3a1ff193cee606bd1e2ea554a16353ee</small><br> <small>欢迎关注我的微信公众号：<a href="http://mp.weixin.qq.com/mp/getmasssendmsg?__biz=MzIyNTIwMTU3MQ==#wechat_webview_type=1&wechat_redirect">窥豹</a></small><br> <small><img src=https://4ocf5n.dijingchao.com/upload_dropbox/201605/qrcode_for_gh_17e2f9c2caa4_258.jpg></small> <small><img src=https://4ocf5n.dijingchao.com/upload_dropbox/meta/wechat-pay-s-crop.png></small> </div> </div> <hr> <section class=comments id=comments> <h2>Comments</h2> <div id=disqus_thread></div> <script type=text/javascript>
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'log4d'; // required: replace example with your forum shortname

                    var disqus_identifier = 'gae-initial-contact-with-the-school-app';
                var disqus_url = 'https://blog.alswl.com/2009/09/gae-initial-contact-with-the-school-app/';

            var disqus_config = function () {
                this.language = "en";
            };

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
        </script> <noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript> <a href=http://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a> </section> </article> </section> </div> <div class="col-lg-3 col-lg-offset-2" id=sidebar> <aside> <section> <ul class="list-group list-group-flush"> <li class=list-group-item><h4><i class="fa fa-home fa-lg"></i><span class=icon-label>Social</span></h4> <ul class=list-group id=social> <li class=list-group-item><a href=https://blog.alswl.com/atom.xml><i class="fa fa-rss-square fa-lg"></i> RSS</a></li> <li class=list-group-item><a href=https://twitter.com/alswl><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li> <li class=list-group-item><a href=https://github.com/alswl><i class="fa fa-github-square fa-lg"></i> Github</a></li> <li class=list-group-item><a href=http://weibo.com/alswlx><i class="fa fa-weibo fa-lg"></i> Weibo</a></li> </ul> </li> </ul> </section> </aside> </div> <div class=col-lg-3 id=sidebar> <aside> <section> <ul class="list-group list-group-flush"> <li class=list-group-item><a href=https://blog.alswl.com/ ><h4><i class="fa fa-home fa-lg"></i><span class=icon-label>Categories</span></h4></a> <ul class=list-group id=categories> <li class=list-group-item> <a href=https://blog.alswl.com/category/coding/ > <i class="fa fa-folder-open fa-lg"></i> Coding </a> </li> <li class=list-group-item> <a href=https://blog.alswl.com/category/efficiency/ > <i class="fa fa-folder-open fa-lg"></i> Efficiency </a> </li> <li class=list-group-item> <a href=https://blog.alswl.com/category/fun/ > <i class="fa fa-folder-open fa-lg"></i> Fun </a> </li> <li class=list-group-item> <a href=https://blog.alswl.com/category/internet/ > <i class="fa fa-folder-open fa-lg"></i> Internet </a> </li> <li class=list-group-item> <a href=https://blog.alswl.com/category/life/ > <i class="fa fa-folder-open fa-lg"></i> Life </a> </li> <li class=list-group-item> <a href=https://blog.alswl.com/category/managment/ > <i class="fa fa-folder-open fa-lg"></i> Managment </a> </li> <li class=list-group-item> <a href=https://blog.alswl.com/category/sre/ > <i class="fa fa-folder-open fa-lg"></i> SRE </a> </li> <li class=list-group-item> <a href=https://blog.alswl.com/category/thinking/ > <i class="fa fa-folder-open fa-lg"></i> Thinking </a> </li> <li class=list-group-item> <a href=https://blog.alswl.com/category/ui/ > <i class="fa fa-folder-open fa-lg"></i> UI </a> </li> <li class=list-group-item> <a href=https://blog.alswl.com/category/viewpoint/ > <i class="fa fa-folder-open fa-lg"></i> Viewpoint </a> </li> </ul> </li> </ul> </section> </aside> </div> </div> </div> <footer> <div class=container> <hr> <div class=row> <div class=col-xs-10>&copy; 2005-2022 alswl &middot; Powered by <a href=https://github.com/alswl/pelican-bootstrap3 target=_blank style="font-weight: bold">pelican-bootstrap3</a>, <a href=http://docs.getpelican.com/ target=_blank style="font-weight: bold">Pelican</a>, <a href=http://getbootstrap.com target=_blank style="font-weight: bold">Bootstrap</a>, <p> <small> <a href=http://creativecommons.org/licenses/by-nc-nd/4.0/ rel=license><img alt="Creative Commons License" style=border-width:0 src=https://4ocf5n.dijingchao.com/upload_dropbox/meta/by-nc-nd_4-0_80x15.png></a> Content licensed under a <a href=http://creativecommons.org/licenses/by-nc-nd/4.0/ rel=license>Creative Commons Attribution 4.0 International-NonCommercial-NoDerivatives License</a>, except where indicated otherwise. </small> </p> </div> <div class=col-xs-2><p class=pull-right><i class="fa fa-arrow-up"></i> <a href=#>Back to top</a></p></div> </div> </div> </footer> <script src=https://cdn.staticfile.org/jquery/1.11.0/jquery.min.js></script> <!-- Include all compiled plugins (below), or include individual files as needed --> <script src=https://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js></script> <!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) --> <!-- Disqus --> <script type=text/javascript>
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'log4d'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script> <!-- End Disqus Code --> <!-- Google Analytics --> <script type=text/javascript>

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-8822123-3']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script> <!-- End Google Analytics Code --> </body> </html>