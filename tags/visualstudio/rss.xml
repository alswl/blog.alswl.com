<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>visualstudio on Log4D</title>
    <link>https://blog.alswl.com/tags/visualstudio/</link>
    <description>Recent content in visualstudio on Log4D</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <lastBuildDate>Tue, 15 Feb 2011 00:00:00 +0800</lastBuildDate><atom:link href="https://blog.alswl.com/tags/visualstudio/rss.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>使用DataConnectionDialog来获取连接字符串</title>
      <link>https://blog.alswl.com/2011/02/dataconnectiondialog/</link>
      <pubDate>Tue, 15 Feb 2011 00:00:00 +0800</pubDate>
      
      <guid>https://blog.alswl.com/2011/02/dataconnectiondialog/</guid>
      <description>在系统开发中，数据库连接字符串经常被保存到.config/.ini等配置文件中，以提高系统的灵活性。上大学时候，为了实现灵活配置数据库的效果，用拼字符串的方 法来动态生成连接字符串，这种方法充满了Bad Smell。 昨天用CodeSmith时候，看到它的数据连接配置界面，如此的眼熟，如下图。 Google了一下，原来这家伙的名字叫做DataConnectionDialog，所属命名空间为Microsof</description>
      <content:encoded><![CDATA[<p>在系统开发中，数据库连接字符串经常被保存到.config/.ini等配置文件中，以提高系统的灵活性。上大学时候，为了实现灵活配置数据库的效果，用拼字符串的方
法来动态生成连接字符串，这种方法充满了Bad Smell。</p>
<p>昨天用CodeSmith时候，看到它的数据连接配置界面，如此的眼熟，如下图。</p>
<p>




<img loading="lazy" src="https://d05fae.dijingchao.com/upload_dropbox/201102/DataConnectionDialog.jpg" alt="image"  />


</p>
<p>Google了一下，原来这家伙的名字叫做DataConnectionDialog，所属命名空间为Microsoft.VisualStudio.Data。</p>
<p>使用的方法也很简单，引用Microsoft.Data.ConnectionUI.dll和Microsoft.Data.ConnectionUI.Dialog
.dll，这两个文件位于Microsoft Visual Studio 9.0Common7IDE下面。</p>
<p>这两个dll并没有其他依赖关系，可以放心的放到自己的程序中使用。</p>
<p>使用代码如下</p>
<pre><code>DataConnectionDialog dataConnectionDialog = new DataConnectionDialog();
DataSource.AddStandardDataSources(dataConnectionDialog);
if (DataConnectionDialog.Show(dataConnectionDialog) == DialogResult.OK)
{
	targetDBConnectionString = dataConnectionDialog.ConnectionString;
}
</code></pre>
<p>dataConnectionDialog.ConnectionString是完整的连接字符串，这样就可以比较优美的动态获取连接字符串了。</p>
<p>参考文章</p>
<ul>
<li><a href="http://www.cnblogs.com/yans/archive/2010/12/04/1896285.html">DataConnectionDialog 旧事重提 - 名牌热狗 - 博客园</a></li>
<li><a href="http://jayai.blog.51cto.com/510093/256313">C#&ndash;WinForm系统平台之登录界面及数据连接 - 天高行健，地厚载物 - 51CTO技术博客</a></li>
<li><a href="http://msdn.microsoft.com/zh-cn/library/microsoft.visualstudio.data.dataconnectiondialog(v=vs.80).aspx">DataConnectionDialog Class (Microsoft.VisualStudio.Data)</a></li>
</ul>
<p>最后给大家拜个晚年，祝大家新年新气象。。。（此处省略1000字）</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>正则表达式抓捕替换</title>
      <link>https://blog.alswl.com/2011/01/regex-group-catch/</link>
      <pubDate>Wed, 19 Jan 2011 00:00:00 +0800</pubDate>
      
      <guid>https://blog.alswl.com/2011/01/regex-group-catch/</guid>
      <description>问题情境 需要将RDL报表里的GetComment( Parameters!F0001.Value , Parameters!F0002.Value ,&amp;ldquo;total&amp;rdquo;, Parameters!Language.Value)函数修改为GetCommentForComment( Parameters!F0001.Value , Parameters!F0002.Value ,&amp;ldquo;total&amp;rdquo;, Parameters!Language.Value, &amp;ldquo;ReportConnection0107&amp;rdquo;)。 思路 使用正则表达式里面的分组进行抓获，再用1将中间固定的参数取出，组成新的字符串。 Vim实现 %s/GetComment(((sw+!w+.w+s,){2}s*&amp;ldquo;w+&amp;ldquo;s*,sw+!w+.w+s))/GetCommentForReport(1 , &amp;ldquo;ReportConnection0107&amp;rdquo;)/gc 解释：%为全局替换，s为替换。后面则是表达式，和正则表达式</description>
      <content:encoded><![CDATA[<h2 id="问题情境">问题情境</h2>
<p>需要将RDL报表里的GetComment( Parameters!F0001.Value , Parameters!F0002.Value
,&ldquo;total&rdquo;, Parameters!Language.Value)函数修改为GetCommentForComment(
Parameters!F0001.Value , Parameters!F0002.Value ,&ldquo;total&rdquo;,
Parameters!Language.Value, &ldquo;ReportConnection0107&rdquo;)。</p>
<h2 id="思路">思路</h2>
<p>使用正则表达式里面的分组进行抓获，再用1将中间固定的参数取出，组成新的字符串。</p>
<h3 id="vim实现">Vim实现</h3>
<p>%s/GetComment(((s<em>w+!w+.w+s</em>,){2}s*&ldquo;w+&ldquo;s*,s<em>w+!w+.w+s</em>))/GetCommentForReport(1
, &ldquo;ReportConnection0107&rdquo;)/gc</p>
<p>解释：%为全局替换，s为替换。后面则是表达式，和正则表达式差不多，注意是*不需要转义，+ 和 .需要转义，最后的g代表当前行替换，c代表每次替换需要确认。</p>
<p>目标表达式中有1，代表抓获的第一个字符串，多个字符串抓获则依次往下排列。�表示原始字符串。</p>
<h3 id="notepadeditplus实现">NotePad++/EditPlus实现</h3>
<p>GetComment(( *[a-zA-Z0-9]+![a-zA-Z0-9]+.[a-zA-Z0-9]+ *,
*[a-zA-Z0-9]+![a-zA-Z0-9]+.[a-zA-Z0-9]+ *, *&quot;[a-zA-Z0-9]+&rdquo; *,
*[a-zA-Z0-9]+![a-zA-Z0-9]+.[a-zA-Z0-9]+ *))</p>
<p>替换为GetCommentForReport(1, &ldquo;ReportConnection0107&rdquo;)</p>
<p>解释：不知道为何，我无法使用ws匹配文字和空格，只能使用[a-zA-Z0-9]表示（完整的是[a-zA-Z0-9_]）w，用空格表示s。</p>
<h3 id="visualstudio">VisualStudio</h3>
<p>由于RDL开发必然使用VisualStudio，所以用VS替换更方便。</p>
<p>GetComment({ *[a-zA-Z0-9]+![a-zA-Z0-9]+.[a-zA-Z0-9]+ *,
*[a-zA-Z0-9]+![a-zA-Z0-9]+.[a-zA-Z0-9]+ *, *&quot;[a-zA-Z0-9]+&rdquo; *,
*[a-zA-Z0-9]+![a-zA-Z0-9]+.[a-zA-Z0-9]+ *})</p>
<p>依旧替换为GetCommentForReport(1, &ldquo;ReportConnection0107&rdquo;)</p>
<p>解释：VS除了NotePad++/EditPlus的问题外，还有一个严重的问题就是他抓取的不是分组()，而是抓获的花括号{}抓捕的字符串，官方的称呼叫做&quot;带
标记的表达式&quot;，详情可以参考<a href="http://msdn.microsoft.com/zh-cn/library/2k3te2cs.aspx">MSDN正则表达式 (Visual Studio)</a>。</p>
<h2 id="ps">PS</h2>
<p>所以咯，Vimer，你懂的~</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>将VisualStudio打造成Vim</title>
      <link>https://blog.alswl.com/2010/09/vs-vim/</link>
      <pubDate>Fri, 03 Sep 2010 00:00:00 +0800</pubDate>
      
      <guid>https://blog.alswl.com/2010/09/vs-vim/</guid>
      <description>背景：Vim in VisualStudio? 最近痴迷于Vim，尝试着在.net环境中（70%C#+20%ASPX+10%JS）使用Vim进行开发。但是似乎现成的Vim插件不太适应.net开发平台，在进 行调试、编译以及ASPX页面调整时候还是需要切换到VS。 内事不决问老婆，外事不决问Google，我以关键词&amp;quot;Vim C#&amp;ldquo;向G神询问，很可惜一圈一圈找下来，都没有什么有价值的答案。在StackOverlow上</description>
      <content:encoded><![CDATA[<p>




<img loading="lazy" src="https://d05fae.dijingchao.com/upload_dropbox/201009/ViEmu.jpg" alt="image"  />


</p>
<h3 id="背景vim-in-visualstudio">背景：Vim in VisualStudio?</h3>
<p>最近痴迷于Vim，尝试着在.net环境中（70%C#+20%ASPX+10%JS）使用Vim进行开发。但是似乎现成的Vim插件不太适应.net开发平台，在进
行调试、编译以及ASPX页面调整时候还是需要切换到VS。</p>
<p>内事不决问老婆，外事不决问Google，我以关键词&quot;Vim C#&ldquo;向G神询问，很可惜一圈一圈找下来，都没有什么有价值的答案。在StackOverlow上找到
了一些相关资源，其中几位资深人士（使用Vi/Vim大约20年）提到了一款叫做ViEmu的软件，就好奇的跑去看看。</p>
<h3 id="viemu">ViEmu</h3>
<p>让我们来见识一下ViEmu的厉害吧。ViEmu支持模式切换、移动、宏、高亮搜索，键盘映射、增强命令、正则表达、可视模式等等。反正常用的Vim功能都具备。它自
己也敢宣称支持Vim大部分功能（Vim太强大，不敢说完全模拟~）。下面是一张ViEmu的官方示意图。</p>
<p>




<img loading="lazy" src="https://d05fae.dijingchao.com/upload_dropbox/201009/viemu-movie.gif" alt="image"  />


</p>
<p>ViEmu不但有支持VS的版本，还有支持Word &amp; Outlook &amp; SQL Server Management
Studio（SQL解析器），确实是相当强大。</p>
<p>ViEmu的收费标准是Only $99，唉，真是残酷+万恶的资本主义啊。囊中羞涩，不得不去求破解版本。功夫不负有心人，终于找到了当前最新版本ViEmu.v.
2.5.4的破解版&rdquo;<a href="http://www.52pojie.cn/viewthread.php?tid=59277">ViEmu.v.2.5.4.for.VS.Classic.CracKed-LCG - 『LCG Area』 - 吾爱破解论坛【 LCG
】 破解论坛|破解软件|加密解密|逆向工程|软件安全|病毒分析|精品软件|破解补丁|注册机|序列号|QQ|下载|Crack|Patch|Key|SN -
Powered by Discuz!</a>&quot;。（这标题真TMD长
，不过论坛够意思，不用注册即可下载）。网上还有一种破解方法（我没有试过，感兴趣可以尝试）。</p>
<blockquote>
<p>1.删除目录 C:Documents and Settings用户名Local SettingsApplication DataIdentities
{17582A9E-740A-47F2-8256-D09F1378E7FA}</p>
</blockquote>
<p>2.删除注册表项HKEY_CURRENT_USERSoftwareClassesCLSID{D31F31E1-B08F-46FF-
92C5-CA111A2053DF}</p>
<h3 id="安装失败">安装失败</h3>
<p>在公司电脑安装ViEmu没有问题，在我的机器上面（XP Sp3+VS2008+ReSharper
v4.1）却出现了重大错误。启动VS之后立刻提示&quot;ViEmu incorrectly installed, please
reinstall&quot;，卸载重装之后不起任何作用。</p>
<p>我在官方支持论坛上面找到了相关讨论<a href="http://www.viemu.com/forums/viewtopic.php?id=395">ViEmu forums / ViEmu incorrectly installed message under VS
2008</a>。作者会给所有遇到问题的人发一封邮件，包含一个
Tool，能够解决这个问题并且将时间恢复至30天，<strike>下载点击[这里](<a href="http://www.viemu.com/for-">http://www.viemu.com/for-</a>
ajsd8/XtendTest.exe)</strike>（作者发送给我时候，该链接已失效）。</p>
<p>好在我有十全大补丸，就是上文提到的那个破解包，破解之后，连带着这个莫名的问题也莫名的解决了~</p>
<h3 id="主题">主题</h3>
<p>厌倦了VisualStudio那种白底黑字加上几个蓝色函数的主题了么，想回到Geek Feel的Vim主题嘛，这里就要向你隆重推荐一个网站：Studio
Styles - Visual Studio color
schemes，里面包含了N套VS的主题，大部分是深色背景浅色文字、保护视力的背景。比如排名最高，也是我比较喜欢的<a href="http://studiostyles.info/schemes/wekeroad-ink">WekeRoad
Ink</a>。</p>
<p>




<img loading="lazy" src="https://d05fae.dijingchao.com/upload_dropbox/201009/WekeRoad_Ink.jpg" alt="image"  />


</p>
<p>通过工具-导入和导出设置就可以把新主题颜色导入VS了。话说回来，真不知道VS设计团队怎么想的，需要一个一个设置不同类型的字体和颜色~~~</p>
<h3 id="相关链接">相关链接</h3>
<p><a href="http://www.viemu.com/">ViEmu: vi-vim editor emulation for Visual Studio, Word, Outlook and SQL
Server</a> ViEmu官网</p>
<p><a href="http://stackoverflow.com/questions/597077/is-learning-vim-worth-the-effort">Is learning VIM worth the effort? - Stack Overflow
</a>
CSharper怎么用Vim，老程序员的回答</p>
<p><a href="http://www.vimer.cn/">Vimer的程序世界</a> 一个Vim爱好者的Blog</p>
<p><a href="http://xbeta.info/vimperator.htm">Vimperator：VIM化的Firefox</a>
想在FireFox下脱离鼠标用Vim模式化操作么？</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>PDA&#34;未能建立与网络的连接&#34;的解决办法</title>
      <link>https://blog.alswl.com/2010/03/solution-of-pda-failed-to-establish-a-network-connection/</link>
      <pubDate>Wed, 31 Mar 2010 00:00:00 +0800</pubDate>
      
      <guid>https://blog.alswl.com/2010/03/solution-of-pda-failed-to-establish-a-network-connection/</guid>
      <description>遇到这个问题大凡是因为模拟器或者真机无法连接网络，所以需要先测试网络是否畅通，在真机或者模拟器的IE中打开需要的WebService地址，看看是否能够正常获 取。 确定是网络原因后，可以采用多种方式连接网络，比如使用虚拟网卡来实现，又或者使用ActiveSync来实现。 使用本地网卡 在模拟器的文件-配置中的网卡中，选择本地网卡，可能会需要提示安装Virtual PC 2007，我不愿意装这么一个大家伙，也就没</description>
      <content:encoded><![CDATA[<p>遇到这个问题大凡是因为模拟器或者真机无法连接网络，所以需要先测试网络是否畅通，在真机或者模拟器的IE中打开需要的WebService地址，看看是否能够正常获
取。</p>
<p>确定是网络原因后，可以采用多种方式连接网络，比如使用虚拟网卡来实现，又或者使用ActiveSync来实现。</p>
<h3 id="使用本地网卡">使用本地网卡</h3>
<p>在模拟器的文件-配置中的网卡中，选择本地网卡，可能会需要提示安装Virtual PC
2007，我不愿意装这么一个大家伙，也就没有尝试这种方法，需要的朋友可以在[Download details: Virtual PC 2007](<a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=04d26402-3199-48a3-afa2-2d">http://www.microsoft.com/downloads/details.aspx?FamilyID=04d26402-3199-48a3-afa2-2d</a>
c0b40a73b6&amp;DisplayLang=en)来下载Virtual PC 2007进而连接互联网。</p>
<h3 id="使用activesync">使用ActiveSync</h3>
<p>ActiveSync是一个连接Win系列手持到电脑的同步软件，通过它可以使真机或者模拟机连接网络，步骤如下。</p>
<p>1、打开ActiveSync ，点击文件-连接设置，在&quot;允许连接到以下其中一个端口&quot;下选择&quot;DMA&quot;。</p>
<p>2、打开 VS2005，点击菜单工具-设备仿真管理器，选择一个windows mobile 5.0 PocketPC
模拟器。在右键菜单中点击&quot;连接&quot;。等模拟器启动后，再点击&quot;插入底座&quot;，此时，通过ActiveSync来连接到模拟器，并进行数据同步。</p>
<p>3、测试一下能不能连上网络，比如说Baidu（现在G.cn已经不能作为能否上网的标志了）或者WebService地址。</p>
<h3 id="参考连接">参考连接</h3>
<p><a href="http://www.chinaret.com/user/topic_view.aspx?u=jianfangkk&amp;id=0b10f862-db59-4a52-9ceb-9ef1023acd9a">PDA智能程序访问WebService，报告&quot;未能建立与网络的连接&quot;? </a></p>
<p><a href="http://topic.csdn.net/u/20080610/18/da506852-57da-4df0-beb4-6952eece2f4e.html">请问PDA智能程序访问WebService，报告&quot;未能建立与网络的连接&quot;?  </a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>VS2005无法创建或打开&#34;智能设备&#34;项目的一个问题的解决方法</title>
      <link>https://blog.alswl.com/2010/03/a-solution-of-can-not-create-or-open-the-smart-device-project-in-vs2005/</link>
      <pubDate>Mon, 29 Mar 2010 00:00:00 +0800</pubDate>
      
      <guid>https://blog.alswl.com/2010/03/a-solution-of-can-not-create-or-open-the-smart-device-project-in-vs2005/</guid>
      <description>状况 在VS2005中创建或打开&amp;quot;智能设备&amp;quot;项目时，提示以下错误： &amp;ldquo;从用户数据存储中检索信息时出错。系统未找到指定的对象。&amp;rdquo; 和 &amp;ldquo;由于数据存储中不存在项目引用的设备平台，因此无法打开项目。&amp;rdquo; 在打开VS2005的&amp;quot;工具&amp;quot;－&amp;ldquo;设备仿真器管理器&amp;quot;时，提示以下错误： &amp;ldquo;未能正确加载包&amp;quo</description>
      <content:encoded><![CDATA[<h3 id="状况">状况</h3>
<p>在VS2005中创建或打开&quot;智能设备&quot;项目时，提示以下错误： &ldquo;从用户数据存储中检索信息时出错。系统未找到指定的对象。&rdquo; 和
&ldquo;由于数据存储中不存在项目引用的设备平台，因此无法打开项目。&rdquo;</p>
<p>在打开VS2005的&quot;工具&quot;－&ldquo;设备仿真器管理器&quot;时，提示以下错误： &ldquo;未能正确加载包&quot;Smart Device Configuration
Package&rdquo;( GUID = {D245F354-3F45-4516-B1E6-04608DA126CC}
)。请与包供应商联系以获得帮助。由于可能会发生环境损坏，建议重新启动应用程序。要禁止将来加载此包吗? 可以使用&quot;devenv
/resetskippkgs&quot;重新启用包加载。&rdquo;</p>
<h3 id="不成功的解决办法">不成功的解决办法</h3>
<p>有说把.csproj文件中的<code>&lt;PlatformID&gt;4118C335-430C-497f- BE48-11C3316B135E&lt;/PlatformID&gt;</code>改成<code>&lt;PlatformID&gt;3C41C503-53EF-4c2a- 8DD4-A8217CAD115E&lt;/PlatformID&gt;</code>，原因说是&quot;3C41C503-53EF-4c2a-
8DD4-A8217CAD115E&quot;来自任意一个能运行的.net
cf2.0项目的.csproj文件，目标平台是ppc2003或wm5.0都可以&quot;，但是很可惜，这个办法在我电脑上没有起作用。</p>
<h3 id="成功的解决方法">成功的解决方法</h3>
<ol>
<li>
<p>关闭VS2005。</p>
</li>
<li>
<p>重命名文件夹<code>c:Documents and Settings&lt;user&gt;Local SettingsApplication DataMicrosoftCoreCon1.0</code>，这将删除所有关于设备配置属性的定制。</p>
</li>
<li>
<p>重启VS2005，VS2005会自动重建上述配置。</p>
</li>
</ol>
<p>原文链接：<a href="http://blog.csdn.net/bingrrx/archive/2008/07/10/2634481.aspx">VS2005 无法创建或打开&quot;智能设备&quot;项目的一个问题的解决方法 - bingrrx的专栏 -
CSDN博客</a></p>
<p>原文的原文链接：<del><a href="http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=140668&amp;">http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=140668&amp;</a>
SiteID=1</del>链接已失效</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>VS2008格式化aspx代码</title>
      <link>https://blog.alswl.com/2009/07/aspx-code-vs2008-format/</link>
      <pubDate>Fri, 31 Jul 2009 00:00:00 +0800</pubDate>
      
      <guid>https://blog.alswl.com/2009/07/aspx-code-vs2008-format/</guid>
      <description>在VS2008中编辑代码时候，可以使用「编辑-高级-设置文档的格式」来进行格式化代码，快捷键是Ctrl+K Ctrl+D。 但是我在格式化aspx代码时候，却遇到这样的问题，提示「未能重新格式化文档。已还原为原始格式」，「未能完成该操作。」，「未能完成操作。参数不正确」。 遇到这样的原因大凡是由于Html代码中存在一些问题，如嵌套有没有正常关闭，特殊符号如&amp;quot;&amp;gt;&amp;ldquo;有没有转换成转</description>
      <content:encoded><![CDATA[<p>在VS2008中编辑代码时候，可以使用「编辑-高级-设置文档的格式」来进行格式化代码，快捷键是Ctrl+K Ctrl+D。</p>
<p>但是我在格式化aspx代码时候，却遇到这样的问题，提示「未能重新格式化文档。已还原为原始格式」，「未能完成该操作。」，「未能完成操作。参数不正确」。</p>
<p>遇到这样的原因大凡是由于Html代码中存在一些问题，如嵌套有没有正常关闭，特殊符号如&quot;&gt;&ldquo;有没有转换成转义字符。</p>
<p>比较快捷的修改方法是使用DreamWeaver提供的验证功能，在「结果」面板中，可以使用F7快捷键打开，使用它的验证功能，可以快速找出Html不合法的地方。</p>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
