<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>confluence on Log4D</title><link>https://blog.alswl.com/tags/confluence/</link><description>Recent content in confluence on Log4D</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 12 Jan 2016 22:53:55 +0800</lastBuildDate><atom:link href="https://blog.alswl.com/tags/confluence/atom.xml" rel="self" type="application/rss+xml"/><item><title>一次艰难的 Wiki 升级</title><link>https://blog.alswl.com/2016/01/confluence-upgrade/</link><pubDate>Tue, 12 Jan 2016 22:53:55 +0800</pubDate><guid>https://blog.alswl.com/2016/01/confluence-upgrade/</guid><description>公司使用 Confluence 管理自己的知识库， 现在使用的版本还是 3.0.1，而最新的 Confluence 版本已经是 5.4+。 新版本加入的一些现代化 Web 系统的新特性很吸引人（拖拽上传，可见即所得编辑）， 在群众的强烈呼声下，我着手开始升级。
官方的升级路线很扯，3.0.1 的升级路线是：
3.0.1 -&amp;gt; 3.5.17 5.0.3 -&amp;gt; 5.4.4 中间两次大版本升级，第一次原因不明，第二次是更新了 markup 渲染引擎， 改为 HTML 格式类型的渲染模式。
由于一些原因，我们系统还跑在 embedded 模式下（其实就是 HyperSQL），这种大版本升级， 需要先从内置库升级到外部数据库，比如 MySQL。
苦逼旅程就开始了。
From embedded to MySQL 更新内置库到外部库的操作流程：
导出当前的数据备份，包括附件，我导出后 1G+ 使用当前同版本（3.0.1）安装一个全新的 wiki，注意下载 JDBC-connector 安装之后，配置好 MySQL，开始导入之前准备好的备份 悲剧上演 遇到了错误：
Import failed. Hibernate operation: could not insert: [com.atlassian.confluence.core.BodyContent#12028015]; SQL []; Duplicate entry &amp;lsquo;12028015&amp;rsquo; for key &amp;lsquo;PRIMARY&amp;rsquo;; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Duplicate entry &amp;lsquo;12028015&amp;rsquo; for key &amp;lsquo;PRIMARY&amp;rsquo;</description></item></channel></rss>