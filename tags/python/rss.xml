<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Python on Log4D</title>
    <link>https://blog.alswl.com/tags/python/</link>
    <description>Recent content in Python on Log4D</description>
    <generator>Hugo -- 0.148.2</generator>
    <language>zh</language>
    <lastBuildDate>Tue, 23 Jun 2020 17:54:00 +0800</lastBuildDate>
    <atom:link href="https://blog.alswl.com/tags/python/rss.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Python çš„ç±»å‹ç³»ç»Ÿ</title>
      <link>https://blog.alswl.com/2020/06/type-safe-python/</link>
      <pubDate>Tue, 23 Jun 2020 17:54:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2020/06/type-safe-python/</guid>
      <description>&lt;p&gt;




&lt;img loading=&#34;lazy&#34; src=&#34;https://blog.alswl.com/images/upload_dropbox/202006/wall.png&#34; alt=&#34;wall&#34;  /&gt;



&lt;small&gt;image from pixabay.com&lt;/small&gt;&lt;/p&gt;
&lt;p&gt;é™æ€ç±»å‹æ­£åœ¨é€æ¸æˆä¸ºæ½®æµï¼Œ
2010 å¹´ä¹‹åè¯ç”Ÿçš„å‡ é—¨è¯­è¨€ Goã€Rustã€TypeScript ç­‰éƒ½èµ°äº†é™æ€ç±»å‹è·¯çº¿ã€‚
è¿‡å¾€æµè¡Œçš„ä¸€äº›åŠ¨æ€è¯­è¨€ï¼ˆPythonã€PHPã€JavaScriptï¼‰ä¹Ÿåœ¨ç§¯æå¼•å…¥è¯­è¨€æ–°ç‰¹æ€§ï¼ˆType Hintã€TypeScriptï¼‰å¯¹é™æ€ç±»å‹å¢å¼ºã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘æ›¾ä½¿ç”¨ Python å¼€å‘è§„æ¨¡è¾ƒå¤§çš„é¡¹ç›®ï¼Œæ„Ÿå—è¿‡åŠ¨æ€è¯­è¨€åœ¨å·¥ç¨‹è§„æ¨¡å˜å¤§æ—¶å€™å¸¦æ¥çš„å›°éš¾ï¼š
åœ¨é‡æ„é˜¶æ®µä»£ç å›å½’æˆæœ¬å¼‚å¸¸ä¹‹é«˜ï¼Œå¾ˆå¤šå†å²ä»£ç ä¸æ•¢åŠ¨ã€‚
åæ¥æŠ€æœ¯æ ˆè½¬åˆ° Javaï¼Œè¢«ç±»å‹ç³»ç»Ÿæ€€æŠ±è®©äººäº§ç”Ÿå®‰å…¨æ„Ÿã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/202006/wall.png" alt="wall"  />



<small>image from pixabay.com</small></p>
<p>é™æ€ç±»å‹æ­£åœ¨é€æ¸æˆä¸ºæ½®æµï¼Œ
2010 å¹´ä¹‹åè¯ç”Ÿçš„å‡ é—¨è¯­è¨€ Goã€Rustã€TypeScript ç­‰éƒ½èµ°äº†é™æ€ç±»å‹è·¯çº¿ã€‚
è¿‡å¾€æµè¡Œçš„ä¸€äº›åŠ¨æ€è¯­è¨€ï¼ˆPythonã€PHPã€JavaScriptï¼‰ä¹Ÿåœ¨ç§¯æå¼•å…¥è¯­è¨€æ–°ç‰¹æ€§ï¼ˆType Hintã€TypeScriptï¼‰å¯¹é™æ€ç±»å‹å¢å¼ºã€‚</p>
<p>æˆ‘æ›¾ä½¿ç”¨ Python å¼€å‘è§„æ¨¡è¾ƒå¤§çš„é¡¹ç›®ï¼Œæ„Ÿå—è¿‡åŠ¨æ€è¯­è¨€åœ¨å·¥ç¨‹è§„æ¨¡å˜å¤§æ—¶å€™å¸¦æ¥çš„å›°éš¾ï¼š
åœ¨é‡æ„é˜¶æ®µä»£ç å›å½’æˆæœ¬å¼‚å¸¸ä¹‹é«˜ï¼Œå¾ˆå¤šå†å²ä»£ç ä¸æ•¢åŠ¨ã€‚
åæ¥æŠ€æœ¯æ ˆè½¬åˆ° Javaï¼Œè¢«ç±»å‹ç³»ç»Ÿæ€€æŠ±è®©äººäº§ç”Ÿå®‰å…¨æ„Ÿã€‚</p>
<p>æœ€è¿‘ä¸€å¹´åœ¨ä¸€ä¸ªé¢å‘ç¨³å®šæ€§çš„è¿ç»´ç³»ç»Ÿè€•è€˜ã€‚ç³»ç»Ÿé€‰å‹ä¹‹åˆä½¿ç”¨äº† Pythonã€‚
æˆ‘åœ¨é¡¹ç›®ä¸­åŠ›æ¨äº† Python 3.7ï¼Œå¹¶å¤§è§„æ¨¡ä½¿ç”¨äº† Python çš„ç±»å‹ç³»ç»Ÿæ¥é™ä½æ½œåœ¨é£é™©ã€‚</p>
<p>è¿½æ ¹æº¯æºï¼Œæˆ‘èŠ±äº†ä¸€äº›æ—¶é—´äº†è§£ Python åœ¨ç±»å‹ç³»ç»Ÿçš„è®¾è®¡å’Œå®ç°ï¼Œ
æœ¬æ–‡ä»¥ PEP ææ¡ˆä»‹ç»ä¸€ä¸‹ Python åœ¨ç±»å‹ç³»ç»Ÿä¸Šé¢èµ°è¿‡çš„è·¯ã€‚</p>
<!-- more -->
<h2 id="ç±»å‹ç³»ç»Ÿ">ç±»å‹ç³»ç»Ÿ</h2>
<p>è°ˆç±»å‹ç³»ç»Ÿä¹‹å‰ï¼Œè¦å˜å®šä¸¤ä¸ªæ¦‚å¿µï¼ŒåŠ¨æ€è¯­è¨€å’ŒåŠ¨æ€ç±»å‹ã€‚</p>
<p>åŠ¨æ€è¯­è¨€ï¼ˆDynamic Programming Languageï¼‰åˆ™æ˜¯æŒ‡ç¨‹åºåœ¨è¿è¡Œæ—¶å¯ä»¥æ”¹å˜ç»“æ„ã€‚
è¿™ä¸ªç»“æ„å¯ä»¥åŒ…å«å‡½æ•°ã€å¯¹è±¡ã€å˜é‡ç±»å‹ã€ç¨‹åºç»“æ„ã€‚
åŠ¨æ€ç±»å‹æ˜¯ç±»å‹ç³»ç»Ÿï¼ˆType Systemï¼‰å…¶ä¸­ä¸€ç±»ï¼Œå³ç¨‹åºåœ¨è¿è¡ŒæœŸé—´å¯ä»¥ä¿®æ”¹å˜é‡ç±»å‹ã€‚
å¦å¤–ä¸€ç§æ˜¯é™æ€ç±»å‹ï¼šåœ¨ç¼–è¯‘æœŸå°±å†³å®šäº†å˜é‡ç±»å‹ï¼Œè¿è¡ŒæœŸä¸å…è®¸å‘ç”Ÿå˜åŒ–ã€‚
ç±»å‹ç³»ç»Ÿè¿˜æœ‰ä¸€ç§åˆ†æ³•æ˜¯å¼ºç±»å‹å’Œå¼±ç±»å‹ï¼Œå¼ºç±»å‹æ˜¯æŒ‡ç¦æ­¢ç±»å‹ä¸åŒ¹é…çš„æŒ‡ä»¤ï¼Œå¼±ç±»å‹åä¹‹ã€‚</p>
<p>åŠ¨æ€è¯­è¨€å’ŒåŠ¨æ€ç±»å‹è¿™ä¸¤ä¸ªæ¦‚å¿µåˆ‡å…¥ç‚¹ä¸ä¸€æ ·ï¼Œ
Python æ˜¯ä¸€é—¨åŠ¨æ€è¯­è¨€ï¼Œä¹Ÿæ˜¯åŠ¨æ€ç±»å‹è¯­è¨€ï¼Œè¿˜æ˜¯å¼ºç±»å‹çš„åŠ¨æ€ç±»å‹ã€‚
è¿™ç¯‡æ–‡ç« ä¸»è¦è®¨è®º Python è¯­è¨€çš„ç±»å‹ç³»ç»Ÿï¼Œä¸ä¼šæ¶‰åŠåŠ¨æ€è¯­è¨€ç‰¹æ€§ã€‚</p>
<h2 id="ç±»å‹å®‰å…¨ä¹‹è·¯">ç±»å‹å®‰å…¨ä¹‹è·¯</h2>
<p>è¡Œä¸šé‡Œé¢ä¸€ç›´æœ‰ä¸€ä¸ªäº‰è®ºï¼šåŠ¨æ€ç±»å‹å’Œé™æ€ç±»å‹å“ªä¸€ç§æ›´å¼ºå¤§ã€‚
é™æ€ç±»å‹çš„æ”¯æŒè€…è®¤ä¸ºä¸‰ä¸ªæ–¹é¢å…·å¤‡ä¼˜åŠ¿ï¼šæ€§èƒ½ã€é”™è¯¯å‘ç°ã€é«˜æ•ˆé‡æ„ã€‚
é™æ€ç±»å‹é€šè¿‡ç¼–è¯‘æœŸå†³å®šå…·ä½“ç±»å‹å¯ä»¥æ˜¾è‘—çš„æé«˜è¿è¡ŒæœŸæ•ˆç‡ï¼›
ç¼–è¯‘æœŸå°±èƒ½å¤Ÿå‘ç°é”™è¯¯ï¼Œåœ¨å·¥ç¨‹è§„æ¨¡é€æ­¥å˜å¤§æ—¶å€™å°¤å…¶æ˜æ˜¾ï¼›
ç±»å‹ç³»ç»Ÿå¯ä»¥å¸®åŠ© IDE æç¤ºï¼Œé«˜æ•ˆé‡æ„ã€‚
åŠ¨æ€ç±»å‹çš„æ”¯æŒè€…åˆ™è®¤ä¸ºåˆ†æä»£ç ä¼šæ›´ç®€å•ï¼Œå‡å°‘å‡ºé”™æœºä¼šï¼Œå†™èµ·æ¥ä¹Ÿæ›´ä¸ºå¿«é€Ÿã€‚</p>
<p>Python å¼€å‘è€…ä»¬å¹¶éæ²¡æœ‰çœ‹åˆ°è¿™ä¸ªç—›ç‚¹ï¼Œ
ä¸€ç³»åˆ— PEP ææ¡ˆåº”è¿è€Œç”Ÿã€‚
åœ¨ä¿ç•™ Python åŠ¨æ€ç±»å‹ç³»ç»Ÿä¼˜åŠ¿å‰æï¼Œé€šè¿‡è¯­æ³•ã€ç‰¹æ€§å¢å¼ºï¼Œå°†ç±»å‹ç³»ç»Ÿå¼•å…¥ Pythonã€‚</p>
<p>Python åœ¨ 2014 å¹´å³æå‡ºäº† PEP 484ï¼Œéšåæå‡ºä¸€ä¸ªç²¾ç²¹ç‰ˆ PEP 483ï¼ˆThe Theory of Type Hintsï¼‰ï¼Œ
å…¶å·¥ç¨‹å®ç° <a href="https://docs.python.org/3/library/typing.html">typing</a> æ¨¡å—åœ¨ 3.5 å‘å¸ƒã€‚
ç»è¿‡ PEP 484ï¼ŒPEP 526ï¼ŒPEP 544ï¼ŒPEP 586ï¼ŒPEP 589ï¼ŒPEP 591 çš„å¤šæ¬¡ç‰ˆæœ¬è¿­ä»£ï¼ŒPython çš„ç±»å‹ç³»ç»Ÿå·²ç»å¾ˆä¸°å¯Œã€‚
ç”šè‡³åŒ…å«äº†æ¯”å¦‚ Structural Subtyping ä»¥åŠ Literal Typing è¿™è¾¹ç›¸å¯¹ç½•è§çš„ç‰¹æ€§ã€‚</p>
<h3 id="pep-483---æ ¸å¿ƒæ¦‚å¿µ">PEP 483 - æ ¸å¿ƒæ¦‚å¿µ</h3>
<p><a href="https://www.python.org/dev/peps/pep-0483/">PEP 483</a> åœ¨ 2014 å¹´ 12 æœˆå‘å¸ƒï¼Œ
æ˜¯ Guido èµ·ç¬”çš„æ ¸å¿ƒæ¦‚å¿µç‰ˆï¼Œç®€æ˜æ‰¼è¦çš„å†™æ¸…æ¥š Python çš„ç±»å‹ç³»ç»Ÿå»ºè®¾æ–¹å‘ã€è¾¹ç•Œã€è¦å’Œä¸è¦ã€‚</p>
<p>PEP 483 æ²¡æœ‰è°ˆå…·ä½“å·¥ç¨‹å®ç°ï¼Œæçº²æŒˆé¢†åœ°è®²äº†ä¸€ä¸‹ Python ç±»å‹ç³»ç»Ÿå¦‚ä½•å¯¹å¤–å‘ˆç°ã€‚
å˜å®š Type / Class å·®åˆ«ï¼Œå‰è€…æ˜¯è¯­æ³•åˆ†ææ¦‚å¿µï¼Œåè€…æ˜¯è¿è¡Œæ—¶æ¦‚å¿µã€‚
åœ¨è¿™ä¸ªå®šä¹‰ä¸‹é¢ Class éƒ½æ˜¯ä¸€ä¸ª Typeï¼Œä½† Type æœªå¿…æ˜¯ Classã€‚
ä¸¾ä¾‹ <code>Union[str, int]</code> æ˜¯ Type ä½†å¹¶ä¸æ˜¯ Classã€‚</p>
<p>PEP 483 è¿˜ä»‹ç»å†…å»ºåŸºç¡€ç±»å‹ï¼š<code>Any</code> / <code>Unison</code> / <code>Optional</code> / <code>Tuple</code> / <code>Callable</code>ï¼Œè¿™äº›åŸºç¡€ç±»å‹æ”¯æ’‘ä¸Šæ¸¸ä¸°å¯Œå˜åŒ–ã€‚</p>
<p>é™æ€ç±»å‹ç³»ç»Ÿæœ€å¤§çš„è¯Ÿç—…æ˜¯ä¸å¤Ÿçµæ´»ï¼ŒGo è¯­è¨€ç°åœ¨è¿˜æ²¡æœ‰å®ç°æ³›å‹ã€‚
PEP 483 ä»‹ç»äº† Python Generic types æ³›å‹ä½¿ç”¨æ–¹æ³•ï¼Œ
å½¢å¼å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">S</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">longest</span><span class="p">(</span><span class="n">first</span><span class="p">:</span> <span class="n">S</span><span class="p">,</span> <span class="n">second</span><span class="p">:</span> <span class="n">S</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">S</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">first</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">first</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">second</span><span class="p">)</span> <span class="k">else</span> <span class="n">second</span>
</span></span></code></pre></div><p>æœ€åï¼ŒPEP 483 è¿˜æäº†ä¸€äº›é‡è¦çš„å°ç‰¹æ€§ï¼š</p>
<ul>
<li>åˆ«ç§° Alias</li>
<li>å‰ç½®å¼•ç”¨ Farward Referenceï¼ˆåœ¨å®šä¹‰ç±»æ–¹æ³•æ³¨è§£ä¸­ä½¿ç”¨å®šä¹‰ç±»ï¼‰ï¼Œeg.ï¼šè§£å†³äºŒå‰æ ‘ Node èŠ‚ç‚¹ä¸­éœ€è¦å¼•ç”¨ Node é—®é¢˜</li>
<li>covariance contravariant åå˜é€†å˜</li>
<li>ä½¿ç”¨æ³¨é‡Šæ ‡è®°ç±»å‹</li>
<li>è½¬å‹ Cast</li>
</ul>
<p>PEP 483 çš„å®ç°ï¼Œä¸»è¦ä¾èµ–äº† <a href="https://www.python.org/dev/peps/pep-3107/">PEP 3107 &ndash; Function Annotations</a>
è¿™ä¸ªææ¡ˆã€‚PEP 3107 ä»‹ç» function æ³¨è§£ä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œ <code>func(a: a1, b: b1) -&gt; r1</code>
è¿™æ®µä»£ç ï¼Œ
å…¶ä¸­å†’å·åé¢çš„æè¿°ç¬¦è®°å½•ä¼šåˆ° func çš„ <code>__annotations__</code> å˜é‡ä¸­ã€‚</p>
<p>PEP 3107 æ•ˆæœå±•ç¤ºå¦‚ä¸‹ï¼Œå¯ä»¥æ¸…æ™°çœ‹åˆ°å‡½æ•°å˜é‡å­˜æ”¾ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">add</span><span class="o">.</span><span class="vm">__annotations__</span>
</span></span><span class="line"><span class="cl"><span class="c1"># {&#39;x&#39;: int, &#39;y&#39;: int, &#39;return&#39;: int}</span>
</span></span></code></pre></div><p>PSï¼šç°åœ¨ Python æœ‰äº† Decorator è£…é¥°å™¨ / Annotation æ³¨è§£ï¼Œå…¶ä¸­ Annotation çš„è®¾è®¡è¿˜å’Œ Java çš„ Annotation åŒåï¼Œä¸€é”…ç²¥ã€‚</p>
<h3 id="pep-484---type-hints-æ ¸å¿ƒ">PEP 484 - Type Hints æ ¸å¿ƒ</h3>
<p><a href="https://www.python.org/dev/peps/pep-0484/">PEP 484 &ndash; Type Hints</a>
åœ¨ PEP 483 åŸºç¡€ä¸Šå®Œæ•´è®²è¿° Python ç±»å‹ç³»ç»Ÿå¦‚ä½•è®¾è®¡ï¼Œå¦‚ä½•ä½¿ç”¨ï¼Œç»†èŠ‚å¦‚ä½•ï¼ˆtyping æ¨¡å—ï¼‰</p>
<p>è¿™ç¯‡ææ¡ˆå¼€å®—æ˜ä¹‰åœ°ç‚¹å‡ºï¼š</p>
<blockquote>
<p>Python will remain a dynamically typed language, and the authors have no desire to ever make type hints mandatory,
even by convention.</p></blockquote>
<p>ä¸€å¥è¯æ–­ç»äº† Python åœ¨è¯­è¨€çº§åˆ«è¿›åŒ–åˆ°é™æ€ç³»ç»Ÿçš„å¯èƒ½ã€‚</p>
<p>ææ¡ˆé™¤äº† PEP 483 å·²ç»è®²è§£çš„ç‰¹æ€§ï¼Œè¿˜æœ‰ä»¥ä¸‹å¸å¼•æˆ‘çš„ç‚¹ï¼š</p>
<ul>
<li>å…è®¸é€šè¿‡ Stub Files ä¸ºå·²ç»å­˜åœ¨çš„åº“æ·»åŠ ç±»å‹æè¿°ã€‚å…·ä½“æ˜¯ä½¿ç”¨ Python æ–‡ä»¶å¯¹åº”çš„ <code>.pyi</code> æ–‡ä»¶æè¿° Python ä»£ç çš„å¸¦ç±»å‹ç­¾åã€‚
è¿™ä¸ªæ–¹æ¡ˆå’Œ TS çš„ <code>@types</code> æ–‡ä»¶æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚</li>
<li>å…è®¸ä½¿ç”¨ <code>@overload</code> è¿›è¡Œç±»å‹é‡è½½ï¼Œè¿™ä¹Ÿæ˜¯æ´»ä¹…è§ï¼ŒPython å±…ç„¶å¯ä»¥ï¼ˆåœ¨æŸç§æ„ä¹‰ä¸Šï¼‰æ”¯æŒé‡è½½äº†ã€‚</li>
<li>ä»‹ç»äº† typing å®ç°ç»†èŠ‚ï¼Œæ¯”å¦‚ä½¿ç”¨ absï¼ˆAbstract Base Classï¼‰æ„å»ºå¸¸è§ç±»å‹çš„ interfaceï¼ŒåŒ…æ‹¬ <code>Sized</code> / <code>Iterable</code> è¿™äº›åŸºç¡€æ¥å£ã€‚
æˆ‘ä¸ªäººè®¤ä¸ºè¿™ä¸ªå·¥ä½œé‡æ˜¯å…¶å®æŒºå¤§ï¼Œæ˜¯ç»™å·²æœ‰çš„ç±»è¿›è¡Œä¸€æ¬¡ä¾èµ–æ¢³ç†ã€‚</li>
<li>ä»‹ç»äº† Python å‘åï¼ˆPython 2ï¼‰å…¼å®¹æ–¹æ³•ï¼Œæœ‰è¿™ä¹ˆå‡ ç§ç­–ç•¥ï¼š
ä½¿ç”¨ decoratorï¼ˆ<code>@typehints(foo=str, returns=str)</code>ï¼‰ã€commentsã€Stub filesã€Docstring</li>
</ul>
<h3 id="pep-526---å˜é‡ä¹Ÿå®‰æ’ä¸Šäº†">PEP 526 - å˜é‡ä¹Ÿå®‰æ’ä¸Šäº†</h3>
<p><a href="https://www.python.org/dev/peps/pep-0526/">PEP 526 &ndash; Syntax for Variable Annotations</a>
æ ¸å¿ƒææ¡ˆæ˜¯ç»™å˜é‡åŠ ä¸Š Type Hints æ”¯æŒã€‚</p>
<p>å’Œ <code>function annotation</code> ç±»ä¼¼ï¼Œä¹Ÿæ˜¯é€šè¿‡æ³¨è§£æ–¹å¼å­˜æ”¾ã€‚
å·®å¼‚æ˜¯å¹¶ä¸æ˜¯ç»™å®ä¾‹æ·»åŠ ä¸€ä¸ª <code>__annotations__</code> æˆå‘˜ï¼Œè€Œæ˜¯å°†å˜é‡çš„ annotations ä¿¡æ¯å­˜æ”¾åœ¨ä¸Šä¸‹æ–‡å˜é‡ <code>__annotations__</code> ä¹‹ä¸­ã€‚
è¿™ä¸ªå…¶å®ä¹Ÿæ¯”è¾ƒå¥½ç†è§£ï¼šå®šä¹‰ä¸€ä¸ªå˜é‡ç±»å‹æ—¶å€™ï¼Œè¿™ä¸ªå˜é‡è¿˜æ²¡æœ‰åˆå§‹åŒ–ã€‚</p>
<p>æˆ‘å†™ä¸€æ®µ Demo å±•ç¤ºä¸€ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
</span></span><span class="line"><span class="cl"><span class="n">users</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># print(__annotations__)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># {&#39;users&#39;: typing.List[int]}</span>
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šè¿° Demo æ•ˆæœæ˜¯åœ¨ä¸Šä¸‹æ–‡å˜é‡åˆ›å»ºäº†ä¸€ä¸ª <code>users</code>ï¼Œä½†è¿™ä¸ª <code>users</code> å…¶å®å¹¶ä¸å­˜åœ¨ï¼Œåªæ˜¯å®šä¹‰äº†ç±»å‹ï¼Œ
å¦‚æœè¿è¡Œ <code>print(users)</code> ä¼šæŠ›å‡º <code>NameError: name 'users' is not defined</code>ã€‚</p>
<p>è§‚å¯Ÿå­—èŠ‚ç ä¼šæ›´æ¸…æ™°ï¼š</p>
<pre tabindex="0"><code> L.   1         0  SETUP_ANNOTATIONS

 L.   1         2  LOAD_CONST               0
                4  LOAD_CONST               (&#39;List&#39;,)
                6  IMPORT_NAME              typing
                8  IMPORT_FROM              List
               10  STORE_NAME               List
               12  POP_TOP

 L.   3        14  LOAD_NAME                List
               16  LOAD_NAME                int
               18  BINARY_SUBSCR
               20  LOAD_NAME                __annotations__
               22  LOAD_STR                 &#39;users&#39;
               24  STORE_SUBSCR
               26  LOAD_CONST               None
               28  RETURN_VALUE
</code></pre><p>å¯ä»¥æ¸…æ™°çœ‹åˆ°ï¼Œå¹¶æ²¡æœ‰åˆ›å»ºä¸€ä¸ªåä¸º users çš„å˜é‡ï¼Œè€Œæ˜¯ä½¿ç”¨äº† <code>__annotations__</code> å˜é‡ã€‚
æ³¨ï¼šPython å­˜å‚¨å˜é‡ä½¿ç”¨ opcode æ˜¯ <code>STORE_NAME</code>ã€‚</p>
<p>PSï¼šæœ¬ææ¡ˆä¸­æœ‰ä¸å°‘è¢«å¦å†³çš„ææ¡ˆï¼ŒæŒºæœ‰è¶£çš„ï¼Œç¤¾åŒºæå‡ºäº†å¾ˆå¤šå¥‡æ·«å·§è®¡ã€‚
å¯ä»¥çœ‹å‡ºç¤¾åŒºå†³ç­–çš„æ…é‡ï¼Œå­˜é‡ç³»ç»Ÿå‡çº§çš„éš¾åº¦ã€‚</p>
<h3 id="pep-544---nominal-subtyping-vs-structural-subtyping">PEP 544 - Nominal Subtyping vs Structural Subtyping</h3>
<p>PEP 484 é‡Œé¢ç±»å‹ç³»ç»Ÿè®¨è®ºçš„æ˜¯ Nominal Subtypingï¼Œ
è¿™ä¸ª <a href="https://www.python.org/dev/peps/pep-0544/">PEP 544 &ndash; Protocols: Structural subtyping (static duck typing)</a>
åˆ™æ˜¯æå‡ºäº†Structural Subtypingã€‚
å¦‚æœéè¦ç¿»è¯‘ï¼Œæˆ‘è§‰å¾—å¯ä»¥ç§°ä¸ºå…·åå­ç±»å‹ / åŒæ„å­ç±»å‹ã€‚
æ³¨æ„ï¼Œä¹Ÿæœ‰äººå°† Structural Subtyping ç§°ä¹‹ä¸º Duck Typingï¼Œå…¶å®è¿™ä¸¤è€…ä¸ç›¸åŒï¼Œå…·ä½“å¯ä»¥è§
<a href="https://en.wikipedia.org/wiki/Duck_typing#Structural_type_systems">Duck typing / Comparison with other type systems</a>ã€‚</p>
<p>Nominal Subtyping æ˜¯æŒ‡æŒ‰å­—é¢é‡åŒ¹é…ç±»å‹ï¼Œè€Œ Structural Subtyping åˆ™æ˜¯æŒ‰ç…§ç»“æ„ï¼ˆè¡Œä¸ºï¼‰è¿›è¡ŒåŒ¹é…ï¼Œ
æ¯”å¦‚ Go çš„ Type å°±æ˜¯ Structural Subtyping å®ç°ã€‚</p>
<p>è¿™é‡Œå†™ä¸ªç®€å• Demo å±•ç¤ºä¸€ä¸‹åè€…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">Iterable</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Bucket</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="n">items</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="n">Bucket</span><span class="p">())</span>  <span class="c1"># Passes type check</span>
</span></span></code></pre></div><p>ä»£ç ä¸­å®šä¹‰äº† Bucket è¿™ç§ç±»å‹ï¼Œå¹¶ä¸”æä¾›äº†ä¸¤ä¸ªç±»æˆå‘˜ã€‚è¿™ä¸¤ä¸ªç±»æˆå‘˜åˆšå¥½æ˜¯ Interator çš„å®šä¹‰ã€‚
é‚£ä¹ˆåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå°±å¯ä»¥ä½¿ç”¨ Bucket æ›¿æ¢ Iterableã€‚</p>
<h3 id="pep-586--pep-589--pep-591-æŒç»­å¢å¼º">PEP 586 / PEP 589 / PEP 591 æŒç»­å¢å¼º</h3>
<p><a href="https://www.python.org/dev/peps/pep-0586/">PEP 586 &ndash; Literal Types</a>
åœ¨ Python 3.8 å®ç°ï¼Œæ”¯æŒäº†å­—é¢é‡ä½œä¸ºç±»å‹ä½¿ç”¨ã€‚
æ¯”å¦‚ <code>Literal[4]</code>ï¼Œä¸¾ä¸€ä¸ªæ›´æœ‰è¯­ä¹‰çš„ä¾‹å­ <code>Literal['GREEN']</code>ã€‚</p>
<p>æˆ‘ç¬¬ä¸€ååº”è¿™å’Œ Scala é‡Œé¢çš„ Symbol éå¸¸åƒï¼ŒScala ä¸­å†™æ³•æ˜¯ <code>Symbol(&quot;GREEN&quot;)</code>ã€‚
è¿™ä¸ªç‰¹æ€§ä½¿ç”¨æŒºå­¦é™¢æ´¾ï¼Œå¾ˆå®¹æ˜“åœ¨ DSL é‡Œé¢å†™çš„å¤©èŠ±ä¹±å ã€‚
Scala å®˜æ–¹æœ‰è¯´è¿‡å¯èƒ½åœ¨æœªæ¥ç§»é™¤ Symbol ç‰¹æ€§ï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨å¸¸é‡æ›¿ä»£ã€‚</p>
<p><a href="https://www.python.org/dev/peps/pep-0589/">PEP 589 &ndash; TypedDict: Type Hints for Dictionaries with a Fixed Set of Keys</a>
ç»™ Dict å¢åŠ  key çš„ Typeï¼Œç»§æ‰¿ <code>TypedDict</code>ã€‚</p>
<p><a href="https://www.python.org/dev/peps/pep-0591/">PEP 591 &ndash; Adding a final qualifier to typing</a>
å¢åŠ  <code>final</code> / <code>Final</code> ä¸¤ä¸ªæ¦‚å¿µï¼Œå‰è€…æ˜¯è£…é¥°å™¨ï¼Œåè€…æ˜¯æ³¨è§£ï¼Œæ ‡æ³¨è¯¥ç±» / å‡½æ•° / å˜é‡æ— æ³•ä¿®æ”¹</p>
<p>è‡³æ­¤ï¼ŒPython 3.8 å·²ç»å…·å¤‡æˆ‘ä»¬æ—¥å¸¸éœ€è¦çš„ç±»å‹ç³»ç»Ÿç‰¹æ€§ï¼ˆéè¿è¡Œæ—¶ ğŸ˜‚ï¼‰ã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>é—æ†¾çš„æ˜¯ï¼Œ<code>typing</code> æ¨¡å—åœ¨æ–‡æ¡£é²œæ˜çš„æ ‡æ³¨ï¼š</p>
<blockquote>
<p>The Python runtime does not enforce function and variable type annotations. They can be used by third party tools
such as type checkers, IDEs, linters, etc.</p></blockquote>
<p>å³ï¼šPython è¿è¡Œæ—¶ï¼ˆIntercepter / Code Evaluatorï¼‰å¹¶ä¸æ”¯æŒå‡½æ•°å’Œå˜é‡çš„ç±»å‹è£…é¥°ç¬¦ã€‚
è¿™äº›è£…é¥°ç¬¦åªèƒ½ç”±ç¬¬ä¸‰æ–¹å·¥å…·æ£€æŸ¥ï¼Œæ¯”å¦‚ç±»å‹æ£€æŸ¥å™¨ã€IDEã€é™æ€ã€Linterã€‚</p>
<p>è¿™ä¸ªä¿¡æ¯è¯´æ˜äº† Python åœ¨ç±»å‹å®‰å…¨ä¸Šå°è¯•çš„å±€é™æ€§ã€‚æ‰€æœ‰çš„é™åˆ¶ã€çº¦æŸéƒ½ä¸ä¼šå‘ç”Ÿåœ¨è¿è¡Œæ—¶ï¼Œ
æƒ³è¦ä»ç±»å‹ç³»ç»Ÿä¸­æ”¶è·å·¥ç¨‹ä¸Šé¢çš„ä»·å€¼ï¼Œåªèƒ½å€ŸåŠ©ç¬¬ä¸‰æ–¹å·¥å…·ã€‚</p>
<p>è¯šç„¶ï¼ŒPython ç¤¾åŒºåœ¨ç«­åŠ›å‘ç±»å‹ç³»ç»Ÿé æ‹¢ï¼Œä½†æ˜¯è¿™ç§éè¯­è¨€çº§åˆ« Runtime çš„æ”¯æŒï¼Œåˆ°åº•èƒ½èµ°å¤šè¿œå‘¢ï¼Ÿ
Python ç¼ºå°‘é‡‘ä¸»çˆ¸çˆ¸ï¼Œå¹²çˆ¹ Red Hat æŠ•å…¥èµ„æºä¹Ÿæœ‰é™ã€‚è¿ç¤¾åŒºä» Python 2 åˆ‡æ¢åˆ° Python 3 éƒ½è¿˜æ²¡èµ°å®Œï¼Œä¸ºä½•ï¼Ÿ
æŠ•å…¥äº§å‡ºæ¯”å¤ªä½ï¼Œæ–°ç‰¹æ€§ç¼ºä¹è¶³å¤Ÿçš„å¸å¼•åŠ›ï¼Œæ›¿ä»£å“å¤ªå¤šã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼Œçœ‹çœ‹ç«å¯¹ä»¬ï¼š
åŠ¨æ€è¯­è¨€åœ¨å¾€é™æ€è¯­è¨€é æ‹¢ï¼Œè€Œé™æ€è¯­è¨€ä¹Ÿåœ¨ä¸æ–­å¸æ”¶åŠ¨æ€è¯­è¨€çš„ç‰¹æ€§ã€‚æ¯”å¦‚ Java 14 é‡Œé¢çš„ REPLï¼ˆRead-Eval-Print-Loopï¼‰ï¼Œ
Kotlin / Scala ç­‰è¯­è¨€çš„ç±»å‹æ¨æ–­ï¼ˆType Inferenceï¼‰ã€‚
ä¹Ÿè®¸è¿™ç§æ¼”è¿›æ–¹å¼æ›´èƒ½å¤Ÿè®©ç”¨æˆ·æ¥å—å§ã€‚</p>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li><a href="https://docs.python.org/3/library/typing.html">typing â€” Support for type hints â€” Python 3.8.3 documentation</a></li>
<li><a href="https://www.python.org/dev/peps/pep-0483/#type-variables">PEP 483 &ndash; The Theory of Type Hints | Python.org</a></li>
<li><a href="https://www.python.org/dev/peps/pep-0484/#abstract">PEP 484 &ndash; Type Hints | Python.org</a></li>
<li><a href="https://www.bernat.tech/the-state-of-type-hints-in-python/">the state of type hints in Python</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>åœ¨ Python ä¸­ä½¿ç”¨ GDB æ¥è°ƒè¯•[è¯‘æ–‡]</title>
      <link>https://blog.alswl.com/2013/11/python-gdb/</link>
      <pubDate>Fri, 01 Nov 2013 01:11:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2013/11/python-gdb/</guid>
      <description>&lt;p&gt;å¤§çº¦ä¸€å¹´å‰ï¼Œæˆ‘æ¥è§¦äº† Java ä¸­çš„ &lt;a href=&#34;http://kenai.com/projects/btrace&#34;&gt;Btrace&lt;/a&gt;
èƒ½å¤Ÿä¸åœæœºæŸ¥çœ‹çº¿ä¸Š JVM è¿è¡Œæƒ…å†µçš„ç‰¹æ€§è®©æˆ‘è‰³ç¾¡ä¸å·²ã€‚
å¦å¤–è¿˜æœ‰å¼ºæ‚çš„ jStack å’Œ jConsole æ¥è¿›è¡Œè¿è¡ŒæœŸä¾¦æµ‹ï¼ŒJVM çš„å·¥ä¸šçº§å¼ºåº¦æœç„¶ä¸æ˜¯ç›–çš„ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ—¶å…¬å¸æŠ€æœ¯æ–¹é¢ä¹Ÿé‡åˆ°äº†ä¸€äº›ç“¶é¢ˆï¼Œä¸€éƒ¨åˆ†åŸå› æ˜¯ CPython æœ¬èº«çš„ IO æ¨¡å‹é—®é¢˜ï¼Œ
å¦ä¸€æ–¹é¢ä¹Ÿå’Œæ—©æœŸä»£ç å†™çš„æä¸å·¥æ•´è„±ä¸äº†å…³ç³»ã€‚ä¸‡èˆ¬æ— å¥ˆä¹‹ä¸‹ï¼Œæˆ‘ä»¬ç”¨
Jython æ¨ç¿»é‡åšäº†ä¸»è¦ä¸šåŠ¡ï¼Œæ•ˆæœç«‹ç«¿è§å½±ï¼Œä½†åŒæ—¶ä¹ŸæŠŠçœŸå®é—®é¢˜ç»™è§„é¿æ‰äº†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¹‹åæˆ‘ä»¬åœ¨ JVM çš„é¢†å¯¼ä¸‹ï¼Œèµ°ä¸Šäº†åº·åº„å¤§é“ã€‚ä½†æˆ‘å¿ƒä¸­å§‹ç»ˆè¿˜æœ‰ä¸€ä¸ªæ¢—ï¼Œ
å°±æ˜¯æƒ³å¯¹æ€§èƒ½é‡åˆ°ç“¶é¢ˆçš„ Python Process è¿›è¡Œçº¿ä¸Šä¾¦æµ‹ã€‚
è¿™ç¯‡æ–‡ç« å°±æ˜¯å¼€å§‹çš„ç¬¬ä¸€æ­¥ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>å¤§çº¦ä¸€å¹´å‰ï¼Œæˆ‘æ¥è§¦äº† Java ä¸­çš„ <a href="http://kenai.com/projects/btrace">Btrace</a>
èƒ½å¤Ÿä¸åœæœºæŸ¥çœ‹çº¿ä¸Š JVM è¿è¡Œæƒ…å†µçš„ç‰¹æ€§è®©æˆ‘è‰³ç¾¡ä¸å·²ã€‚
å¦å¤–è¿˜æœ‰å¼ºæ‚çš„ jStack å’Œ jConsole æ¥è¿›è¡Œè¿è¡ŒæœŸä¾¦æµ‹ï¼ŒJVM çš„å·¥ä¸šçº§å¼ºåº¦æœç„¶ä¸æ˜¯ç›–çš„ã€‚</p>
<p>å½“æ—¶å…¬å¸æŠ€æœ¯æ–¹é¢ä¹Ÿé‡åˆ°äº†ä¸€äº›ç“¶é¢ˆï¼Œä¸€éƒ¨åˆ†åŸå› æ˜¯ CPython æœ¬èº«çš„ IO æ¨¡å‹é—®é¢˜ï¼Œ
å¦ä¸€æ–¹é¢ä¹Ÿå’Œæ—©æœŸä»£ç å†™çš„æä¸å·¥æ•´è„±ä¸äº†å…³ç³»ã€‚ä¸‡èˆ¬æ— å¥ˆä¹‹ä¸‹ï¼Œæˆ‘ä»¬ç”¨
Jython æ¨ç¿»é‡åšäº†ä¸»è¦ä¸šåŠ¡ï¼Œæ•ˆæœç«‹ç«¿è§å½±ï¼Œä½†åŒæ—¶ä¹ŸæŠŠçœŸå®é—®é¢˜ç»™è§„é¿æ‰äº†ã€‚</p>
<p>åœ¨è¿™ä¹‹åæˆ‘ä»¬åœ¨ JVM çš„é¢†å¯¼ä¸‹ï¼Œèµ°ä¸Šäº†åº·åº„å¤§é“ã€‚ä½†æˆ‘å¿ƒä¸­å§‹ç»ˆè¿˜æœ‰ä¸€ä¸ªæ¢—ï¼Œ
å°±æ˜¯æƒ³å¯¹æ€§èƒ½é‡åˆ°ç“¶é¢ˆçš„ Python Process è¿›è¡Œçº¿ä¸Šä¾¦æµ‹ã€‚
è¿™ç¯‡æ–‡ç« å°±æ˜¯å¼€å§‹çš„ç¬¬ä¸€æ­¥ã€‚</p>
<p>PS:è¿™ç¯‡æ–‡ç« ç†è®ºä¸Šæ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯åœ¨æˆ‘æœºå™¨ï¼ˆUbuntu 12.04 / ç³»ç»Ÿè‡ªå¸¦ Pythonï¼‰
æ— æ³•æ­£å¸¸æ‰§è¡Œï¼Œä¼šçˆ†å‡º <code>unable to read python frame information</code>
çš„é—®é¢˜ã€‚è§£å†³æ–¹æ³•æˆ‘ä¼šåœ¨ä¸‹ç¯‡æ–‡ç« ä¸­å†™å‡ºã€‚è¿™é‡Œåªæ˜¯å•çº¯ç¿»è¯‘ä¸€ä¸‹åŸæ–‡ã€‚</p>
<p>åŸæ–‡å¯ä»¥ç§»æ­¥ <a href="https://wiki.python.org/moin/DebuggingWithGdb">https://wiki.python.org/moin/DebuggingWithGdb</a>ã€‚</p>
<!-- more -->
<hr />
<p>æœ‰ä¸€äº›ç±»å‹çš„ bugs å¾ˆéš¾ä½¿ç”¨ Python ç›´æ¥è¿›è¡Œ debugï¼Œæ¯”å¦‚</p>
<ul>
<li>æ®µé”™è¯¯ï¼ˆæ— æ³•è¢«æ•æ‰çš„ Python å¼‚å¸¸ï¼‰</li>
<li>å¡ä½çš„è¿›ç¨‹ï¼ˆè¿™ç§æƒ…å†µä¸‹é¢æ²¡æ³•ä½¿ç”¨ <code>pdb</code> æ¥è¿›è¡Œè·Ÿè¸ªï¼‰</li>
<li>æ§åˆ¶ä¹‹å¤–çš„åå°å¤„ç† daemon è¿›ç¨‹</li>
</ul>
<p>è¿™äº›æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨å°è¯•ä½¿ç”¨ <code>gdb</code>ã€‚</p>
<h2 id="å‡†å¤‡">å‡†å¤‡</h2>
<p>éœ€è¦åœ¨ç³»ç»Ÿå®‰è£… <code>gdb</code> å’Œ Python debug æ‰©å±•ã€‚
Python debug æ‰©å±•åŒ…å«äº†ä¸€äº› debug å‘½ä»¤ï¼Œå¹¶ä¸”æ·»åŠ äº†ä¸€äº› Python ç‰¹å®šçš„å‘½ä»¤åˆ° <code>gdb</code>ã€‚
åœ¨ä¸»æµçš„ Linux å‘è¡Œç‰ˆä¸­ï¼Œä½ å¯ä»¥è½»æ¾çš„å®‰è£…ä»–ä»¬ï¼š</p>
<p>Fedora:</p>
<pre tabindex="0"><code>sudo yum install gdb python-debuginfo
</code></pre><p>Ubunt:</p>
<pre tabindex="0"><code>sudo apt-get install gdb python2.7-dbg
</code></pre><p>åœ¨ä¸€äº›è€ç³»ç»Ÿä¸Šé¢ï¼Œä¹Ÿä¸€æ ·å¯ä»¥ä½¿ç”¨ <code>gdb</code>ï¼Œå…·ä½“çœ‹æ–‡ç« æœ«å°¾ã€‚</p>
<h2 id="ä½¿ç”¨-gdb">ä½¿ç”¨ <code>GDB</code></h2>
<p>æœ‰ä¸¤ç§å¯è¡Œçš„æ–¹æ³•ï¼š</p>
<ol>
<li>ä¸€å¼€å§‹å°±ä½¿ç”¨ <code>gdb</code> æ¥å¯åŠ¨åº”ç”¨</li>
<li>è¿æ¥åˆ°ä¸€ä¸ªå·²ç»è¿è¡Œçš„ Python è¿›ç¨‹</li>
</ol>
<p>åœ¨ <code>gdb</code> ä¸‹é¢å¯åŠ¨ Python åŒæ ·æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<p>äº¤äº’å¼ï¼š</p>
<pre tabindex="0"><code>$ gdb python
...
(gdb) run &lt;programname&gt;.py &lt;arguments&gt;
</code></pre><p>è‡ªåŠ¨ï¼š</p>
<pre tabindex="0"><code>$ gdb -ex r --args python &lt;programname&gt;.py &lt;arguments&gt;
</code></pre><p>è¿™æ ·çš„è¯ï¼Œå®ƒä¼šä¸€ç›´è¿è¡Œç›´åˆ°é€€å‡ºã€æ®µé”™è¯¯ã€æˆ–è€…äººä¸ºçš„åœæ­¢ï¼ˆä½¿ç”¨ <code>Ctrl+C</code>ï¼‰ã€‚</p>
<p>å¦‚æœè¿›ç¨‹å·²ç»å¼€å§‹è¿è¡Œï¼Œä½ å¯ä»¥é€šè¿‡ PID æ¥æ¥å…¥å®ƒï¼š</p>
<pre tabindex="0"><code>$ gdb python &lt;pid of running process&gt;
</code></pre><h2 id="è°ƒè¯•è¿›ç¨‹">è°ƒè¯•è¿›ç¨‹</h2>
<p>å¦‚æœä½ çš„ç¨‹åºæ®µé”™è¯¯äº†ï¼Œ <code>gdb</code> ä¼šè‡ªåŠ¨æš‚åœç¨‹åºï¼Œè¿™æ ·ä½ å¯ä»¥åˆ‡æ¢åˆ° <code>gdb</code>
å‘½ä»¤è¡Œæ¥æ£€æŸ¥çŠ¶æ€ã€‚ä½ ä¹Ÿå¯ä»¥äººä¸ºåœ°ä½¿ç”¨ <code>Ctrl+C</code> æ¥æš‚åœç¨‹åºè¿è¡Œã€‚</p>
<p>æŸ¥çœ‹ <a href="https://fedoraproject.org/wiki/Features/EasierPythonDebugging">EasierPythonDebugging</a>
è·å¾— <code>gdb</code> é‡Œé¢çš„ Python å‘½ä»¤åˆ—è¡¨ã€‚</p>
<h2 id="æŸ¥çœ‹-c-è°ƒç”¨æ ˆ">æŸ¥çœ‹ C è°ƒç”¨æ ˆ</h2>
<p>å¦‚æœä½ åœ¨ debug æ®µé”™è¯¯ï¼Œä½ æœ€æƒ³åšçš„å¯èƒ½å°±æ˜¯æŸ¥çœ‹ C è°ƒç”¨æ ˆã€‚</p>
<p>åœ¨ <code>gdb</code> çš„å‘½ä»¤è¡Œé‡Œé¢ï¼Œåªè¦è¿è¡Œä¸€ä¸‹å‘½ä»¤ï¼š</p>
<pre tabindex="0"><code>(gdb) bt
#0  0x0000002a95b3b705 in raise () from /lib/libc.so.6
#1  0x0000002a95b3ce8e in abort () from /lib/libc.so.6
#2  0x00000000004c164f in posix_abort (self=0x0, noargs=0x0)
    at ../Modules/posixmodule.c:7158
#3  0x0000000000489fac in call_function (pp_stack=0x7fbffff110, oparg=0)
    at ../Python/ceval.c:3531
#4  0x0000000000485fc2 in PyEval_EvalFrame (f=0x66ccd8)
    at ../Python/ceval.c:2163
...
</code></pre><p>è¿æ°”å¥½çš„è¯ï¼Œä½ å¯ä»¥ç›´æ¥çœ‹åˆ°é—®é¢˜å‡ºç°åœ¨ä»€ä¹ˆåœ°æ–¹ã€‚å¦‚æœå®ƒæä¾›çš„ä¿¡æ¯ä¸èƒ½ç›´æ¥å¸®ä½ è§£å†³é—®é¢˜ï¼Œ
ä½ å¯ä»¥å°è¯•ç»§ç»­è¿½è¸ªè°ƒç”¨æ ˆã€‚
è°ƒå¼çš„ç»“æœå–å†³äº debug ä¿¡æ¯çš„æœ‰æ•ˆç¨‹åº¦ã€‚</p>
<h2 id="æŸ¥çœ‹-python-è°ƒç”¨æ ˆ">æŸ¥çœ‹ Python è°ƒç”¨æ ˆ</h2>
<p>å¦‚æœä½ å®‰è£…äº† Python æ‰©å±•ï¼Œä½ å¯ä»¥ä½¿ç”¨</p>
<pre tabindex="0"><code>(gdb) py-bt
</code></pre><p>å¯ä»¥è·å–ç†Ÿæ‚‰çš„ Python æºä»£ç ã€‚</p>
<h2 id="å¯¹æŒ‚ä½çš„è¿›ç¨‹å¼€åˆ€">å¯¹æŒ‚ä½çš„è¿›ç¨‹å¼€åˆ€</h2>
<p>å¦‚æœä¸€ä¸ªè¿›ç¨‹çœ‹ä¸Šå»æŒ‚ä½äº†ï¼Œä»–å¯èƒ½åœ¨ç­‰å¾…ä»€ä¹ˆä¸œè¥¿ï¼ˆæ¯”å¦‚é”ã€IO ç­‰ç­‰ï¼‰ã€‚
ä¹Ÿæœ‰å¯èƒ½åœ¨æ‹¼å‘½çš„è·‘å¾ªç¯ã€‚è¿æ¥ä¸Šè¿™ä¸ªè¿›ç¨‹ï¼Œç„¶åæ£€æŸ¥è°ƒç”¨æ ˆä¹Ÿè®¸å¯ä»¥å¸®ä¸Šå¿™ã€‚</p>
<p>å¦‚æœè¿›ç¨‹åœ¨ç–¯ç‹‚å¾ªç¯ï¼Œä½ å¯ä»¥å…ˆè®©å®ƒè¿è¡Œä¸€ä¼šï¼Œä½¿ç”¨ <code>cont</code> å‘½ä»¤ï¼Œ
ç„¶åä½¿ç”¨ <code>Ctrl+C</code> æ¥æš‚åœï¼Œå¹¶ä¸”æ‰“å°å‡ºè°ƒç”¨æ ˆã€‚</p>
<p>å¦‚æœä¸€äº›çº¿ç¨‹å¡ä½äº†ï¼Œä¸‹é¢çš„å‘½ä»¤å¯èƒ½ä¼šå¸®ä¸Šå¿™ï¼š</p>
<pre tabindex="0"><code>(gdb) info threads
  Id   Target Id         Frame
  37   Thread 0xa29feb40 (LWP 17914) &#34;NotificationThr&#34; 0xb7fdd424 in __kernel_vsyscall ()
  36   Thread 0xa03fcb40 (LWP 17913) &#34;python2.7&#34; 0xb7fdd424 in __kernel_vsyscall ()
  35   Thread 0xa0bfdb40 (LWP 17911) &#34;QProcessManager&#34; 0xb7fdd424 in __kernel_vsyscall ()
  34   Thread 0xa13feb40 (LWP 17910) &#34;python2.7&#34; 0xb7fdd424 in __kernel_vsyscall ()
  33   Thread 0xa1bffb40 (LWP 17909) &#34;python2.7&#34; 0xb7fdd424 in __kernel_vsyscall ()
  31   Thread 0xa31ffb40 (LWP 17907) &#34;QFileInfoGather&#34; 0xb7fdd424 in __kernel_vsyscall ()
  30   Thread 0xa3fdfb40 (LWP 17906) &#34;QInotifyFileSys&#34; 0xb7fdd424 in __kernel_vsyscall ()
  29   Thread 0xa481cb40 (LWP 17905) &#34;QFileInfoGather&#34; 0xb7fdd424 in __kernel_vsyscall ()
  7    Thread 0xa508db40 (LWP 17883) &#34;QThread&#34; 0xb7fdd424 in __kernel_vsyscall ()
  6    Thread 0xa5cebb40 (LWP 17882) &#34;python2.7&#34; 0xb7fdd424 in __kernel_vsyscall ()
  5    Thread 0xa660cb40 (LWP 17881) &#34;python2.7&#34; 0xb7fdd424 in __kernel_vsyscall ()
  3    Thread 0xabdffb40 (LWP 17876) &#34;gdbus&#34; 0xb7fdd424 in __kernel_vsyscall ()
  2    Thread 0xac7b7b40 (LWP 17875) &#34;dconf worker&#34; 0xb7fdd424 in __kernel_vsyscall ()
* 1    Thread 0xb7d876c0 (LWP 17863) &#34;python2.7&#34; 0xb7fdd424 in __kernel_vsyscall ()
</code></pre><p>å½“å‰è¿è¡Œçš„çº¿ç¨‹è¢«æ ‡è®°ä¸º <code>*</code>ï¼Œè¦æŸ¥çœ‹ Python ä»£ç è¿è¡Œåˆ°å“ªé‡Œï¼Œä½¿ç”¨ <code>py-list</code> æŸ¥çœ‹ï¼š</p>
<pre tabindex="0"><code>(gdb) py-list
2025        # Open external files with our Mac app
2026        if sys.platform == &#34;darwin&#34; and &#39;Spyder.app&#39; in __file__:
2027            main.connect(app, SIGNAL(&#39;open_external_file(QString)&#39;),
2028                         lambda fname: main.open_external_file(fname))
2029
&gt;2030        app.exec_()
2031        return main
2032
2033
2034    def __remove_temp_session():
2035        if osp.isfile(TEMP_SESSION_PATH):
</code></pre><p>æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹çš„ Python ä»£ç ä½ç½®ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>
<pre tabindex="0"><code>(gdb) thread apply all py-list
...
 200
 201        def accept(self):
&gt;202            sock, addr = self._sock.accept()
 203            return _socketobject(_sock=sock), addr
 204        accept.__doc__ = _realsocket.accept.__doc__
 205
 206        def dup(self):
 207            &#34;&#34;&#34;dup() -&gt; socket object

Thread 35 (Thread 0xa0bfdb40 (LWP 17911)):
Unable to locate python frame

Thread 34 (Thread 0xa13feb40 (LWP 17910)):
 197            for method in _delegate_methods:
 198                setattr(self, method, dummy)
 199        close.__doc__ = _realsocket.close.__doc__
 200
 201        def accept(self):
&gt;202            sock, addr = self._sock.accept()
 203            return _socketobject(_sock=sock), addr
...
</code></pre><h2 id="å¼•ç”¨">å¼•ç”¨</h2>
<ul>
<li><a href="http://fedoraproject.org/wiki/Features/EasierPythonDebugging">http://fedoraproject.org/wiki/Features/EasierPythonDebugging</a></li>
<li><a href="https://code.google.com/p/spyderlib/wiki/HowToDebugDeadlock">https://code.google.com/p/spyderlib/wiki/HowToDebugDeadlock</a></li>
</ul>
<h2 id="è€ç³»ç»Ÿä¸Šçš„-gdb">è€ç³»ç»Ÿä¸Šçš„ GDB</h2>
<p>æœ‰æ—¶å€™ä½ éœ€è¦åœ¨è€ç³»ç»Ÿä¸Šé¢å®‰è£… <code>gdb</code>ï¼Œè¿™æ—¶å€™ä½ å¯èƒ½éœ€è¦ä¸‹åˆ—ä¿¡æ¯ï¼š</p>
<h3 id="gdb-macros">GDB Macros</h3>
<p>ä¸€äº›éšç€ Python å‘å¸ƒçš„ GDB è„šæœ¬å¯ä»¥ç”¨æ¥è°ƒè¯• Python è¿›ç¨‹ã€‚
ä½ å¯ä»¥æŠŠ Python æºç é‡Œé¢çš„ <code>Misc/gdbinit</code>  æ‹·è´åˆ° <code>~/.gdbinit</code>ï¼Œ
æˆ–è€…ä» <a href="http://svn.python.org/view/python/branches/release27-maint/Misc/gdbinit?view=log">Subversion</a>
æ¥æ‹·è´ä»–ä»¬ã€‚è¯·æ³¨æ„ä½ çš„ Pythonï¼Œç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ä»£ç ç‰ˆæœ¬ï¼Œå¦åˆ™æœ‰äº›åŠŸèƒ½å¯èƒ½æ— æ³•å·¥ä½œã€‚</p>
<p>è¯·æ³¨æ„æœ‰äº›æ–°çš„ GDB å‘½ä»¤åªæœ‰åœ¨ debug éœ€è¦çš„åº“å­˜åœ¨æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚</p>
<p>è¿™ä¸ªè„šæœ¬åœ¨ Ubuntu ä¸Šé¢çš„ gcc 4.5.2 å·¥ä½œæ—¶ï¼Œä¼šçˆ†å‡ºé”™è¯¯
<code>No symbol &quot;co&quot; in current context.</code>ï¼Œæ˜¯å› ä¸º <code>call_function</code> åœ¨
<a href="https://wiki.python.org/moin/EvalFrameEx">PyEval_EvalFrameEx</a> å’Œ
<a href="https://wiki.python.org/moin/EvalCodeEx">PyEval_EvalCodeEx</a> ä¹‹é—´ã€‚
é‡æ–°ä½¿ç”¨ <code>make &quot;CFLAGS=-g -fno-inline -fno-strict-aliasing&quot;</code>
ç¼–è¯‘ Python å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<h3 id="ä½¿ç”¨-python-stack-traces-gdb-è„šæœ¬">ä½¿ç”¨ Python Stack Traces GDB è„šæœ¬</h3>
<p>åœ¨ gdb å‘½ä»¤è¡Œé‡Œï¼Œå¯ä»¥è¿™æ ·æŸ¥çœ‹ Python stack trace:</p>
<pre tabindex="0"><code>(gdb) pystack
</code></pre><p>åŒæ ·çš„ï¼Œå¯ä»¥è·å–ä¸€åˆ— stack frame çš„ Python å˜é‡ï¼š</p>
<pre tabindex="0"><code>(gdb) pystackv
</code></pre><p>æ›´å¤š gdbinit é‡Œé¢æ²¡å®šä¹‰çš„æœ‰ç”¨çš„è„šæœ¬å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼š</p>
<p><a href="http://web.archive.org/web/20070915134837/http://www.mashebali.com/?Python_GDB_macros:The_Macros">http://web.archive.org/web/20070915134837/http://www.mashebali.com/?Python_GDB_macros:The_Macros</a></p>
]]></content:encoded>
    </item>
    <item>
      <title>åœ¨ Python ä¸­ä½¿ç”¨ epoll[è¯‘æ–‡]</title>
      <link>https://blog.alswl.com/2013/01/python-epoll/</link>
      <pubDate>Sat, 12 Jan 2013 00:01:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2013/01/python-epoll/</guid>
      <description>&lt;p&gt;åŸæ–‡åœ°å€ï¼š &lt;a href=&#34;http://scotdoyle.com/python-epoll-howto.html&#34;&gt;http://scotdoyle.com/python-epoll-howto.html&lt;/a&gt; ï¼Œ
æˆ‘è¿™é‡Œå–ç²¾ç®€å†…å®¹ç¿»è¯‘è¿‡æ¥ã€‚&lt;/p&gt;
&lt;p&gt;============ æ­£æ–‡å¼€å§‹ ============&lt;/p&gt;
&lt;h2 id=&#34;ä»‹ç»&#34;&gt;ä»‹ç»&lt;/h2&gt;
&lt;p&gt;Python ä» 2.6 å¼€å§‹æ”¯æŒ &lt;a href=&#34;http://linux.die.net/man/4/epoll&#34;&gt;epoll&lt;/a&gt;ã€‚ç°åœ¨æˆ‘ä»¬ç”¨ Python3 æ¥å†™åŸºäºè¿™äº› API
çš„ epoll èŒƒä¾‹ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;h2 id=&#34;é˜»å¡çš„-socket-é€šä¿¡èŒƒä¾‹&#34;&gt;é˜»å¡çš„ Socket é€šä¿¡èŒƒä¾‹&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;socket&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;EOL1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;EOL2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n\r\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;HTTP/1.0 200 OK&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\r\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;date: &amp;#34;2013-01-12T00:01:00+08:00&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type: text/plain&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\r\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;Content-Length: 13&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\r\n\r\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Hello, world!&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;serversocket&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;AF_INET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;serversocket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;setsockopt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SOL_SOCKET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;socket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SO_REUSEADDR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;serversocket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;0.0.0.0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8080&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;serversocket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;listen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;n&#34;&gt;connectiontoclient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;serversocket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;accept&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;EOL1&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;EOL2&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;connectiontoclient&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1024&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;40&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()[:&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;n&#34;&gt;connectiontoclient&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;n&#34;&gt;connectiontoclient&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;finally&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;n&#34;&gt;serversocket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªèŒƒä¾‹ä¸­çš„ä»£ç åœ¨ &lt;code&gt;accept()&lt;/code&gt; ã€ &lt;code&gt;recv()&lt;/code&gt; å’Œ &lt;code&gt;send()&lt;/code&gt; æ—¶å€™ä¼šå‘ç”Ÿé˜»å¡ï¼Œ
å¯¼è‡´å…¶ä»–è¿æ¥æ— æ³•å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨é˜»å¡æ¨¡å‹æ—¶å€™ï¼Œä¼šä¸“é—¨å»ºç«‹ä¸€ä¸ªä¸»çº¿ç¨‹æ¥è¿›è¡Œç›‘å¬ï¼Œ
å°†å»ºç«‹æˆåŠŸçš„è¿æ¥äº¤ç»™å…¶ä»–çº¿ç¨‹æ“ä½œï¼Œç„¶åç»§ç»­åœ¨ä¸»çº¿ç¨‹ä¸Šé¢ç›‘å¬ã€‚
è¿™æ ·ä¸€æ¥ï¼Œå°±ä¸ä¼šå—å•æ¬¡è¯·æ±‚é˜»å¡çš„é™åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.kegel.com/c10k.html&#34;&gt;C10K&lt;/a&gt; é—®é¢˜æè¿°äº†å…¶ä»–å¤„ç†é«˜å¹¶å‘æ–¹æ³•ï¼Œæ¯”å¦‚å¼‚æ­¥ Socketï¼Œ
é€šè¿‡ç›‘å¬äº‹ä»¶æ¥è§¦å‘é¢„è®¾çš„å“åº”ã€‚å¼‚æ­¥ Socket å¯ä»¥æ˜¯å•çº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šçº¿ç¨‹ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>åŸæ–‡åœ°å€ï¼š <a href="http://scotdoyle.com/python-epoll-howto.html">http://scotdoyle.com/python-epoll-howto.html</a> ï¼Œ
æˆ‘è¿™é‡Œå–ç²¾ç®€å†…å®¹ç¿»è¯‘è¿‡æ¥ã€‚</p>
<p>============ æ­£æ–‡å¼€å§‹ ============</p>
<h2 id="ä»‹ç»">ä»‹ç»</h2>
<p>Python ä» 2.6 å¼€å§‹æ”¯æŒ <a href="http://linux.die.net/man/4/epoll">epoll</a>ã€‚ç°åœ¨æˆ‘ä»¬ç”¨ Python3 æ¥å†™åŸºäºè¿™äº› API
çš„ epoll èŒƒä¾‹ã€‚</p>
<!-- more -->
<h2 id="é˜»å¡çš„-socket-é€šä¿¡èŒƒä¾‹">é˜»å¡çš„ Socket é€šä¿¡èŒƒä¾‹</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">socket</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">EOL1</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">EOL2</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n\r\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span>  <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;HTTP/1.0 200 OK</span><span class="se">\r\n</span><span class="s1">date: &#34;2013-01-12T00:01:00+08:00&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;Content-Type: text/plain</span><span class="se">\r\n</span><span class="s1">Content-Length: 13</span><span class="se">\r\n\r\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;Hello, world!&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">serversocket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">serversocket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SO_REUSEADDR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">serversocket</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="mi">8080</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">serversocket</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">   <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">connectiontoclient</span><span class="p">,</span> <span class="n">address</span> <span class="o">=</span> <span class="n">serversocket</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="n">request</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="k">while</span> <span class="n">EOL1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">request</span> <span class="ow">and</span> <span class="n">EOL2</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">request</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">          <span class="n">request</span> <span class="o">+=</span> <span class="n">connectiontoclient</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">40</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">request</span><span class="o">.</span><span class="n">decode</span><span class="p">()[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">      <span class="n">connectiontoclient</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">connectiontoclient</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">finally</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">serversocket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></div><p>è¿™ä¸ªèŒƒä¾‹ä¸­çš„ä»£ç åœ¨ <code>accept()</code> ã€ <code>recv()</code> å’Œ <code>send()</code> æ—¶å€™ä¼šå‘ç”Ÿé˜»å¡ï¼Œ
å¯¼è‡´å…¶ä»–è¿æ¥æ— æ³•å®Œæˆã€‚</p>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨é˜»å¡æ¨¡å‹æ—¶å€™ï¼Œä¼šä¸“é—¨å»ºç«‹ä¸€ä¸ªä¸»çº¿ç¨‹æ¥è¿›è¡Œç›‘å¬ï¼Œ
å°†å»ºç«‹æˆåŠŸçš„è¿æ¥äº¤ç»™å…¶ä»–çº¿ç¨‹æ“ä½œï¼Œç„¶åç»§ç»­åœ¨ä¸»çº¿ç¨‹ä¸Šé¢ç›‘å¬ã€‚
è¿™æ ·ä¸€æ¥ï¼Œå°±ä¸ä¼šå—å•æ¬¡è¯·æ±‚é˜»å¡çš„é™åˆ¶ã€‚</p>
<p><a href="http://www.kegel.com/c10k.html">C10K</a> é—®é¢˜æè¿°äº†å…¶ä»–å¤„ç†é«˜å¹¶å‘æ–¹æ³•ï¼Œæ¯”å¦‚å¼‚æ­¥ Socketï¼Œ
é€šè¿‡ç›‘å¬äº‹ä»¶æ¥è§¦å‘é¢„è®¾çš„å“åº”ã€‚å¼‚æ­¥ Socket å¯ä»¥æ˜¯å•çº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šçº¿ç¨‹ã€‚</p>
<p>Python çš„ API ä¸­åŒ…å«äº† select / poll / epollï¼Œå…·ä½“çš„å¯ç”¨æ€§ä¾èµ–äºæ“ä½œç³»ç»Ÿã€‚
ä»–ä»¬çš„æ•ˆç‡æ˜¯ epoll &gt; poll &gt; selectï¼Œä»è¿™ä¸ª <a href="http://lse.sourceforge.net/epoll/index.html">æ€§èƒ½æµ‹è¯•æ–‡ç« </a> å°±å¯ä»¥çœ‹å‡ºæ¥ã€‚</p>
<h2 id="epoll-å¼‚æ­¥ç¼–ç¨‹èŒƒä¾‹">epoll å¼‚æ­¥ç¼–ç¨‹èŒƒä¾‹</h2>
<p>epoll çš„æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li>åˆ›å»º epoll å®ä¾‹</li>
<li>å‘Šè¯‰ epoll å»ç›‘å¬å“ªå‡ ç§ç±»å‹äº‹ä»¶</li>
<li>å‘ epoll æŸ¥è¯¢æœ€è¿‘å·²ç›‘å¬äº‹ä»¶çš„å˜åŒ–</li>
<li>æ ¹æ®ä¸åŒçš„ç±»å‹åšä¸åŒçš„å¤„ç†</li>
<li>è®© epoll ä¿®æ”¹ç›‘å¬åˆ—è¡¨</li>
<li>é‡å¤ 3-5 ç›´åˆ°ç»“æŸ</li>
<li>æ¶ˆç­ epoll å®ä¾‹</li>
</ol>
<p>èŒƒä¾‹ä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">socket</span><span class="o">,</span> <span class="nn">select</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">EOL1</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">EOL2</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n\r\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span>  <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;HTTP/1.0 200 OK</span><span class="se">\r\n</span><span class="s1">date: &#34;2013-01-12T00:01:00+08:00&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;Content-Type: text/plain</span><span class="se">\r\n</span><span class="s1">Content-Length: 13</span><span class="se">\r\n\r\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;Hello, world!&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">serversocket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">serversocket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SO_REUSEADDR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">serversocket</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="mi">8080</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">serversocket</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">serversocket</span><span class="o">.</span><span class="n">setblocking</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">epoll</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">epoll</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">epoll</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">serversocket</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="n">select</span><span class="o">.</span><span class="n">EPOLLIN</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">connections</span> <span class="o">=</span> <span class="p">{};</span> <span class="n">requests</span> <span class="o">=</span> <span class="p">{};</span> <span class="n">responses</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">   <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">events</span> <span class="o">=</span> <span class="n">epoll</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="n">fileno</span><span class="p">,</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">         <span class="k">if</span> <span class="n">fileno</span> <span class="o">==</span> <span class="n">serversocket</span><span class="o">.</span><span class="n">fileno</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="n">connection</span><span class="p">,</span> <span class="n">address</span> <span class="o">=</span> <span class="n">serversocket</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">connection</span><span class="o">.</span><span class="n">setblocking</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">epoll</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">connection</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="n">select</span><span class="o">.</span><span class="n">EPOLLIN</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">connections</span><span class="p">[</span><span class="n">connection</span><span class="o">.</span><span class="n">fileno</span><span class="p">()]</span> <span class="o">=</span> <span class="n">connection</span>
</span></span><span class="line"><span class="cl">            <span class="n">requests</span><span class="p">[</span><span class="n">connection</span><span class="o">.</span><span class="n">fileno</span><span class="p">()]</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="n">responses</span><span class="p">[</span><span class="n">connection</span><span class="o">.</span><span class="n">fileno</span><span class="p">()]</span> <span class="o">=</span> <span class="n">response</span>
</span></span><span class="line"><span class="cl">         <span class="k">elif</span> <span class="n">event</span> <span class="o">&amp;</span> <span class="n">select</span><span class="o">.</span><span class="n">EPOLLIN</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">requests</span><span class="p">[</span><span class="n">fileno</span><span class="p">]</span> <span class="o">+=</span> <span class="n">connections</span><span class="p">[</span><span class="n">fileno</span><span class="p">]</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">EOL1</span> <span class="ow">in</span> <span class="n">requests</span><span class="p">[</span><span class="n">fileno</span><span class="p">]</span> <span class="ow">or</span> <span class="n">EOL2</span> <span class="ow">in</span> <span class="n">requests</span><span class="p">[</span><span class="n">fileno</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">               <span class="n">epoll</span><span class="o">.</span><span class="n">modify</span><span class="p">(</span><span class="n">fileno</span><span class="p">,</span> <span class="n">select</span><span class="o">.</span><span class="n">EPOLLOUT</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">               <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">40</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">requests</span><span class="p">[</span><span class="n">fileno</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">()[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">         <span class="k">elif</span> <span class="n">event</span> <span class="o">&amp;</span> <span class="n">select</span><span class="o">.</span><span class="n">EPOLLOUT</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">byteswritten</span> <span class="o">=</span> <span class="n">connections</span><span class="p">[</span><span class="n">fileno</span><span class="p">]</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">responses</span><span class="p">[</span><span class="n">fileno</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">responses</span><span class="p">[</span><span class="n">fileno</span><span class="p">]</span> <span class="o">=</span> <span class="n">responses</span><span class="p">[</span><span class="n">fileno</span><span class="p">][</span><span class="n">byteswritten</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">responses</span><span class="p">[</span><span class="n">fileno</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">               <span class="n">epoll</span><span class="o">.</span><span class="n">modify</span><span class="p">(</span><span class="n">fileno</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">               <span class="n">connections</span><span class="p">[</span><span class="n">fileno</span><span class="p">]</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SHUT_RDWR</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">         <span class="k">elif</span> <span class="n">event</span> <span class="o">&amp;</span> <span class="n">select</span><span class="o">.</span><span class="n">EPOLLHUP</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">epoll</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="n">fileno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">connections</span><span class="p">[</span><span class="n">fileno</span><span class="p">]</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">del</span> <span class="n">connections</span><span class="p">[</span><span class="n">fileno</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">finally</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">   <span class="n">epoll</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="n">serversocket</span><span class="o">.</span><span class="n">fileno</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">   <span class="n">epoll</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">   <span class="n">serversocket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></div><p>æœ€å…³é”®çš„å‡ è¡Œå¦‚ä¸‹ï¼š</p>
<ul>
<li>16ï¼šæ³¨å†Œæ„Ÿå…´è¶£çš„äº‹ä»¶</li>
<li>23ï¼šå¦‚æœå‘ç°æ˜¯ç›‘å¬ socketï¼Œåˆ™åˆ›å»ºè¿æ¥</li>
<li>30ï¼šè¯»äº‹ä»¶å¤„ç†</li>
<li>33ï¼šè¯»äº‹ä»¶å®Œæˆåï¼Œä¿®æ”¹ epoll å¯¹åº”çš„çŠ¶æ€åˆ°å†™äº‹ä»¶</li>
<li>35ï¼šå†™äº‹ä»¶</li>
<li>41ï¼šé‡Šæ”¾å¯¹åº”çš„è¿æ¥</li>
</ul>
<p>Epoll åˆ†è¾¹ç¼˜è§¦å‘ï¼ˆedge-triggeredï¼‰å’Œæ°´å¹³è§¦å‘ï¼ˆlevel-triggeredï¼‰ä¸¤ç§ï¼Œ
å‰è€…åªè¢«å†…æ ¸è§¦å‘ä¸€æ¬¡é€šçŸ¥ï¼ˆé™¤éçŠ¶æ€è¢«æ”¹å˜ä¸ºæœªå°±ç»ªï¼‰ï¼Œåè€…åœ¨è§¦å‘åå¦‚æœä¸åšæ“ä½œï¼Œ
ä»¥åä»ç„¶ä¼šæ”¶åˆ°å†…æ ¸çš„è§¦å‘é€šçŸ¥ã€‚</p>
<h2 id="æ›´å¤šä¼˜åŒ–">æ›´å¤šä¼˜åŒ–</h2>
<h3 id="è¿æ¥ç­‰å¾…æ± å¤§å°">è¿æ¥ç­‰å¾…æ± å¤§å°</h3>
<p>æˆ‘ä»¬ä¹‹å‰çš„ä»£ç ç›´æ¥ä½¿ç”¨ <code>listen()</code> å»ºç«‹è¿æ¥ï¼Œå¯ä»¥é€šè¿‡è®¾å®šä¸€ä¸ªé˜Ÿåˆ—å¤§å°ï¼Œ
åœ¨é˜Ÿåˆ—æ»¡äº†æ—¶å€™ï¼Œå°±ä¸å†æ¥å—æ–°çš„è¿æ¥ï¼Œä»è€Œä¿è¯å·²ç»æ¥å—çš„è¿æ¥é¡ºåˆ©å®Œæˆã€‚</p>
<h3 id="tcp-é€‰é¡¹">TCP é€‰é¡¹</h3>
<p>ä½¿ç”¨ <a href="http://www.baus.net/on-tcp_cork">TCP_CORK</a> åŠŸèƒ½ï¼Œå¯ä»¥å°†å°æ•°æ®åŒ…å°è£…æˆå¤§åŒ…ä¼ è¾“ï¼Œæé«˜æ•ˆç‡ã€‚</p>
<p><a href="http://www.techrepublic.com/article/tcpip-options-for-high-performance-data-transmission/1050878">TCP_NODELAY</a> åˆ™ä½œç”¨ç›¸åï¼Œå°†å¤§åŒ…åˆ†æˆå°åŒ…å‘é€å‡ºå»ã€‚æ¯”è¾ƒé€‚åˆå®æ—¶åº”ç”¨æ¯”å¦‚ SSHã€‚</p>
<p>ï¼ˆè¯‘è€…ï¼š<a href="http://www.uplook.cn/blog/8/81276/">Linuxä¸‹é«˜æ€§èƒ½ç½‘ç»œç¼–ç¨‹ä¸­çš„å‡ ä¸ªTCP/IPé€‰é¡¹</a>ä»‹ç»è¿™å‡ ä¸ª HTTPï¼Œå†™çš„ä¸é”™ã€‚</p>
<p>èŒƒä¾‹ä¸­çš„æºç åœ¨ <a href="http://scotdoyle.com/python-epoll-examples.tar.gz">source code</a> ä¸‹è½½ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>å¦‚ä½•è®© Instagram åœ¨ä¸€ç™¾å¤šä¸‡ç”¨æˆ·çˆ†ç‚¸åç¨³å®šè¿è¡Œ</title>
      <link>https://blog.alswl.com/2012/11/keeping-instagram-up-with-over-a-million-new-users-in-twelve-hours/</link>
      <pubDate>Mon, 19 Nov 2012 00:06:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2012/11/keeping-instagram-up-with-over-a-million-new-users-in-twelve-hours/</guid>
      <description>&lt;p&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&#34;http://instagram-engineering.tumblr.com/post/20541814340/keeping-instagram-up-with-over-a-million-new-users-in&#34;&gt;Keeping Instagram up with over a million new users in twelve hours&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;è¿™å‘¨äºŒæˆ‘ä»¬å‘å¸ƒäº† &lt;a href=&#34;https://play.google.com/store/apps/details?id=com.instagram.android&#34;&gt;Instagram for Android&lt;/a&gt;ï¼Œåå“ç©ºå‰å¼ºçƒˆã€‚
æœ€è¿‘è¿™å‡ å‘¨æˆ‘ä»¬ä¸€ç›´ï¼ˆåœ¨åŸºç¡€è®¾æ–½æ–¹é¢ï¼‰åšè´Ÿè½½è®¡åˆ’ï¼Œä¸ºæ‰€æœ‰å¯èƒ½å‘ç”Ÿçš„äº‹æ•…åšå‡†å¤‡ã€‚
å°½ç®¡å¦‚æ­¤ï¼Œåœ¨å‘å¸ƒé‚£å¤©ï¼Œæœ€å¤§çš„æŒ‘æˆ˜ä»ç„¶æ˜¯å¦‚ä½•å¿«é€Ÿå®šä½é—®é¢˜ï¼Œæ‰¾åˆ°ç“¶é¢ˆå¹¶å°½å¿«ä¿®å¤ä»–ä»¬ã€‚
åœ¨è¿™é‡Œæˆ‘ä»¬å°†åˆ†äº«ä¸€äº›å¸®åŠ©æˆ‘ä»¬è§£å†³é—®é¢˜çš„å·¥å…·å’ŒæŠ€æœ¯ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;##statsd##&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://github.com/etsy/statsd/&#34;&gt;statsd&lt;/a&gt; åœ¨ Instagram å¾ˆå—æ¬¢è¿ã€‚è¿™æ˜¯ &lt;a href=&#34;http://github.com/etsy/&#34;&gt;Etsy&lt;/a&gt; å†™çš„ä¸€ä¸ªç½‘ç»œç›‘æ§å™¨ï¼Œ
èƒ½å¤Ÿç»Ÿè®¡å¹¶å›¾å½¢åŒ–æ•°æ®ã€‚å®ƒæœ‰ä¸¤ç§æ ¸å¿ƒçš„ç»Ÿè®¡æ–¹å¼ï¼šè®¡æ•°å™¨å’Œè®¡æ—¶å™¨ã€‚
æˆ‘ä»¬ç”¨è®¡æ•°å™¨æ¥è·Ÿè¸ªè®¸å¤šä¿¡æ¯ï¼Œä»æ¯ç§’é’Ÿæ³¨å†Œæ•°åˆ°å–œæ¬¢æ•°é‡ç»Ÿè®¡ã€‚
åŒæ—¶æˆ‘ä»¬ä½¿ç”¨è®¡æ—¶å™¨æ¥è·Ÿè¸ª feeds å˜åŒ–ï¼Œç”¨æˆ·åœç•™åœ¨ feeds å¤šä¹…ï¼Œå’Œå…¶ä»–çš„ä¸»è¦æ“ä½œã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>åŸæ–‡é“¾æ¥ï¼š<a href="http://instagram-engineering.tumblr.com/post/20541814340/keeping-instagram-up-with-over-a-million-new-users-in">Keeping Instagram up with over a million new users in twelve hours</a></p>
<hr />
<p>è¿™å‘¨äºŒæˆ‘ä»¬å‘å¸ƒäº† <a href="https://play.google.com/store/apps/details?id=com.instagram.android">Instagram for Android</a>ï¼Œåå“ç©ºå‰å¼ºçƒˆã€‚
æœ€è¿‘è¿™å‡ å‘¨æˆ‘ä»¬ä¸€ç›´ï¼ˆåœ¨åŸºç¡€è®¾æ–½æ–¹é¢ï¼‰åšè´Ÿè½½è®¡åˆ’ï¼Œä¸ºæ‰€æœ‰å¯èƒ½å‘ç”Ÿçš„äº‹æ•…åšå‡†å¤‡ã€‚
å°½ç®¡å¦‚æ­¤ï¼Œåœ¨å‘å¸ƒé‚£å¤©ï¼Œæœ€å¤§çš„æŒ‘æˆ˜ä»ç„¶æ˜¯å¦‚ä½•å¿«é€Ÿå®šä½é—®é¢˜ï¼Œæ‰¾åˆ°ç“¶é¢ˆå¹¶å°½å¿«ä¿®å¤ä»–ä»¬ã€‚
åœ¨è¿™é‡Œæˆ‘ä»¬å°†åˆ†äº«ä¸€äº›å¸®åŠ©æˆ‘ä»¬è§£å†³é—®é¢˜çš„å·¥å…·å’ŒæŠ€æœ¯ã€‚</p>
<!-- more -->
<p>##statsd##</p>
<p><a href="http://github.com/etsy/statsd/">statsd</a> åœ¨ Instagram å¾ˆå—æ¬¢è¿ã€‚è¿™æ˜¯ <a href="http://github.com/etsy/">Etsy</a> å†™çš„ä¸€ä¸ªç½‘ç»œç›‘æ§å™¨ï¼Œ
èƒ½å¤Ÿç»Ÿè®¡å¹¶å›¾å½¢åŒ–æ•°æ®ã€‚å®ƒæœ‰ä¸¤ç§æ ¸å¿ƒçš„ç»Ÿè®¡æ–¹å¼ï¼šè®¡æ•°å™¨å’Œè®¡æ—¶å™¨ã€‚
æˆ‘ä»¬ç”¨è®¡æ•°å™¨æ¥è·Ÿè¸ªè®¸å¤šä¿¡æ¯ï¼Œä»æ¯ç§’é’Ÿæ³¨å†Œæ•°åˆ°å–œæ¬¢æ•°é‡ç»Ÿè®¡ã€‚
åŒæ—¶æˆ‘ä»¬ä½¿ç”¨è®¡æ—¶å™¨æ¥è·Ÿè¸ª feeds å˜åŒ–ï¼Œç”¨æˆ·åœç•™åœ¨ feeds å¤šä¹…ï¼Œå’Œå…¶ä»–çš„ä¸»è¦æ“ä½œã€‚</p>
<p>æˆ‘ä»¬å–œæ¬¢ statsd çš„æœ€å¤§åŸå› æ˜¯å®ƒèƒ½è¿…é€Ÿå°†çŠ¶æ€æ˜¾ç¤ºå¹¶å›¾å½¢åŒ–å‡ºæ¥ã€‚
Stats å‡ ä¹æ˜¯å®æ—¶çš„ï¼ˆåœ¨æˆ‘ä»¬ç³»ç»Ÿä¸­æœ‰ 10 ç§’é’Ÿçš„å»¶æ—¶ï¼‰
å¸®åŠ©æˆ‘ä»¬è¯„ä¼°ç³»ç»ŸçŠ¶å†µå’Œä»£ç å˜åŒ–æƒ…å†µã€‚
Stats å¯ä»¥éšæ„å¯ç”¨ï¼Œå½“æˆ‘ä»¬éœ€è¦è·Ÿè¸ªæ—¶ï¼Œèƒ½å¤Ÿå¿«é€Ÿå¯ç”¨å®ƒã€‚
ä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªå–æ ·å¯†åº¦ï¼Œæ¥å‡åŒ€çš„æŸ¥çœ‹ web åº”ç”¨æ¦‚å†µï¼Œ
è€Œä¸ä¼šå½±å“å®ƒè¿è¡Œæ•ˆç‡ã€‚</p>
<p>æ€»ç»“ï¼šå®æ—¶ç»Ÿè®¡å¯ä»¥åŠ¨æ€æ·»åŠ ï¼Œå¸®åŠ©ä½ çº¿ä¸Šè¯Šæ–­è€Œæ— é¡»ç­‰å¾…é—®é¢˜é‡ç°ã€‚</p>
<p>##Dogslow##</p>
<p><a href="http://blog.bitbucket.org/2011/05/17/tracking-slow-requests-with-dogslow/">Bitbucket</a> å‡ºå“ï¼ŒDogslow æ˜¯ä¸€ä¸ª Django middlewareï¼Œå®ƒèƒ½ç›‘è§†è¿è¡Œçš„è¿›ç¨‹ï¼Œ
å½“å‘ç°æœ‰è¿›ç¨‹è¿è¡Œæ—¶é—´è¶…è¿‡ <em>N</em> ç§’æ—¶ï¼Œä¼šä¿å­˜å½“å‰è¿›ç¨‹ä¿¡æ¯çš„å¿«ç…§åˆ°ç£ç›˜ã€‚
ä¸€ç›´å¼€ç€å®ƒå¾ˆè€—æ€§èƒ½ï¼Œä½†å½“å»å®šä½çªå‘é—®é¢˜çš„ç“¶é¢ˆæ—¶ï¼Œå°±ä¼šéå¸¸æœ‰ç”¨ï¼ˆæˆ‘ä»¬åœ¨ web
æœåŠ¡å™¨ä¸ŠåŠ äº†ä¸€ä¸ªå¼€å…³æ§åˆ¶ï¼‰ã€‚</p>
<p>åœ¨å‘å¸ƒé‚£å¤©ï¼Œæˆ‘ä»¬å‘ç°å¾ˆå¤šè¿è¡Œæ—¶é—´è¶…è¿‡ 1.5s çš„è¿›ç¨‹éƒ½å¡åœ¨ memcached çš„ set()
å’Œ get_many() æ–¹æ³•ä¸Šã€‚æˆ‘ä»¬ä½¿ç”¨ Munin è·Ÿè¸ªæˆ‘ä»¬çš„æœºå™¨çŠ¶æ€ï¼Œå‘ç° memcached
æ¯ç§’æœ‰ 5 ä¸‡æ¬¡è¯·æ±‚ï¼Œå› æ­¤ï¼Œå°½ç®¡è¿˜æ²¡åˆ°è¾¾ CPU ä¸Šé™ï¼Œå´è¢« memcached
æ‹–æ…¢äº†åº”ç”¨æœåŠ¡å™¨é€Ÿåº¦ã€‚</p>
<p>æ€»ç»“ï¼šç“¶é¢ˆå¾€å¾€æ˜¯åå°çš„ä¸€ä¸ªçŸ­æ¿é€ æˆçš„ï¼Œå®šä½åˆ°åº•å“ªé‡Œå¡ä¸‹æ¥èƒ½å¸®åŠ©æ‰¾å‡ºé—®é¢˜æ ¹æºã€‚</p>
<p>##Replication &amp; Read-slaves##</p>
<p>æˆ‘ä»¬ä¸»è¦çš„ä¸¤ä¸ªæ•°æ®æº <a href="http://redis.io">Redis</a> å’Œ <a href="http://postgresql.org/">PostgreSQL</a> éƒ½å¯ä»¥æ–¹ä¾¿åœ°ä¸»ä»åˆ†ç¦»ã€‚
å½“æˆ‘ä»¬çš„ Redis æ•°æ®åº“åˆ°è¾¾æ¯ç§’ 4 ä¸‡è¯·æ±‚æ—¶å€™ï¼Œå¼€å§‹æˆä¸ºç“¶é¢ˆã€‚æˆ‘ä»¬åœ¨å¦å¤–ä¸€å°æœåŠ¡å™¨
æ‰“å¼€ <a href="http://redis.io/topics/replication">SYNCing to the master</a>ï¼Œç„¶åå°†è¯»è¯·æ±‚å‘é€åˆ°è¿™å°æœåŠ¡å™¨ï¼Œ
è¿™äº›æ“ä½œä»…è€—æ—¶ 20 åˆ†é’Ÿã€‚æ ¹æ®å‡ ä¸ªæ¡ˆä¾‹ï¼Œæœ‰äº›æœºå™¨çš„è´Ÿè½½ä¼šåç¦»äº†æˆ‘ä»¬é¢„æœŸï¼Œ
æ‰€ä»¥æˆ‘ä»¬ä¼šæå‰å‡†å¤‡å¥½ä»æœåŠ¡å™¨ï¼Œä»è€Œå¿«é€Ÿåœ°åˆ†ç¦»å‡ºè¯»è¯·æ±‚ã€‚</p>
<p>æ¯”æ–¹è¯´ Postgresï¼Œæˆ‘ä»¬æ··åˆä½¿ç”¨ <a href="http://wiki.postgresql.org/wiki/Streaming_Replication">Streaming Replication</a> å’Œ Amazon EBS
å¿«ç…§æ¥å¿«é€Ÿå¯åŠ¨ä»æœåŠ¡å™¨ã€‚æ‰€æœ‰ä»ä¸» DB åˆ°ä»æœåŠ¡å™¨çš„æ•°æ®ä¸å®šæ—¶ä¼šæœ‰ EBS å¿«ç…§ã€‚
æ ¹æ®è¿™äº›å¿«ç…§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ 20 åˆ†é’Ÿå†…å¯åŠ¨æ–°çš„ä»æœåŠ¡å™¨å¹¶é€šçŸ¥ä¸»æœåŠ¡å™¨ã€‚
åœ¨ AWS è¿™æ ·çš„ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨è„šæœ¬å’Œå‘½ä»¤æ¥å¾ˆå¿«çš„é¢„åˆ¤å¹¶éƒ¨ç½²æ–°çš„ä»æœåŠ¡å™¨ã€‚</p>
<p>æ€»ç»“ï¼šå¦‚æœè¯»èƒ½åŠ›ä¼šå˜æˆç“¶é¢ˆï¼Œé‚£å°±é¢„å…ˆå‡†å¤‡å¥½ä»æœåŠ¡å™¨ï¼Œå¹¶è®©ä»–ä»¬è½®è¯¢æœåŠ¡ã€‚
ä¸€æ—¦å‡ºç°äº†æ–°çš„è¯»é—®é¢˜ï¼Œè¦åšçš„ä»…ä»…æ˜¯åŠ æ›´å¤šçš„è¯»æœåŠ¡å™¨åˆ°è½®è¯¢ä¸­å»ã€‚</p>
<h2 id="pgfouine">##PGFouine##</h2>
<p><a href="http://pgfouine.projects.postgresql.org/">PGFouine</a> æ˜¯ä¸€ä¸ªåˆ†æ PostgreSQL æŸ¥è¯¢æ—¥å¿—å¹¶ç”ŸæˆæŸ¥è¯¢ç»“æœçš„å·¥å…·ã€‚
å°†æœ€é‡ã€æœ€å¸¸ç”¨ã€æœ€æ…¢çš„æŸ¥è¯¢æ‹†åˆ†å‡ºæ¥ã€‚æˆ‘ä»¬å†™äº†ä¸€ä¸ª Fabric è„šæœ¬æ¥æ–¹ä¾¿çš„ä½¿ç”¨å®ƒï¼Œ
è¿æ¥åˆ°ä¸€ä¸ªæ•°æ®åº“ï¼Œç„¶åç­‰å¾… 30 ç§’å¹¶è®°å½•ä¸‹å…¶ä¸­æ¯æ¡æŸ¥è¯¢ï¼ŒæŠŠç»“æœä¿å­˜åˆ°æœ¬åœ°å†ç”¨
pgfouine æ¥åˆ†æï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ° <a href="https://gist.github.com/2307647">as a gist</a>ã€‚PGFouine
æ˜¯æˆ‘ä»¬ç”¨æ¥åˆ†ææ•°æ®åº“æ€§èƒ½çš„æ ¸å¿ƒå·¥å…·ã€‚å¸®æˆ‘ä»¬æ‰¾å‡ºå“ªäº›æŸ¥è¯¢åº”è¯¥è¢« memcached ç¼“å­˜ï¼Œ
å“ªäº›æŸ¥è¯¢äº†è¿‡åº¦çš„æ•°æ®ç­‰ç­‰ã€‚å‘å¸ƒé‚£å¤©æ•°æ®åº“å‡ºç°äº†ä¸€ç‚¹å‹åŠ›ï¼Œæˆ‘ä»¬å°±è·‘ PGFouineï¼Œ
ç„¶åéƒ¨ç½²ä¸€äº›æå‡æ€§èƒ½çš„ä»£ç æ¥ç¼“è§£å‹åŠ›ï¼Œç„¶åå†è·‘ä¸€æ¬¡ PGFouine æ¥ç¡®è®¤æ•ˆæœã€‚</p>
<p>çŸ¥é“å¹³æ—¥é‡Œæ•°æ®åº“è¡¨ç°æ€§èƒ½å¾ˆé‡è¦ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿå®šæœŸåœ¨æ— å‹åŠ›çš„æœåŠ¡å™¨ä¸Šç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<p>æ€»ç»“ï¼šæ•°æ®åº“æ—¥å¿—åˆ†æï¼ˆå°¤å…¶æ³¨æ„è¿­ä»£å¾ªç¯æŸ¥è¯¢å’Œç¼“å­˜ç»å¸¸ä½¿ç”¨çš„æ•°æ®ï¼‰</p>
<h2 id="one-more-thing">One more thing</h2>
<p>å¦ä¸€ä¸ªå¸®åŠ©æˆ‘ä»¬é¡ºåˆ©é€šè¿‡å‘å¸ƒç¬¬ä¸€å¤©çš„å·¥å…·æ˜¯æˆ‘ä»¬è‡ªå·±å†™çš„ä¸€ä¸ª node.js æœåŠ¡ï¼Œnode2dmï¼Œ
ç”¨æ¥æ¨é€é€šçŸ¥æ¶ˆæ¯åˆ° Android C2DM æœåŠ¡ã€‚å®ƒè‡³ä»Šå·²ç»å‘é€äº† 500 ä¸‡æ¡æ¨é€ã€‚</p>
<p>æˆ‘ä»¬è°ƒæŸ¥äº†ä¸€äº›æ”¯æŒ C2DM çš„å¯ç”¨æœåŠ¡ï¼Œä½†è¦ä¹ˆæ˜¯å¼€æºåŒ…ä¸é‚£ä¹ˆè¢«ç§¯æç»´æŠ¤ï¼Œ
è¦ä¹ˆæ˜¯ä¸æ”¯æŒ Google æ‰€æœ‰çš„åŠŸèƒ½ã€‚æˆ‘ä»¬ç°åœ¨ç”¨ <a href="http://github.com/Instagram/node2dm">open sourcing node2dm</a>ï¼Œ
ä½ å¯ä»¥éšæ„ forlk / pull-request æ¥å¸®åŠ©æˆ‘ä»¬æ”¹è¿›ã€‚</p>
<h2 id="interested">Interested?</h2>
<p>å¦‚æœä½ å¯¹è¿™äº›å¾ˆæ„Ÿå…´è¶£ï¼Œä½ å¯ä»¥è·Ÿæˆ‘ä»¬è”ç³»æ¥è·å¾—å·¥ä½œæœºä¼šï¼Œ<a href="http://instagram.jobscore.com/jobs/instagram/engineer/bXctey0Oir4kCZeJe4bk1X">drop us a note</a>ï¼Œ
æˆ‘ä»¬éœ€è¦çŸ¥é“ä½ çš„æƒ³æ³•ã€‚</p>
<p>ä½ å¯ä»¥åœ¨ Hacker News æ¥ <a href="http://news.ycombinator.com/item?id=3804351">discuss this post</a>ã€‚</p>
<p>â€”</p>
<p><em>Mike Krieger, co-founder</em></p>
]]></content:encoded>
    </item>
    <item>
      <title>KuKu-ä¸€ä¸ª Weekend Project</title>
      <link>https://blog.alswl.com/2012/11/kuku/</link>
      <pubDate>Sun, 18 Nov 2012 22:31:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2012/11/kuku/</guid>
      <description>&lt;p&gt;ä¸€ä¸ªå°å°çš„ Weekend Projectï¼ŒåŸºäº &lt;a href=&#34;http://webpy.org/&#34;&gt;web.py&lt;/a&gt;ã€‚
ä»£ç åœ¨ &lt;a href=&#34;https://github.com/alswl/kuku&#34;&gt;alswl / kuku&lt;/a&gt; ï¼Œå¾ˆç®€é™‹ï¼Œå±äºå·®ä¸å¤šèƒ½ç”¨é˜¶æ®µã€‚&lt;/p&gt;
&lt;p&gt;




&lt;img loading=&#34;lazy&#34; src=&#34;https://blog.alswl.com/images/upload_dropbox/201211/kuku.png&#34; alt=&#34;Kuku&#34;  /&gt;


&lt;/p&gt;
&lt;p&gt;åŸºäºä»¥ä¸‹åŸå› å¼€å‘ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æƒ³æŠŠæœåŠ¡å™¨å» PHP åŒ–ï¼Œä»¥å‰çš„ &lt;a href=&#34;https://upload.log4d.com/&#34;&gt;upload.log4d.com&lt;/a&gt; æ˜¯åŸºäº PHP çš„ï¼Œ
è¯¦æƒ…è¯·è§ &lt;a href=&#34;http://log4d.com/2012/05/image-host/&#34;&gt;ä½¿ç”¨ç‹¬ç«‹å›¾åºŠå­åŸŸå&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åˆšä¹°çš„ &lt;a href=&#34;http://www.linode.com/?r=7e51a136a0eca06c5f6474373f616bbdaa2b5b6c&#34;&gt;Linode VPS&lt;/a&gt;ï¼Œç»ˆäºä» 128MB å†…å­˜è§£æ”¾å‡ºæ¥äº†ï¼Œèµ¶ç´§æ”¾ä¸ª Python ç¨‹åºè·‘è·‘ã€‚&lt;/li&gt;
&lt;li&gt;æƒ³äº› Python äº†ï¼Œæ‰‹ç—’ï¼Œæƒ³çœ‹çœ‹å†™è¿™ä¹ˆç®€å•çš„åŠŸèƒ½éœ€è¦å¤šé•¿æ—¶é—´ï¼Œ
å¼¥è¡¥ä¸Šæ¬¡æ²¡èƒ½å‚åŠ é»‘å®¢é©¬æ‹‰æ¾çš„é—æ†¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;KuKu çš„å‘éŸ³æ˜¯æˆ‘å®¶ä¹¡è¯çš„ã€Œçœ‹çœ‹ã€ã€‚&lt;/p&gt;
&lt;p&gt;KuKu ä¸­æ¯”è¾ƒæœ‰è¶£çš„åœ°æ–¹æ˜¯ï¼Œç”¨äº† &lt;a href=&#34;http://foundation.zurb.com/&#34;&gt;Foundation&lt;/a&gt; è¿™ä¸ªæµå¼ Web å‰ç«¯æ¡†æ¶ï¼Œ
ç”¨äº† &lt;a href=&#34;http://www.zurb.com/playground/foundation-icons&#34;&gt;Foundation Icons Fonts&lt;/a&gt;ï¼Œå°† js åº“å…¨éƒ¨æ‰˜ç®¡åœ¨ &lt;a href=&#34;https://developers.google.com/speed/libraries/&#34;&gt;Google Hosted Libaries&lt;/a&gt;
å’Œ &lt;a href=&#34;http://cdnjs.com&#34;&gt;cdnjs&lt;/a&gt; ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« æˆ‘çœ‹ç€éƒ½è§‰å¾—æ°´ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>ä¸€ä¸ªå°å°çš„ Weekend Projectï¼ŒåŸºäº <a href="http://webpy.org/">web.py</a>ã€‚
ä»£ç åœ¨ <a href="https://github.com/alswl/kuku">alswl / kuku</a> ï¼Œå¾ˆç®€é™‹ï¼Œå±äºå·®ä¸å¤šèƒ½ç”¨é˜¶æ®µã€‚</p>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201211/kuku.png" alt="Kuku"  />


</p>
<p>åŸºäºä»¥ä¸‹åŸå› å¼€å‘ï¼š</p>
<ul>
<li>æƒ³æŠŠæœåŠ¡å™¨å» PHP åŒ–ï¼Œä»¥å‰çš„ <a href="https://upload.log4d.com/">upload.log4d.com</a> æ˜¯åŸºäº PHP çš„ï¼Œ
è¯¦æƒ…è¯·è§ <a href="http://log4d.com/2012/05/image-host/">ä½¿ç”¨ç‹¬ç«‹å›¾åºŠå­åŸŸå</a>ã€‚</li>
<li>åˆšä¹°çš„ <a href="http://www.linode.com/?r=7e51a136a0eca06c5f6474373f616bbdaa2b5b6c">Linode VPS</a>ï¼Œç»ˆäºä» 128MB å†…å­˜è§£æ”¾å‡ºæ¥äº†ï¼Œèµ¶ç´§æ”¾ä¸ª Python ç¨‹åºè·‘è·‘ã€‚</li>
<li>æƒ³äº› Python äº†ï¼Œæ‰‹ç—’ï¼Œæƒ³çœ‹çœ‹å†™è¿™ä¹ˆç®€å•çš„åŠŸèƒ½éœ€è¦å¤šé•¿æ—¶é—´ï¼Œ
å¼¥è¡¥ä¸Šæ¬¡æ²¡èƒ½å‚åŠ é»‘å®¢é©¬æ‹‰æ¾çš„é—æ†¾ã€‚</li>
</ul>
<p>KuKu çš„å‘éŸ³æ˜¯æˆ‘å®¶ä¹¡è¯çš„ã€Œçœ‹çœ‹ã€ã€‚</p>
<p>KuKu ä¸­æ¯”è¾ƒæœ‰è¶£çš„åœ°æ–¹æ˜¯ï¼Œç”¨äº† <a href="http://foundation.zurb.com/">Foundation</a> è¿™ä¸ªæµå¼ Web å‰ç«¯æ¡†æ¶ï¼Œ
ç”¨äº† <a href="http://www.zurb.com/playground/foundation-icons">Foundation Icons Fonts</a>ï¼Œå°† js åº“å…¨éƒ¨æ‰˜ç®¡åœ¨ <a href="https://developers.google.com/speed/libraries/">Google Hosted Libaries</a>
å’Œ <a href="http://cdnjs.com">cdnjs</a> ä¸Šã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æˆ‘çœ‹ç€éƒ½è§‰å¾—æ°´ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>PyCon 2012 è§é—»</title>
      <link>https://blog.alswl.com/2012/10/pycon-2012/</link>
      <pubDate>Sun, 21 Oct 2012 21:15:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2012/10/pycon-2012/</guid>
      <description>&lt;p&gt;PyCon æ˜¯ Python é¢†åŸŸæœ€è‘—åçš„æŠ€æœ¯ä¼šè®®ï¼Œä» 2011 å¹´å¼€å§‹ï¼Œä¸­å›½åŒºå¼€å§‹ä¸¾åŠè‡ªå·±çš„
PyCon å¤§ä¼šã€‚è¿™æ¬¡ PyCon 2012 åˆ†æˆä¸¤ä¸ªåœºåœ°åŒæ—¶è¿›è¡Œï¼ŒåŒ—äº¬å’Œä¸Šæµ·ï¼Œ
å¹¶ä¸”åœ¨ç½‘ä¸Šæä¾›åŒæ­¥è½¬æ’­ï¼Œå„åœ°ä¹Ÿæœ‰ç»„ç»‡çº¿ä¸‹æ”¶çœ‹çš„ã€‚&lt;/p&gt;
&lt;p&gt;


&lt;img loading=&#34;lazy&#34; src=&#34;https://blog.alswl.com/images/upload_dropbox/201210/PyConChina2012.png&#34; alt=&#34;PyCon Logo&#34;  /&gt;



&lt;/p&gt;
&lt;p&gt;å»å¹´æ—¶å€™æˆ‘å¾ˆé—æ†¾çš„ä¸èƒ½è·‘åˆ°ä¸Šæµ·æ¥å‚åŠ ï¼Œç°åœ¨æˆ‘äººå°±åœ¨ä¸Šæµ·ï¼Œ
æ€èƒ½é”™è¿‡ Pythoner çš„é¥•é¤®å¤§é¤å‘¢ï¼Ÿæ—©å°±çœ¼å·´å·´çš„ä¹°ç¥¨å‡†å¤‡å‚åŠ äº†ã€‚&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;ä¸Šæµ·è¿™è¾¹çš„ä¸»é¢˜å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ã€ŠPython äº§å“æ„å»ºä¸å‘å¸ƒæŒ‡å—ã€‹- æ²ˆå´´&lt;/li&gt;
&lt;li&gt;ã€Šå®æˆ˜æ¸¸æˆå®¢æˆ·ç«¯ã€‹ - æ—ä¼Ÿ&lt;/li&gt;
&lt;li&gt;ã€Šè®©ç¨‹åºè¿è¡Œæ›´å¿«ã€‹- æå°çº¢&lt;/li&gt;
&lt;li&gt;ã€Šæ¼”è¿›æˆ–é©å‘½ - é€‰å‹å’Œæ¶æ„çš„å®è·µç»éªŒè°ˆã€‹ - æ½˜ä¿Šå‹‡&lt;/li&gt;
&lt;li&gt;ã€Šç½‘æ¸¸å¼€å‘ä¸­çš„ Python ç»„ä»¶ã€‹- èµ–å‹‡æµ©&lt;/li&gt;
&lt;li&gt;ã€Šè‡ªåŠ¨åŒ–å³æ—¶æˆ˜æ–—æ¸¸æˆè§£å†³æ–¹æ¡ˆã€‹ - ç‹å¥&lt;/li&gt;
&lt;li&gt;ã€Šäººäººå¯ä»¥åŒ–åŠå°æ—¶å¼€å‘ä¸€ä¸ªå…¨åŠŸèƒ½OpenERPæ¨¡å—ã€‹ - Tony Gu&lt;/li&gt;
&lt;li&gt;ã€Šå…ƒç¼–ç¨‹åœ¨redis ormä¸­çš„åº”ç”¨ã€‹ - è®¸æ™ºç¿”&lt;/li&gt;
&lt;li&gt;ã€ŠOpenERPå³å°†æ¨å‡ºçš„ç¬¬7ç‰ˆçš„åŠŸèƒ½å’Œæ–°çš„ç¼–ç¨‹æ¡†æ¶ä»‹ç»ã€‹- Eric Caudal&lt;/li&gt;
&lt;li&gt;ã€ŠPythonå¦‚ä½•å¸®åŠ©ã€Œé€†è½¬ä¸‰å›½ã€è·å¾—æˆåŠŸã€‹- è½¦è•™æ€¡&lt;/li&gt;
&lt;li&gt;ã€ŠPyramid Web Framework for Advanced Web Applicationsã€‹- é»„å³¥å³¼ ï¼ˆMark Huangï¼‰&lt;/li&gt;
&lt;li&gt;ã€Šç”¨Tornadoå¼€å‘RESTful APIåº”ç”¨ã€‹- é£é¾™éé¾™&lt;/li&gt;
&lt;li&gt;ã€ŠNOSQLå’ŒMySQLåœ¨djangoä¸Šçš„æ··åˆä½¿ç”¨ã€‹- é»„æ˜¶&lt;/li&gt;
&lt;li&gt;ã€Šç½‘é¡µæ¸¸æˆçš„è·¨ç•Œå¼€å‘ã€‹ - è‘£è¯£&lt;/li&gt;
&lt;li&gt;ã€Šé˜¿é‡Œäº‘ä¹‹ç§»åŠ¨å¼€å‘è€…ä¸Šäº‘ã€‹ - åˆ˜é£&lt;/li&gt;
&lt;li&gt;ã€Šä½¿ç”¨ Python å’Œ Django å»ºè®¾ç»´æŠ¤å­¦æ ¡é—¨æˆ·ã€‹- äºå¤æ¡¥&lt;/li&gt;
&lt;li&gt;ã€Špythonåœ¨linuxè¿ç»´ä¸­çš„åº”ç”¨ã€‹ - å´æ™—&lt;/li&gt;
&lt;li&gt;ã€Šç”¨Pythonæ›¿æ¢Cä»£ç â€”â€”A Python Successful Storyã€‹- Adieuï¼ˆåˆç«‹çŸ¥ï¼‰&lt;/li&gt;
&lt;li&gt;ã€Š Python in Gentoo Linuxã€‹- Patrick Lauer&lt;/li&gt;
&lt;li&gt;ã€ŠåŸºäºnovaçš„è‡ªåŠ¨æ‰©å±•å’Œè´Ÿè½½å‡è¡¡ã€‹- åˆ˜æ˜å&lt;/li&gt;
&lt;li&gt;ã€Šç”¨myTestCaseæ¨¡å—æ¥åšpythonçš„UTã€‹- é™ˆé’¢&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘æœ€å–œæ¬¢çš„æ˜¯ &lt;a href=&#34;http://shell909090.com/blog/&#34;&gt;è®¸æ™ºç¿”ï¼ˆshellï¼‰&lt;/a&gt; / æ²ˆå´´ / æ—ä¼Ÿ / é»„å³¥å³¼ / æå°çº¢ / èµ–å‹‡æµ©
çš„ Topicã€‚å…¶ä¸­å°¤å…¶æ˜¯æ²ˆå´´å…³äºè¾“å…¥å¤„ç†çš„å‡†åˆ™ï¼Œè§£å¼€æˆ‘ä¸€ä¸ªå¾ˆä¹…çš„ç–‘æƒ‘ã€‚
æ²ˆå´´è¿™ä¸ª &lt;a href=&#34;http://www.slideshare.net/wilhelmshen/py-art&#34;&gt;Python ç¼–ç¨‹è‰ºæœ¯&lt;/a&gt; æ˜¯èµ–å‹‡æµ©æåˆ°çš„å¹»ç¯ç‰‡ï¼Œå¼ºçƒˆæ¨èè§‚çœ‹ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>PyCon æ˜¯ Python é¢†åŸŸæœ€è‘—åçš„æŠ€æœ¯ä¼šè®®ï¼Œä» 2011 å¹´å¼€å§‹ï¼Œä¸­å›½åŒºå¼€å§‹ä¸¾åŠè‡ªå·±çš„
PyCon å¤§ä¼šã€‚è¿™æ¬¡ PyCon 2012 åˆ†æˆä¸¤ä¸ªåœºåœ°åŒæ—¶è¿›è¡Œï¼ŒåŒ—äº¬å’Œä¸Šæµ·ï¼Œ
å¹¶ä¸”åœ¨ç½‘ä¸Šæä¾›åŒæ­¥è½¬æ’­ï¼Œå„åœ°ä¹Ÿæœ‰ç»„ç»‡çº¿ä¸‹æ”¶çœ‹çš„ã€‚</p>
<p>


<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201210/PyConChina2012.png" alt="PyCon Logo"  />



</p>
<p>å»å¹´æ—¶å€™æˆ‘å¾ˆé—æ†¾çš„ä¸èƒ½è·‘åˆ°ä¸Šæµ·æ¥å‚åŠ ï¼Œç°åœ¨æˆ‘äººå°±åœ¨ä¸Šæµ·ï¼Œ
æ€èƒ½é”™è¿‡ Pythoner çš„é¥•é¤®å¤§é¤å‘¢ï¼Ÿæ—©å°±çœ¼å·´å·´çš„ä¹°ç¥¨å‡†å¤‡å‚åŠ äº†ã€‚</p>
<!-- more -->
<p>ä¸Šæµ·è¿™è¾¹çš„ä¸»é¢˜å¦‚ä¸‹ï¼š</p>
<ul>
<li>ã€ŠPython äº§å“æ„å»ºä¸å‘å¸ƒæŒ‡å—ã€‹- æ²ˆå´´</li>
<li>ã€Šå®æˆ˜æ¸¸æˆå®¢æˆ·ç«¯ã€‹ - æ—ä¼Ÿ</li>
<li>ã€Šè®©ç¨‹åºè¿è¡Œæ›´å¿«ã€‹- æå°çº¢</li>
<li>ã€Šæ¼”è¿›æˆ–é©å‘½ - é€‰å‹å’Œæ¶æ„çš„å®è·µç»éªŒè°ˆã€‹ - æ½˜ä¿Šå‹‡</li>
<li>ã€Šç½‘æ¸¸å¼€å‘ä¸­çš„ Python ç»„ä»¶ã€‹- èµ–å‹‡æµ©</li>
<li>ã€Šè‡ªåŠ¨åŒ–å³æ—¶æˆ˜æ–—æ¸¸æˆè§£å†³æ–¹æ¡ˆã€‹ - ç‹å¥</li>
<li>ã€Šäººäººå¯ä»¥åŒ–åŠå°æ—¶å¼€å‘ä¸€ä¸ªå…¨åŠŸèƒ½OpenERPæ¨¡å—ã€‹ - Tony Gu</li>
<li>ã€Šå…ƒç¼–ç¨‹åœ¨redis ormä¸­çš„åº”ç”¨ã€‹ - è®¸æ™ºç¿”</li>
<li>ã€ŠOpenERPå³å°†æ¨å‡ºçš„ç¬¬7ç‰ˆçš„åŠŸèƒ½å’Œæ–°çš„ç¼–ç¨‹æ¡†æ¶ä»‹ç»ã€‹- Eric Caudal</li>
<li>ã€ŠPythonå¦‚ä½•å¸®åŠ©ã€Œé€†è½¬ä¸‰å›½ã€è·å¾—æˆåŠŸã€‹- è½¦è•™æ€¡</li>
<li>ã€ŠPyramid Web Framework for Advanced Web Applicationsã€‹- é»„å³¥å³¼ ï¼ˆMark Huangï¼‰</li>
<li>ã€Šç”¨Tornadoå¼€å‘RESTful APIåº”ç”¨ã€‹- é£é¾™éé¾™</li>
<li>ã€ŠNOSQLå’ŒMySQLåœ¨djangoä¸Šçš„æ··åˆä½¿ç”¨ã€‹- é»„æ˜¶</li>
<li>ã€Šç½‘é¡µæ¸¸æˆçš„è·¨ç•Œå¼€å‘ã€‹ - è‘£è¯£</li>
<li>ã€Šé˜¿é‡Œäº‘ä¹‹ç§»åŠ¨å¼€å‘è€…ä¸Šäº‘ã€‹ - åˆ˜é£</li>
<li>ã€Šä½¿ç”¨ Python å’Œ Django å»ºè®¾ç»´æŠ¤å­¦æ ¡é—¨æˆ·ã€‹- äºå¤æ¡¥</li>
<li>ã€Špythonåœ¨linuxè¿ç»´ä¸­çš„åº”ç”¨ã€‹ - å´æ™—</li>
<li>ã€Šç”¨Pythonæ›¿æ¢Cä»£ç â€”â€”A Python Successful Storyã€‹- Adieuï¼ˆåˆç«‹çŸ¥ï¼‰</li>
<li>ã€Š Python in Gentoo Linuxã€‹- Patrick Lauer</li>
<li>ã€ŠåŸºäºnovaçš„è‡ªåŠ¨æ‰©å±•å’Œè´Ÿè½½å‡è¡¡ã€‹- åˆ˜æ˜å</li>
<li>ã€Šç”¨myTestCaseæ¨¡å—æ¥åšpythonçš„UTã€‹- é™ˆé’¢</li>
</ul>
<p>æˆ‘æœ€å–œæ¬¢çš„æ˜¯ <a href="http://shell909090.com/blog/">è®¸æ™ºç¿”ï¼ˆshellï¼‰</a> / æ²ˆå´´ / æ—ä¼Ÿ / é»„å³¥å³¼ / æå°çº¢ / èµ–å‹‡æµ©
çš„ Topicã€‚å…¶ä¸­å°¤å…¶æ˜¯æ²ˆå´´å…³äºè¾“å…¥å¤„ç†çš„å‡†åˆ™ï¼Œè§£å¼€æˆ‘ä¸€ä¸ªå¾ˆä¹…çš„ç–‘æƒ‘ã€‚
æ²ˆå´´è¿™ä¸ª <a href="http://www.slideshare.net/wilhelmshen/py-art">Python ç¼–ç¨‹è‰ºæœ¯</a> æ˜¯èµ–å‹‡æµ©æåˆ°çš„å¹»ç¯ç‰‡ï¼Œå¼ºçƒˆæ¨èè§‚çœ‹ã€‚</p>
<p>shell çš„åšå®¢æˆ‘ä¸€ç›´åœ¨å…³æ³¨ï¼Œä¹Ÿåˆ—å…¥äº†æˆ‘çš„ GR ã€Œtag-å¿…è¯»ã€ä¸­ï¼Œ
è¿™æ¬¡å¬äº†ä»–å…³äºã€Œå…ƒç¼–ç¨‹ã€çš„é»‘é­”æ³•ï¼Œæˆ‘ä¹Ÿå¾ˆæœ‰æ”¶è·ï¼Œè€Œä¸”ä»–æ˜¯ä¸ªå¾ˆæœ‰è¶£çš„äººï¼Œ
æŠŠ Topic è®²çš„å¾ˆç”ŸåŠ¨ã€‚</p>
<p>æˆ‘ç”¨ Pylons ä¸€å¹´å¤šï¼Œæ‰€ä»¥å¯¹ Pyramid æœ‰ä¸€ç§å¤©ç„¶å¥½æ„Ÿï¼Œå¯æƒœä¸€ç›´å¯æœºä¼šå»å­¦ä¹ ï¼Œ
é»„å³¥å³¼çš„ Topic è®²äº†å¾ˆå¤šå…³äº Pyramid çš„ä¸œè¥¿ï¼Œä¹Ÿå¾ˆå€¼å¾—ä¸€çœ‹ï¼Œ
æ½˜ä¿Šå‹‡å¯¹ Pyramid çš„æ¥æºè¡¥å……ä¹Ÿéå¸¸è¯¦ç»†ï¼Œæœç„¶æ˜¯é«˜æ‰‹å•Šã€‚</p>
<p>æœ¬æ¥è¿˜æƒ³å¬ç‹æ·è®²ä¸€è®² <a href="http://www.shanbay.com/">æ‰‡è´ç½‘</a> çš„ Djangoï¼Œå¯æƒœä»–å±…ç„¶å»åŒ—äº¬åš Topicï¼Œ
æˆ‘å‹’ä¸ªå»ï¼Œè¦çŸ¥é“æ‰‡è´ç½‘å¯æ˜¯åœ¨å—äº¬ã€‚ç‹æ·ä¹Ÿæ˜¯ NJLUG æˆå‘˜ï¼Œ
ä¸‹æœˆä»–ä»¬è¿˜å°†æä¾› NJLUG ä¼šåœºï¼Œä¸€ç›´æ²¡æœ‰æœºä¼šè§åˆ°ï¼Œè›®å¯æƒœçš„ã€‚
è€Œä¸”ä»–ä»¬ä¹Ÿæ˜¯ç”¨çš„ Djangoï¼Œç°åœ¨é‡åˆ°ä¸€äº›æ€§èƒ½ç“¶é¢ˆï¼Œ
è®²åº§å†…å®¹åº”è¯¥æœ‰å¾ˆå¤šå€¼å¾—å­¦ä¹ ï¼Œåªèƒ½ä¸€ä¼šå»çœ‹è§†é¢‘äº†ã€‚</p>
<p>æ¯”è¾ƒå¹¿å‘Šçš„å°±æ˜¯ã€Œé€†è½¬ä¸‰å›½ã€å’Œã€Œé˜¿é‡Œäº‘ã€çš„ Topic å•¦ï¼ŒèµåŠ©å•†å˜›ï¼Œå¤§å®¶æ‡‚çš„ã€‚</p>
<p>ä¸Šä¸€äº›æ‹çš„ç…§ç‰‡ï¼š</p>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201210/2012-10-20-09.16.05.jpg" alt="ä¸»æŒäººå¼€åœº"  />


</p>
<p>ä¸»æŒäººå¼€åœºï¼Œè¿™ä½ä¸»æŒåº”è¯¥æ˜¯ Intridea çš„ Ruby ç¨‹åºå‘˜ï¼Œå“ˆå“ˆã€‚</p>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201210/2012-10-20-14.06.18.jpg" alt="shell åœ¨è®²é»‘é­”æ³•"  />


</p>
<p>shell åœ¨è®²é»‘é­”æ³•</p>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201210/2012-10-20-16.54.39.jpg" alt="Day 1 çš„åœ†æ¡Œ"  />


</p>
<p>Day 1 çš„åœ†æ¡Œ</p>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201210/2012-10-21-09.58.48.jpg" alt="èµ–å‹‡æµ©å’Œæ²ˆè‘³"  />


</p>
<p>èµ–å‹‡æµ©å’Œæ²ˆè‘³</p>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201210/2012-10-21-17.48.42.jpg" alt="Day 2 çš„åœ†æ¡Œ"  />


</p>
<p>Day 2 çš„åœ†æ¡Œ</p>
<p>è™½ç„¶ Python CN é‚®ä»¶åˆ—è¡¨ä¸­æœ‰äººååº”ä»Šå¹´ä¸å¦‚å»å¹´è´¨é‡é«˜ï¼Œæˆ‘æ²¡æœ‰çœ‹è¿‡å»å¹´çš„ PyConï¼Œ
ä½†æ˜¯è§‰å¾—ä»Šå¹´çš„è¿˜æ˜¯å¾ˆä¸é”™ï¼Œå­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼Œä¹Ÿè§åˆ°äº†å¾ˆå¤šç‰›äººçœŸèº«ã€‚
ä¸€ä¼šå‡†å¤‡æŠŠå»å¹´çš„ <a href="2011">PyCon 2011</a> ä¹Ÿå­¦ä¹ ä¸€ä¸‹ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>Working with Python subprocess[è¯‘æ–‡]</title>
      <link>https://blog.alswl.com/2012/10/working-with-python-subprocess/</link>
      <pubDate>Tue, 16 Oct 2012 00:42:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2012/10/working-with-python-subprocess/</guid>
      <description>&lt;p&gt;8æœˆåº•åˆ°é­”éƒ½å¼€å§‹æ–°å·¥ä½œï¼Œå¤´ä¸€ä¸ªæœˆå½“ç„¶å„ç§å¿™ï¼Œéƒ½æ²¡æ—¶é—´æ¥æ›´æ–°åšå®¢ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« æ˜¯åœ¨å†™ &lt;a href=&#34;http://kenai.com/projects/btrace/pages/Home&#34;&gt;Btrace&lt;/a&gt; è„šæœ¬æ—¶å€™æŸ¥èµ„æ–™çœ‹åˆ°çš„ï¼Œ
çœ‹ç€ä¸é”™å°±é¡ºæ‰‹ç¿»è¯‘ï¼Œæ²¡æƒ³åˆ°å·®ç‚¹çƒ‚åœ¨è‰ç¨¿ç®±å‡ºä¸æ¥å•Šå‡ºä¸æ¥ã€‚
ç†¬äº†ä¸€ä¸ªæœˆæ‰ç£¨å‡ºæ¥ï¼Œåª³å¦‡éƒ½å¿«æˆå©†äº†æœ‰æœ¨æœ‰ã€‚&lt;/p&gt;
&lt;p&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&#34;http://jimmyg.org/blog/2009/working-with-python-subprocess.html&#34;&gt;Working with Python subprocess - Shells, Processes, Streams, Pipes, Redirects and More&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;æ³¨æ„&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å…³äºã€Œæ‰§è¡Œå‘½ä»¤æ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆã€è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥åœ¨
&lt;a href=&#34;http://en.wikipedia.org/wiki/Redirection_(computing)&#34;&gt;http://en.wikipedia.org/wiki/Redirection_(computing)&lt;/a&gt;
æ‰¾åˆ°æ›´å¤šæœ€æ–°ä¿¡æ¯ã€‚è¿™ç¯‡æ–‡ç« éµå¾ª &lt;a href=&#34;http://www.gnu.org/copyleft/fdl.html&#34;&gt;GFDL&lt;/a&gt; åè®®ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;åœ¨æˆ‘çš„ä¸Šä¸€ç¯‡æ—¥å¿—ä¸­ï¼Œæˆ‘å†™åˆ°å¦‚ä½•
&lt;a href=&#34;http://jimmyg.org/blog/2009/python-command-line-interface-%28cli%29-with-sub-commands.html&#34;&gt;build a command line interface with sub-commands in Python&lt;/a&gt;ã€‚
è¿™æ¬¡æˆ‘æ¥å°è¯•å¦‚ä½•é€šè¿‡ Python çš„ &lt;code&gt;subprocess&lt;/code&gt; æ¨¡å—æ¥å’Œå‘½ä»¤è¡ŒæŒ‡ä»¤è¿›è¡Œäº¤äº’ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>8æœˆåº•åˆ°é­”éƒ½å¼€å§‹æ–°å·¥ä½œï¼Œå¤´ä¸€ä¸ªæœˆå½“ç„¶å„ç§å¿™ï¼Œéƒ½æ²¡æ—¶é—´æ¥æ›´æ–°åšå®¢ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æ˜¯åœ¨å†™ <a href="http://kenai.com/projects/btrace/pages/Home">Btrace</a> è„šæœ¬æ—¶å€™æŸ¥èµ„æ–™çœ‹åˆ°çš„ï¼Œ
çœ‹ç€ä¸é”™å°±é¡ºæ‰‹ç¿»è¯‘ï¼Œæ²¡æƒ³åˆ°å·®ç‚¹çƒ‚åœ¨è‰ç¨¿ç®±å‡ºä¸æ¥å•Šå‡ºä¸æ¥ã€‚
ç†¬äº†ä¸€ä¸ªæœˆæ‰ç£¨å‡ºæ¥ï¼Œåª³å¦‡éƒ½å¿«æˆå©†äº†æœ‰æœ¨æœ‰ã€‚</p>
<p>åŸæ–‡é“¾æ¥ï¼š<a href="http://jimmyg.org/blog/2009/working-with-python-subprocess.html">Working with Python subprocess - Shells, Processes, Streams, Pipes, Redirects and More</a></p>
<hr />
<p>æ³¨æ„</p>
<blockquote>
<p>å…³äºã€Œæ‰§è¡Œå‘½ä»¤æ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆã€è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥åœ¨
<a href="http://en.wikipedia.org/wiki/Redirection_(computing)">http://en.wikipedia.org/wiki/Redirection_(computing)</a>
æ‰¾åˆ°æ›´å¤šæœ€æ–°ä¿¡æ¯ã€‚è¿™ç¯‡æ–‡ç« éµå¾ª <a href="http://www.gnu.org/copyleft/fdl.html">GFDL</a> åè®®ã€‚</p></blockquote>
<p>åœ¨æˆ‘çš„ä¸Šä¸€ç¯‡æ—¥å¿—ä¸­ï¼Œæˆ‘å†™åˆ°å¦‚ä½•
<a href="http://jimmyg.org/blog/2009/python-command-line-interface-%28cli%29-with-sub-commands.html">build a command line interface with sub-commands in Python</a>ã€‚
è¿™æ¬¡æˆ‘æ¥å°è¯•å¦‚ä½•é€šè¿‡ Python çš„ <code>subprocess</code> æ¨¡å—æ¥å’Œå‘½ä»¤è¡ŒæŒ‡ä»¤è¿›è¡Œäº¤äº’ã€‚</p>
<p>æˆ‘æƒ³è¾¾åˆ°çš„ç›®æ ‡æ˜¯ï¼š</p>
<ul>
<li>æŸ¥çœ‹å½“ä½ é”®å…¥å‘½ä»¤æ—¶ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆ</li>
<li>å¦‚ä½•ç¡®è®¤ä¸€ä¸ªå‘½ä»¤æ˜¯å¦å­˜åœ¨å¹¶æ‰¾å‡ºåˆ°åº•åœ¨å“ª</li>
<li>é€šè¿‡ Python æˆ– shell æ‰§è¡Œå‘½ä»¤</li>
<li>å‘ä¸€ä¸ªè¿è¡Œä¸­çš„è¿›ç¨‹è¯»å– STDOUT æˆ–å†™å…¥ STDIN</li>
<li>æ£€æŸ¥è¿›ç¨‹çš„é€€å‡ºè¿”å›çŠ¶æ€</li>
<li>ç†è§£ Bash åœ¨å‘½ä»¤ä¸­æ–­ä¸­æ‰®æ¼”çš„è§’è‰²ï¼Œå¹¶å¦‚ä½•å°†å®ƒä»¬å‘é€ç»™ç¨‹åº</li>
</ul>
<!-- more -->
<h2 id="æ‰§è¡Œç¨‹åºæ—¶å‘ç”Ÿäº†ä»€ä¹ˆ">æ‰§è¡Œç¨‹åºæ—¶å‘ç”Ÿäº†ä»€ä¹ˆ</h2>
<p>å½“ä½ åŒå‡»æ¡Œé¢ä¸Šçš„ç»ˆç«¯ç¨‹åºå›¾æ ‡æ—¶ï¼Œå°±ä¼šæ‰“å¼€ä¸€ä¸ªè½½å…¥ <code>shell</code> çš„ç¨‹åºã€‚
ä½ é”®å…¥çš„å‘½ä»¤ä¸ä¼šç›´æ¥åœ¨å†…æ ¸æ‰§è¡Œï¼Œè€Œæ˜¯å…ˆå’Œ shell è¿›è¡Œäº¤äº’ã€‚</p>
<pre tabindex="0"><code>    Command      (eg. `ls -l&#39;)
       â†“
Terminal Program (eg. `gnome-terminal&#39;)
       â†“
     Shell       (eg Bash)
       â†“
     Kernel      (eg. Linux 2.6.24)
</code></pre><p>æ›´å¤šå…³äº shell çš„ä¿¡æ¯ï¼š</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/Unix_shell">http://en.wikipedia.org/wiki/Unix_shell</a></li>
</ul>
<p>æ›´å¤šå…³äºè¿›ç¨‹å¦‚ä½•è¿è¡Œçš„ä¿¡æ¯ï¼š</p>
<ul>
<li><a href="http://pangea.stanford.edu/computerinfo/unix/shell/processes/processes.html">http://pangea.stanford.edu/computerinfo/unix/shell/processes/processes.html</a></li>
</ul>
<p>å½“ä½ é€šè¿‡ Python æ‰§è¡Œç¨‹åºæ—¶å€™ï¼Œä½ å¯ä»¥é€‰æ‹©ç›´æ¥ä»å†…æ ¸æ‰§è¡Œæˆ–è€…é€šè¿‡ shellã€‚
å¦‚æœä½ é€‰æ‹©ç›´æ¥æ‰§è¡Œï¼Œä½ å°±æ²¡åŠæ³•å’Œ bash åŒæ ·æ–¹å¼æ‰§è¡Œå‘½ä»¤ã€‚</p>
<p>æˆ‘ä»¬å…ˆçœ‹çœ‹æ€ä¹ˆä½¿ç”¨ shell å’Œé‚£äº›å¥½ç©çš„ç‰¹æ€§åŠŸèƒ½ï¼Œ
ç„¶åå†é€šè¿‡ <code>subprocess</code> æ¥å®ç°åŒæ ·çš„åŠŸèƒ½ï¼Œ</p>
<h3 id="æ•°æ®æµ">æ•°æ®æµ</h3>
<p>åœ¨ UNIX å’Œ Linux ä¸‹ï¼Œæœ‰ä¸‰ä¸ªè¢«ç§°ä½œ <em>æµ</em> çš„ I/O é€šé“ï¼Œå®ƒä»¬é€šè¿‡æ–‡æœ¬ç»ˆç«¯
ï¼ˆæ¯”å¦‚ç”¨ gnome-terminal è¿è¡Œ Bashï¼‰å’Œå…¶ä»–åº”ç”¨ç¨‹åºï¼ˆæ¯”å¦‚é€šè¿‡ Python çš„
<code>subprocess</code> ï¼‰è¿™ç±»ç¯å¢ƒæ¥è¿æ¥ç¨‹åºã€‚
è¿™å‡ ä¸ª I/O é€šé“åˆ†åˆ«ç§°ä¸º <em>æ ‡å‡†è¾“å…¥</em>ï¼Œ <em>æ ‡å‡†è¾“å‡º</em>ï¼Œå’Œ <em>æ ‡å‡†é”™è¯¯è¾“å‡º</em> ,
å®ƒä»¬çš„ <em>æ–‡ä»¶æè¿°ç¬¦</em> åˆ†åˆ«ä¸º 0ï¼Œ1ï¼Œ2ã€‚</p>
<table>
  <thead>
    <tr>
      <th> å¥æŸ„ </th> <th> åç§° </th> <th> æè¿° </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> 0 </td> <td> stdin </td> <td> æ ‡å‡†è¾“å…¥ </td>
    </tr>
    <tr>
      <td> 1 </td> <td> stdout </td> <td> æ ‡å‡†è¾“å‡º </td>
    </tr>
    <tr>
      <td> 2 </td> <td> stderr </td> <td> æ ‡å‡†é”™è¯¯è¾“å‡º </td>
    </tr>
  </tbody>
</table>
<p>è¿™é‡Œä½ èƒ½çœ‹åˆ°æ ‡å‡†è¾“å…¥å«åš <code>stdin</code>ï¼Œæ ‡å‡†è¾“å‡ºç§°ä½œ <code>stdout</code>ï¼Œæ ‡å‡†é”™è¯¯è¾“å‡ºå«åš
<code>stderr</code> ã€‚</p>
<p>æµæ˜¯è¿™æ ·å·¥ä½œçš„ï¼šä»ç»ˆç«¯è¾“å‡ºè·å–è¾“å…¥å¹¶é€šè¿‡æ ‡å‡†è¾“å…¥å‘é€åˆ°ç¨‹åºï¼Œ
ç¨‹åºè¿”å›çš„æ­£å¸¸è¾“å‡ºä»æ ‡å‡†è¾“å‡ºè¾“å‡ºï¼Œé”™è¯¯åˆ™è¿”å›åˆ°ç¯å¢ƒä¸Šä¸‹æ–‡çš„æ ‡å‡†é”™è¯¯è¾“å‡ºã€‚
ç»´åŸºç™¾ç§‘æœ‰å¹…å›¾å°†æè¿°è¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<p><a href="http://en.wikipedia.org/wiki/File:Stdstreams-notitle.svg">


<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201209/Stdstreams-notitle.svg.png" alt="Stdstreams-notitle.svg"  />



</a></p>
<p>å¦‚æœä½ æƒ³å°†æµä»ä¸€ä¸ªç¨‹åºé‡å®šå‘åˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼Œè¯·çœ‹ä¸‹æ–‡åˆ†è§£ã€‚</p>
<h2 id="ä½¿ç”¨-shell">ä½¿ç”¨ Shell</h2>
<h3 id="é‡å®šå‘æ ‡å‡†è¾“å…¥å’Œè¾“å‡ºåˆ°æ–‡ä»¶">é‡å®šå‘æ ‡å‡†è¾“å…¥å’Œè¾“å‡ºåˆ°æ–‡ä»¶</h3>
<p>ä½ å¯ä»¥åœ¨ Bash ä¸­ä½¿ç”¨ <code>&gt;</code> æ“ä½œç¬¦å°†ä¸€ä¸ªç¨‹åºçš„æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶
ï¼ˆåœ¨å…¶ä»– Shell ä¹Ÿè®¸ç•¥æœ‰è¯­æ³•å·®å¼‚ï¼‰ã€‚è¿™é‡Œæœ‰ä¸ªèŒƒä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">program1 &gt; file1
</span></span></code></pre></div><p><code>program1</code> æ‰§è¡Œåçš„è¾“å‡ºç»“æœä»æ ‡å‡†è¾“å‡ºæµå†™å…¥ <code>file1</code>ï¼Œå¹¶å°† <code>file1</code>
å…¶ä¸­ç°æœ‰çš„å†…å®¹æ‰€æ›¿æ¢ã€‚å¦‚æœä½ åªæ˜¯æƒ³è¿½åŠ å†…å®¹ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>&gt;&gt;</code> æ“ä½œç¬¦ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">program1 &gt;&gt; file1
</span></span></code></pre></div><p><code>&lt;</code> æ“ä½œç¬¦å¯ä»¥è¢«ç”¨æ¥ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®å¹¶ä¼ è¾“åˆ°ç¨‹åºçš„æ ‡å‡†è¾“å…¥æµï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">program1 &lt; file1
</span></span></code></pre></div><p>åŒæ ·çš„ï¼Œ<code>program1</code> ä¼šè¢«æ‰§è¡Œï¼Œä½†æ˜¯æ­¤æ—¶ <code>file1</code> å–ä»£äº†é”®ç›˜ï¼Œ
æˆä¸ºäº†æ ‡å‡†è¾“å…¥çš„æ•°æ®æºã€‚</p>
<p>ä½ å¯ä»¥ç»„åˆ shell æ“ä½œç¬¦ä»¥å®Œæˆæ›´å¤æ‚çš„æ“ä½œã€‚
ä¸‹é¢è¿™ä¸ªèŒƒä¾‹ä¸­ï¼Œ<code>program1</code> ä» <code>file1</code> è·å–æ•°æ®å¹¶å‘é€åˆ°æ ‡å‡†è¾“å…¥ã€‚æ ‡å‡†è¾“å‡ºåˆ™ä»
<code>program1</code> è¾“å‡ºåˆ° <code>file2</code>ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">program1 &lt; file1 &gt; file2
</span></span></code></pre></div><p>ä¹Ÿè®¸æœ‰æ—¶å€™ä½ éœ€è¦ä»ä¸€ä¸ªç¨‹åºè·å–è¾“å‡ºå¹¶å°†å…¶ä½œä¸ºå¦ä¸€ä¸ªç¨‹åºçš„è¾“å…¥ã€‚
ä½ å¯ä»¥é€šè¿‡ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶æ¥å®ç°è¿™ä¸ªæ“ä½œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">program1 &gt; tempfile1
</span></span><span class="line"><span class="cl">program2 &lt; tempfile1
</span></span><span class="line"><span class="cl">rm tempfile1
</span></span></code></pre></div><p>è¿™ç§æ–¹æ³•æœ‰ç‚¹ç´¯èµ˜ï¼Œå› æ­¤ shell æä¾›äº†æ–¹ä¾¿çš„æœºåˆ¶ï¼Œç§°ä¸º <em>ç®¡é“</em></p>
<h3 id="ç®¡é“">ç®¡é“</h3>
<p>ç®¡é“å…è®¸ä¸€ä¸ªç¨‹åºçš„æ ‡å‡†è¾“å‡ºç›´æ¥è¾“å…¥åˆ°å¦ä¸€ä¸ªç¨‹åºçš„æ ‡å‡†è¾“å…¥æµä¸­ï¼Œ
è€Œæ— é¡»åˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">program1 <span class="p">|</span> program2
</span></span></code></pre></div><p>æ“ä½œç¬¦ <code>|</code> è¢«ç§°ä½œ <em>ç®¡é“</em> ç¬¦å·ï¼Œå› æ­¤è¿™ç§æ“ä½œå°±è¢«ç§°ä¸º <em>ç®¡é“</em>ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€å¹…æ¥è‡ªç»´åŸºç™¾ç§‘çš„å›¾ç‰‡æ¥æè¿°ç®¡é“ï¼š</p>
<p><a href="http://en.wikipedia.org/wiki/File:Pipeline.svg">


<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201209/Pipeline.svg.png" alt="Pipeline.svg"  />



</a></p>
<p>è¿™é‡Œæœ‰ä¸ªä½¿ç”¨ <code>find .</code>ï¼ˆéå†å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶å’Œç›®å½•ï¼‰çš„ä¾‹å­ï¼Œå°†è¾“å‡ºå®šå‘åˆ° <code>grep</code>
ç¨‹åºæ¥æŸ¥æ‰¾ç‰¹å®šæ–‡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">find . <span class="p">|</span> grep <span class="s2">&#34;The file I&#39;m after.txt&#34;</span>
</span></span></code></pre></div><p>ç¬¬ä¸€ä¸ªç¨‹åºäº§ç”Ÿçš„æ•°æ®æ˜¯ä¸€è¡Œä¸€è¡Œåœ°å¯¼å‘ç¬¬äºŒä¸ªç¨‹åºçš„ï¼Œæ‰€ä»¥åœ¨ç¬¬ä¸€ä¸ªç¨‹åºè¿è¡Œç»“æŸä¹‹å‰ï¼Œ
ç¬¬äºŒä¸ªç¨‹åºå°±å¯ä»¥å¼€å§‹ä½¿ç”¨å®ƒä»¬ã€‚</p>
<h3 id="ä»æ–‡ä»¶é‡å®šå‘æ ‡å‡†è¾“å…¥å’Œè¾“å‡º">ä»æ–‡ä»¶é‡å®šå‘æ ‡å‡†è¾“å…¥å’Œè¾“å‡º</h3>
<p>åœ¨é‡å®šå‘æ ‡å‡†è¾“å‡ºçš„åŒæ—¶ï¼Œä½ ä¹Ÿå¯ä»¥é‡å®šå‘å…¶ä»–æµï¼Œ
æ¯”å¦‚é‡å®šå‘æ ‡å‡†é”™è¯¯è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡åœ¨ Bash ä¸­ï¼Œ
å¯ä»¥åœ¨æ–‡ä»¶æè¿°ç¬¦ä¹‹å‰ä½¿ç”¨ <code>&gt;</code>ï¼Œ<code>&lt;</code> å’Œ <code>&gt;&gt;</code> æ“ä½œç¬¦æ¥é‡å®šå‘æ•°æ®æµ
ï¼ˆè¿˜è®°å¾—ä¹‹å‰è®¨è®ºçš„æ•°å­— 0ï¼Œ1ï¼Œ2 ä¹ˆï¼‰ã€‚å¦‚æœæŠŠæ ‡å‡†è¾“å‡ºä»£è¡¨çš„æ•°å­— 1 çœç•¥æ‰çœ‹ï¼Œ
ä¼šå‘ç°æˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨æ ‡å‡†è¾“å‡ºã€‚</p>
<p>ä¸‹é¢è¿™æ¡å‘½ä»¤æ‰§è¡Œ <code>program1</code> å¹¶å°†æ‰€æœ‰æ ‡å‡† <em>é”™è¯¯</em> æ•°æ®è¾“å‡ºåˆ° <code>file1</code>ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">program1 2&gt; file1
</span></span></code></pre></div><p>æ‰§è¡Œ <code>program1</code>ï¼Œé”™è¯¯ä¿¡æ¯å°±è¢«é‡å®šå‘åˆ° <code>file</code> äº†ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸ªèŒƒä¾‹ç¨‹åºè®©ä½ æ¥æµ‹è¯•ï¼Œå°†å®ƒä¿å­˜æˆ <code>redirect1.py</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">input</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">input</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Echo to stdout: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="nb">input</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Echo to stderr: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="nb">input</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="n">KeyboardError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</span></span></code></pre></div><p>è¿™ä¸ªç¨‹åºå§‹ç»ˆå°†æ¥å—åˆ°çš„è¾“å…¥æ•°æ®å¹¶åŒæ—¶è¾“å‡ºåˆ° stdout å’Œ stderr ã€‚</p>
<p>åœ¨ csh è¡ç”Ÿå‡ºæ¥çš„ shell ä¸­ï¼Œè¯­æ³•åˆ™æ˜¯åœ¨é‡å®šå‘ç¬¦å·ä¹‹ååŠ ä¸Š <code>&amp;</code> ç¬¦å·ï¼Œ
å¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚ï¼ˆè¯‘è€…æ³¨ï¼šå³ <code>|&amp;</code>ï¼‰</p>
<p>å¦ä¸€ä¸ªå¸¸ç”¨çš„ç‰¹æ€§æ˜¯å°†ä¸€ä¸ªè¾“å‡ºæµé‡å®šå‘åˆ°å®šä¸€ä¸ªã€‚
æœ€å¸¸è§çš„ç”¨æ³•æ˜¯å°†æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼Œ
è¿™æ ·å°±å¯ä»¥æŠŠé”™è¯¯ä¿¡æ¯å’Œæ­£ç¡®ä¿¡æ¯åˆå¹¶åœ¨ä¸€èµ·ï¼Œæ¯”å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">find / -name .profile &gt; results 2&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span></code></pre></div><p>å‘½ä»¤å°†ä¼šæ‰¾å‡ºæ‰€æœ‰åå« <code>.profile</code> çš„æ–‡ä»¶ã€‚
å¦‚æœæ²¡æœ‰é‡å®šå‘ï¼Œå®ƒå°†è¾“å‡ºå‘½ä¸­ä¿¡æ¯åˆ° stdoutï¼Œé”™è¯¯ä¿¡æ¯åˆ° stderr
ï¼ˆæ¯”å¦‚æœ‰äº›ç›®å½•æ— æƒé™è®¿é—®ï¼‰ã€‚å¦‚æœæ ‡å‡†è¾“å‡ºå®šå‘åˆ°æ–‡ä»¶ï¼Œé”™è¯¯ä¿¡æ¯åˆ™ä¼šæ˜¾ç¤ºåœ¨å‘½ä»¤è¡Œä¸Šã€‚
ä¸ºäº†åœ¨ç»“æœæ–‡ä»¶ä¸­å¯ä»¥åŒæ—¶çœ‹åˆ°å‘½ä¸­ä¿¡æ¯å’Œé”™è¯¯ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>2&gt;&amp;1</code>
å°†æ ‡å‡†é”™è¯¯è¾“å‡ºï¼ˆ2ï¼‰è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼ˆ1ï¼‰ã€‚ï¼ˆè¿™æ¬¡å³ä½¿åœ¨ Bash ä¸­ä¹Ÿéœ€è¦ <code>&amp;</code> ç¬¦ã€‚ï¼‰</p>
<p>è™½ç„¶è¯­æ³•ä¸Šå¯ä»¥å°† <code>2&gt;&amp;1</code> æ”¾åˆ° <code>&gt;</code> å‰é¢ï¼Œä½†è¿™æ ·ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚
äº‹å®ä¸Šï¼Œå½“è§£æå™¨è¯»å– <code>2&gt;&amp;1</code> æ—¶å€™ï¼Œå®ƒè¿˜ä¸çŸ¥é“æ ‡å‡†è¾“å‡ºå°†é‡å®šå‘åˆ°å“ªé‡Œï¼Œ
æ‰€ä»¥æ ‡å‡†é”™è¯¯è¾“å‡ºå°±ä¸ä¼šè¢«åˆå¹¶ã€‚</p>
<p>å¦‚æœä½¿ç”¨ç®¡é“åˆå¹¶è¾“å‡ºæµï¼Œé‚£ä¹ˆåˆå¹¶ç¬¦å· <code>2&gt;&amp;1</code> éœ€è¦åœ¨ç®¡é“ç¬¦å· <code>|</code> ä¹‹å‰ã€‚æ¯”å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">find / -name .profile 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> less
</span></span></code></pre></div><p>Bash ä¸­çš„åˆå¹¶è¾“å‡ºç®€å†™å½¢å¼æ˜¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">command</span> &gt; file 2&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span></code></pre></div><p>ä¸ºï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">command</span> <span class="p">&amp;</span>&gt;file
</span></span></code></pre></div><p>æˆ–è€…ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">command</span> &gt;<span class="p">&amp;</span>file
</span></span></code></pre></div><p>ä½†æ˜¯æœ€å¥½åˆ«ç”¨ç®€å†™å½¢å¼ï¼Œå¦åˆ™ä½ ä¼šå¼„ç³Šæ¶‚ã€‚æˆ‘æå€¡å®æ„¿éº»çƒ¦ä½†æ˜¯è¦æ¸…æ™°ã€‚</p>
<p><code>&amp;&gt;</code> æ“ä½œç¬¦åŒæ—¶é‡å®šå‘æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºã€‚
å®ƒçš„ä½œç”¨å’Œåœ¨ Bourne Shell ä¸­çš„ <code>command &gt; file 2&gt;&amp;1</code> ä¸€æ ·ã€‚</p>
<h3 id="ç®¡é“é“¾">ç®¡é“é“¾</h3>
<p>é‡å®šå‘å¯ä»¥å’Œç®¡é“è¿æ¥èµ·æ¥ç»„æˆå¤æ‚çš„å‘½ä»¤ï¼Œæ¯”å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ls <span class="p">|</span> grep <span class="s1">&#39;\.sh&#39;</span> <span class="p">|</span> sort &gt; shlist
</span></span></code></pre></div><p>åˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œç„¶åè¿‡æ»¤å‰©ä¸‹ä»…åŒ…å« .sh çš„å†…å®¹ï¼Œæ ¹æ®æ–‡å­—ç¼–ç æ’åºï¼Œ
ç„¶åå°†æœ€ç»ˆç»“æœè¾“å‡ºåˆ° shlistã€‚è¿™ç§ç±»å‹çš„å‘½ä»¤ç»å¸¸åœ¨ shell è„šæœ¬å’Œæ‰¹å¤„ç†æ–‡ä»¶ä¸­ä½¿ç”¨ã€‚</p>
<h3 id="å¤šé‡è¾“å‡ºé‡å®šå‘">å¤šé‡è¾“å‡ºé‡å®šå‘</h3>
<p>æ ‡å‡†å‘½ä»¤ <code>tee</code> å¯ä»¥é‡å®šå‘ä¸€ä¸ªå‘½ä»¤åˆ°å¤šä¸ªåœ°æ–¹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ls -lrt <span class="p">|</span> tee xyz
</span></span></code></pre></div><p>è¿™å°†æ–‡ä»¶åˆ—è¡¨åŒæ—¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºå’Œæ–‡ä»¶ <code>xyz</code> ä¸­ã€‚</p>
<h3 id="here-æ–‡æ¡£">Here æ–‡æ¡£</h3>
<p>å¤§éƒ¨åˆ† Shellï¼ŒåŒ…æ‹¬ Bash éƒ½æ”¯æŒ <em>Here æ–‡æ¡£</em>ï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨ <code>&lt;&lt;</code>
æ“ä½œç¬¦å’Œä¸€äº›æ–‡æœ¬ä½œä¸ºåˆ†éš”ç¬¦å°†æ–‡æœ¬å—åµŒå…¥åˆ°å‘½ä»¤ä¹‹ä¸­ã€‚</p>
<p>åœ¨ä¸‹é¢çš„èŒƒä¾‹ä¸­ï¼Œæ–‡æœ¬å—è¢«ä¼ é€ç»™ <code>tr</code> å‘½ä»¤ï¼ŒåŒæ—¶ä½¿ç”¨ <code>END_TEXT</code> ä½œä¸º Here
æ–‡æ¡£åˆ†éš”ç¬¦æ¥æŒ‡æ˜æ–‡æœ¬çš„å¼€å§‹å’Œç»“æŸã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ tr a-z A-Z <span class="s">&lt;&lt;END_TEXT
</span></span></span><span class="line"><span class="cl"><span class="s">&gt; one two three
</span></span></span><span class="line"><span class="cl"><span class="s">&gt; uno dos tres
</span></span></span><span class="line"><span class="cl"><span class="s">&gt; END_TEXT</span>
</span></span><span class="line"><span class="cl">ONE TWO THREE
</span></span><span class="line"><span class="cl">UNO DOS TRES
</span></span></code></pre></div><p>ç»è¿‡ <code>tr</code> å¤„ç†åï¼Œè¾“å‡ºçš„ç»“æœæ˜¯ <code>ONE TWO THREE</code> å’Œ <code>UNO DOS TRES</code>ã€‚</p>
<p>ä¸€ç§å¸¸ç”¨ç”¨æ³•æ˜¯ç”¨ Here æ–‡æ¡£å‘æ–‡ä»¶æ·»åŠ æ–‡æœ¬ã€‚
é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–‡æœ¬ä¸­çš„å˜é‡æ˜¯ä¼šè¢«æ›¿æ¢æˆçœŸå®å€¼çš„ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ cat <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">&gt; Working dir $PWD
</span></span></span><span class="line"><span class="cl"><span class="s">&gt; EOF</span>
</span></span><span class="line"><span class="cl">Working dir /home/user
</span></span></code></pre></div><p>é€šè¿‡åœ¨ Here æ–‡æ¡£æ ‡ç­¾å¼•ä¸Šå•å¼•å·æˆ–è€…åŒå¼•å·ï¼Œå°±å¯ä»¥é¿å…è¿™ç§è½¬ä¹‰ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ cat &lt;&lt; <span class="s2">&#34;EOF&#34;</span>
</span></span><span class="line"><span class="cl">&gt; Working dir <span class="nv">$PWD</span>
</span></span><span class="line"><span class="cl">&gt; EOF
</span></span><span class="line"><span class="cl">Working dir <span class="nv">$PWD</span>
</span></span></code></pre></div><h2 id="ä»‹ç»-subprocess">ä»‹ç» <code>subprocess</code></h2>
<p>åˆšæ‰æˆ‘ä»¬è®¨è®ºè¿‡äº†ä¸€äº›å‘½ä»¤è¡Œæä¾›çš„åŠŸèƒ½ï¼Œç°åœ¨è®©æˆ‘ä»¬ä½“éªŒä¸€ä¸‹ <code>subprocess</code> æ¨¡å—ã€‚
ä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œä¸‹é¢è¿™æ¡ç®€å•çš„å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nb">echo</span> <span class="s2">&#34;Hello world!&#34;</span>
</span></span><span class="line"><span class="cl">Hello world!
</span></span></code></pre></div><p>è®©æˆ‘ä»¬è¯•ç€åœ¨ Python ä¸­è¿è¡Œå®ƒã€‚</p>
<p>ä»¥å‰æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€å †å„å¼‚çš„æ ‡å‡†åº“æ¥å®ç°è¿›ç¨‹ç®¡ç†ã€‚
ä» Python 2.4 å¼€å§‹ï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½è¢«ç²¾å¿ƒåœ°æ•´ç†åˆ° <code>subprocess</code> è¿™ä¸ªæ¨¡å—ï¼Œ
å…¶ä¸­çš„ <code>Popen</code> ç±»å¯ä»¥æä¾›æ‰€æœ‰æˆ‘ä»¬éœ€è¦çš„ã€‚</p>
<p>æ³¨æ„</p>
<blockquote>
<p>å¦‚æœä½ å¯¹æ–°çš„ <code>Popen</code> å¦‚ä½•æ›¿æ¢æ—§æ¨¡å—ï¼Œ[subprocess-doc][subprocess-documentation]
æœ‰ä¸€ä¸ªç« èŠ‚è§£é‡Šè¿‡å»æ˜¯å¦‚ä½•ä½œç”¨ä»¥åŠå½“å‰æ˜¯å¦‚ä½•ä½œç”¨ã€‚</p></blockquote>
<p><code>Popen</code> å¯ä»¥æ¥å—ä¸€ä¸‹å‚æ•°ï¼Œè¯¦æƒ…å¯ä»¥åœ¨ [using-the-subprocess-module][http://docs.python.org/library/subprocess.html#using-the-subprocess-module]ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">subprocess.Popen<span class="o">(</span>args, <span class="nv">bufsize</span><span class="o">=</span>0, <span class="nv">executable</span><span class="o">=</span>None, <span class="nv">stdin</span><span class="o">=</span>None,
</span></span><span class="line"><span class="cl">    <span class="nv">stdout</span><span class="o">=</span>None, <span class="nv">stderr</span><span class="o">=</span>None, <span class="nv">preexec_fn</span><span class="o">=</span>None, <span class="nv">close_fds</span><span class="o">=</span>False,
</span></span><span class="line"><span class="cl">    <span class="nv">shell</span><span class="o">=</span>False, <span class="nv">cwd</span><span class="o">=</span>None, <span class="nv">env</span><span class="o">=</span>None, <span class="nv">universal_newlines</span><span class="o">=</span>False,
</span></span><span class="line"><span class="cl">    <span class="nv">startupinfo</span><span class="o">=</span>None, <span class="nv">creationflags</span><span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span>
</span></span></code></pre></div><h2 id="ä½¿ç”¨-shell-1">ä½¿ç”¨ Shell</h2>
<p>è®©æˆ‘ä»¬ä»¥ Hello World! è¿™ä¸ªä¾‹å­å¼€å§‹ã€‚å’Œä¹‹å‰ç±»ä¼¼ï¼Œé€šè¿‡
Python shell æ‰§è¡Œä¸‹åˆ—å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt;&gt;&gt; import subprocess
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; subprocess.Popen<span class="o">(</span><span class="s1">&#39;echo &#34;Hello world!&#34;&#39;</span>, <span class="nv">shell</span><span class="o">=</span>True<span class="o">)</span>
</span></span><span class="line"><span class="cl">Hello world!
</span></span><span class="line"><span class="cl">&lt;subprocess.Popen object at 0x...&gt;
</span></span></code></pre></div><p>å¦‚ä½ æ‰€è§ï¼Œæ ‡å‡†è¾“å‡ºå’ŒåŒæ ·æ‰“å°å‡º <code>Hello world!</code> ï¼Œ
åŒºåˆ«åœ¨äºå‘½ä»¤è¡Œæ˜¾ç¤ºäº†ä¸€ä¸ªæˆ‘ä»¬åˆ›å»ºçš„ <code>subprocess.Popen</code> å®ä¾‹ã€‚</p>
<p>å¦‚æœä½ å°†ä»£ç ä¿å­˜ä¸º <code>process_test.py</code> ï¼Œç„¶ååœ¨å‘½ä»¤è¡Œæ‰§è¡Œï¼Œä½ ä¼šå¾—åˆ°ä¸€æ ·çš„ç»“æœï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ python process_test.py
</span></span><span class="line"><span class="cl">Hello world!
</span></span></code></pre></div><p>çœ‹ä¸Šå»è¿è¡Œ OKã€‚</p>
<p>ä½ å¯èƒ½åœ¨ç¢ç£¨æˆ‘ä»¬åˆ°åº•ä½¿ç”¨äº†å“ªä¸ª shellã€‚Unix çš„é»˜è®¤ shell æ˜¯ <code>/bin/sh</code> ï¼Œ
è€Œ Windows ä¸‹é¢åˆ™å–å†³äº <code>COMSPEC</code> è¿™ä¸ªç¯å¢ƒå˜é‡ã€‚
å¦‚æœä½ è®¾ç½® <code>shell=True</code> ï¼Œåˆ™å¯ä»¥é€šè¿‡ <code>executable</code> å‚æ•°æ¥è‡ªå®šä¹‰ shellã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt;&gt;&gt; subprocess.Popen<span class="o">(</span><span class="s1">&#39;echo &#34;Hello world!&#34;&#39;</span>, <span class="nv">shell</span><span class="o">=</span>True, <span class="nv">executable</span><span class="o">=</span><span class="s2">&#34;/bin/bash&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">Hello world!
</span></span><span class="line"><span class="cl">&lt;subprocess.Popen object at 0x...&gt;
</span></span></code></pre></div><p>å’Œæˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„ä¸€æ ·ï¼Œä½†æ˜¯å¦‚æœä½ ä½¿ç”¨ç‰¹å®šçš„ shell ï¼Œ
ä½ ä¹Ÿè®¸ä¼šå‘ç°ä¸åŒçš„åœ°æ–¹ã€‚</p>
<p>è®©æˆ‘ä»¬æ¢ç´¢ä¸€ä¸‹é€šè¿‡ Python ä½¿ç”¨ shell çš„å…¶ä»–ç‰¹æ€§ï¼š</p>
<p>å˜é‡è§£æï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt;&gt;&gt; subprocess.Popen<span class="o">(</span><span class="s1">&#39;echo $PWD&#39;</span>, <span class="nv">shell</span><span class="o">=</span>True<span class="o">)</span>
</span></span><span class="line"><span class="cl">/home/james/Desktop
</span></span><span class="line"><span class="cl">&lt;subprocess.Popen object at 0x...&gt;
</span></span></code></pre></div><p>ç®¡é“å’Œé‡å®šå‘ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">subprocess.Popen<span class="o">(</span><span class="s1">&#39;echo &#34;Hello world!&#34; | tr a-z A-Z 2&gt; errors.txt&#39;</span>, <span class="nv">shell</span><span class="o">=</span>True<span class="o">)</span>
</span></span><span class="line"><span class="cl">&lt;subprocess.Popen object at 0x...&gt;
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; HELLO WORLD!
</span></span></code></pre></div><p><code>errors.txt</code> åº”è¯¥æ˜¯ç©ºçš„ï¼Œå› ä¸ºæ²¡æœ‰ä»»ä½•é”™è¯¯äº§ç”Ÿã€‚
æœ‰è¶£çš„æ˜¯åœ¨æˆ‘ç”µè„‘ä¸Šï¼Œ<code>Popen</code> å®ä¾‹åœ¨ <code>HELLO WORLD!</code> è¢«æ‰“å°åˆ°æ ‡å‡†è¾“å‡º
<em>ä¹‹å‰</em> å‡ºç°ã€‚
æ©ï¼Œç®¡é“å’Œé‡å®šå‘éƒ½å¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p>
<p>Here æ–‡æ¡£ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt;&gt;&gt; subprocess.Popen<span class="o">(</span><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">... cat &lt;&lt; EOF &gt; new.txt
</span></span></span><span class="line"><span class="cl"><span class="s2">... Hello World!
</span></span></span><span class="line"><span class="cl"><span class="s2">... EOF
</span></span></span><span class="line"><span class="cl"><span class="s2">... &#34;&#34;&#34;</span>, <span class="nv">shell</span><span class="o">=</span>True<span class="o">)</span>
</span></span><span class="line"><span class="cl">&lt;subprocess.Popen object at 0xb7dbbe2c&gt;
</span></span></code></pre></div><p><code>new.txt</code> æ–‡ä»¶æ­£å¸¸ç”Ÿæˆï¼Œå¹¶ä¸”åŒ…å«å†…å®¹ <code>Hello World!</code> ã€‚</p>
<p>å¦‚æˆ‘ä»¬é¢„æ–™ï¼Œåœ¨ shell ä¸­æ­£å¸¸è¿è¡Œçš„å‘½ä»¤åŒæ ·å¯ä»¥åœ¨ Python shell ä¸­è¿è¡Œã€‚</p>
<h2 id="å­—ç¬¦ä¸²å’Œå‚æ•°åˆ—è¡¨">å­—ç¬¦ä¸²å’Œå‚æ•°åˆ—è¡¨</h2>
<p>ç°åœ¨å¯ä»¥è½»æ¾åœ°åœ¨ Python ä¸­æ‰§è¡Œå‘½ä»¤è¡Œäº†ï¼Œä½ ä¹Ÿè®¸ä¼šéœ€è¦ä¼ é€’å˜é‡è¿‡å»ã€‚
å‡è®¾æˆ‘ä»¬è¦ç”¨ <code>echo</code> é‡å†™åˆšæ‰é‚£ä¸ªå‡½æ•°ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">print_string</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span> <span class="n">string</span>
</span></span></code></pre></div><p>ä½ ä¹Ÿè®¸æƒ³å½“ç„¶è¿™æ ·å†™ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">print_string</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="s1">&#39;echo &#34;</span><span class="si">%s</span><span class="s1">&#34;&#39;</span><span class="o">%</span><span class="n">string</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></div><p>è¿™ç§å†™æ³•ï¼Œå½“å­—ç¬¦ä¸²æ˜¯ <code>Hello World!</code> æ—¶å€™æ²¡é—®é¢˜ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt;&gt;&gt; print_string<span class="o">(</span><span class="s1">&#39;Hello world!&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">Hello world!
</span></span></code></pre></div><p>ä½†è¿™æ ·å°±æœ‰é—®é¢˜ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt;&gt;&gt; print_string<span class="o">(</span><span class="s1">&#39;nasty &#34; example&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">/bin/sh: Syntax error: Unterminated quoted string
</span></span></code></pre></div><p>è¿™ä¸ªå‘½ä»¤ä¼šè¢«æ‰§è¡Œæˆ <code>echo &quot;nasty&quot; example&quot;</code> ï¼Œå””ï¼Œè¿™é‡Œçš„è½¬ä¹‰æœ‰é—®é¢˜ã€‚</p>
<p>ä¸€ç§è§£å†³æ–¹å¼æ˜¯åœ¨ä»£ç é‡Œé¢åšå¥½è½¬ä¹‰ï¼Œä½†è¿™æ ·ä¼šå¾ˆéº»çƒ¦ï¼Œ
ä½ éœ€è¦å¤„ç†æ‰€æœ‰å¯èƒ½å‡ºç°çš„è½¬ä¹‰å­—ç¬¦å’Œç©ºæ ¼ç­‰ç­‰ã€‚</p>
<p>Python å¯ä»¥å¸®ä½ å¤„ç†å¥½ï¼Œæ¡ä»¶æ˜¯ä½ ä¸èƒ½ç›´æ¥æ“ä½œ shellï¼Œ
å¦‚ä½•æ“ä½œçœ‹ä¸‹æ–‡ã€‚</p>
<h2 id="shell-ä¹‹å¤–">Shell ä¹‹å¤–</h2>
<p>ç°åœ¨è®©æˆ‘ä»¬è¯•è¯•ä¸æ“ä½œ shell æ¥å®ç°åŒæ ·çš„æ•ˆæœï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">def print_string<span class="o">(</span>string<span class="o">)</span>:
</span></span><span class="line"><span class="cl">	subprocess.Popen<span class="o">([</span><span class="s1">&#39;echo&#39;</span>, string<span class="o">]</span>, <span class="nv">shell</span><span class="o">=</span>False<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; print_string<span class="o">(</span><span class="s1">&#39;Hello world!&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">Hello world!
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; print_string<span class="o">(</span><span class="s1">&#39;nasty &#34; example&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">nasty <span class="s2">&#34; example
</span></span></span></code></pre></div><p>ç°åœ¨ä½ å¯ä»¥çœ‹åˆ°å®ƒæ­£å¸¸åœ°å¤„ç†äº†è½¬ä¹‰ã€‚</p>
<p>æ³¨æ„</p>
<blockquote>
<p>å®é™…ä¸Šä½ ä¹Ÿå¯ä»¥åœ¨ <code>shell=False</code> é‚£é‡Œç›´æ¥ä½¿ç”¨ä¸€ä¸ªå•ç‹¬çš„å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œ
ä½†æ˜¯å®ƒå¿…é¡»æ˜¯å‘½ä»¤ç¨‹åºæœ¬èº«ï¼Œè¿™ç§åšæ³•å’Œåœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­å®šä¹‰ä¸€ä¸ª <code>args</code>
æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚è€Œå¦‚æœå½“ <code>shell=False</code> æ—¶å€™ç›´æ¥æ‰§è¡Œå­—ç¬¦ä¸²å‘½ä»¤ï¼Œåˆ™ä¼šæŠ¥é”™ï¼š</p></blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="s1">&#39;echo &#34;Hello world!&#34;&#39;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="n">File</span> <span class="s2">&#34;&lt;stdin&gt;&#34;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="n">File</span> <span class="s2">&#34;/usr/lib/python2.5/subprocess.py&#34;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">594</span><span class="p">,</span> <span class="ow">in</span> <span class="fm">__init__</span>
</span></span><span class="line"><span class="cl">	<span class="n">errread</span><span class="p">,</span> <span class="n">errwrite</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">File</span> <span class="s2">&#34;/usr/lib/python2.5/subprocess.py&#34;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1147</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_execute_child</span>
</span></span><span class="line"><span class="cl">	<span class="k">raise</span> <span class="n">child_exception</span>
</span></span><span class="line"><span class="cl"><span class="ne">OSError</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">2</span><span class="p">]</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span>
</span></span></code></pre></div><p>å¦‚æœæˆ‘ä»¬è¿˜æ˜¯åšæŒä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒPython ä¼šè®¤ä¸ºè¿™ä¸ª <em>å®Œæ•´çš„å­—ç¬¦ä¸²</em>
æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œçš„ç¨‹åºåï¼Œè€Œå®é™…ä¸Šæ²¡æœ‰ä¸€ä¸ªå«åš <code>echo &quot;Hello world!&quot;</code>
çš„ç¨‹åºï¼Œæ‰€ä»¥æŠ¥é”™äº†ã€‚æ­£ç¡®çš„åšæ³•è¦ç”¨ list åˆ†å¼€ä¼ é€å‚æ•°ã€‚</p>
<h3 id="æ£€æŸ¥-path-ä¸­çš„ç¨‹åº">æ£€æŸ¥ PATH ä¸­çš„ç¨‹åº</h3>
<p>è¿™é‡Œæœ‰ä¸ªæ–¹æ³•å¯ä»¥æ‰¾å‡ºç¨‹åºçœŸæ­£çš„ä½ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">whereis</span><span class="p">(</span><span class="n">program</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PATH&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">program</span><span class="p">))</span> <span class="ow">and</span> \
</span></span><span class="line"><span class="cl">		   <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">program</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">program</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="kc">None</span>
</span></span></code></pre></div><p>è®©æˆ‘ä»¬ç”¨å®ƒæ¥æ‰¾å‡º <code>echo</code> ç¨‹åºåœ¨å“ªé‡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">location</span> <span class="o">=</span> <span class="n">whereis</span><span class="p">(</span><span class="s1">&#39;echo&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="n">location</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>     <span class="nb">print</span> <span class="n">location</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">echo</span>
</span></span></code></pre></div><p>è¿™ä¸ªæ–¹æ³•åŒæ ·å¯ä»¥æ£€æŸ¥ç”¨æˆ·çš„ <code>PATH</code> é‡Œé¢æ˜¯å¦æœ‰ Python éœ€è¦çš„ç¨‹åºã€‚</p>
<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œä¸­çš„ç¨‹åº <code>whereis</code> æ¥æ‰¾å‡ºç¨‹åºçš„è·¯å¾„ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ whereis <span class="nb">echo</span>
</span></span><span class="line"><span class="cl">echo: /bin/echo /usr/share/man/man1/echo.1.gz
</span></span></code></pre></div><p>æ³¨æ„</p>
<blockquote>
<p>æ— è®ºæˆ‘ä»¬ä½¿ç”¨ <code>shell</code> ä¸º <code>True</code> æˆ–è€… <code>False</code> ï¼Œ
æˆ‘ä»¬éƒ½æ²¡æœ‰æŒ‡å®šæ‰§è¡Œç¨‹åºçš„å…¨è·¯å¾„ã€‚
å¦‚æœè¿™ä¸ªç¨‹åºåœ¨ä¸Šä¸‹æ–‡ç¯å¢ƒçš„ <code>PATH</code> å˜é‡ä¸­ï¼Œæˆ‘ä»¬æ‰å¯ä»¥æ‰§è¡Œã€‚
å½“ç„¶å¦‚æœä½ æ„¿æ„ï¼ŒæŒ‡å®šå…¨è·¯å¾„ä¹Ÿæ²¡é—®é¢˜ã€‚</p></blockquote>
<p>ä½ ä¹Ÿå¯ä»¥åšæŒæŒ‡å®š <code>executable</code> ä¸ºæƒ³è¦æ‰§è¡Œçš„ç¨‹åºï¼Œ
ç„¶å <code>args</code> å°±ä¸è®¾å®šç¨‹åºã€‚è™½ç„¶æ²¡çœ‹åˆ°æ˜ç¡®çš„æ–‡æ¡£ï¼Œä¸è¿‡æˆ‘ç”µè„‘ä¸Šé¢å¯ä»¥è¿™ä¹ˆæ‰§è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;echo&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0xb776f56c</span><span class="o">&gt;</span>
</span></span></code></pre></div><p>ä¸ç›´æ¥ä½¿ç”¨ shell ä¼šå¯¼è‡´ä¸èƒ½ç›´è§‚åœ°ä½¿ç”¨é‡å®šå‘ã€ç®¡é“ã€here æ–‡æ¡£ã€shell
å‚æ•°æˆ–å…¶ä»–é‚£äº›å¯ä»¥åœ¨å‘½ä»¤è¡Œä½¿ç”¨çš„æŠ€å·§ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šçœ‹çœ‹æ€ä¹ˆä½¿ç”¨è¿™äº›åŠŸèƒ½ã€‚</p>
<h2 id="ä»æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯é‡å®šå‘">ä»æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯é‡å®šå‘</h2>
<p>å½“ä½ ä½¿ç”¨ <code>Popen</code> æ‰§è¡Œç¨‹åºæ—¶å€™ï¼Œè¾“å‡ºå†…å®¹é€šå¸¸è¢«å‘é€åˆ° stdoutï¼Œ
è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä½ èƒ½çœ‹åˆ°è¿™äº›å†…å®¹ã€‚</p>
<p>å½“ä½ æƒ³å°è¯•ä»æŸä¸ªç¨‹åºè¯»å–æ ‡å‡†è¾“å‡ºä¿¡æ¯æ—¶å€™ï¼Œåˆ™éœ€è¦åœ¨è°ƒç”¨ <code>Popen</code> ä¹‹å‰è®¾å®š
<code>stdout</code> å‚æ•°ã€‚è¦è®¾å®šçš„å€¼æ˜¯ <code>subprocess.PIPE</code>ï¼š</p>
<p><code>subprocess.PIPE</code></p>
<blockquote>
<p>å¯ä»¥ä¸º <code>Popen</code> æŒ‡å®šæ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºçš„å‚æ•°ï¼Œ
éœ€è¦æ³¨æ„çš„æ˜¯æ ‡å‡†è¾“å‡ºæµéœ€è¦æ‰“å¼€å¯å†™ã€‚</p></blockquote>
<p>è¿™é‡Œæœ‰ä¸ªèŒƒä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;echo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello World!&#39;</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
</span></span></code></pre></div><p>To read the output from the pipe you use the <code>communicate()</code> method:</p>
<p>ä¸ºäº†ä»ç®¡é“è·å–è¾“å‡ºï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>communicate()</code> æ–¹æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="s1">&#39;Hello World!</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span></span></code></pre></div><p><code>communicate()</code> çš„è¿”å›å€¼æ˜¯ä¸€ä¸ª tupleï¼Œç¬¬ä¸€ä¸ªå€¼æ˜¯æ ‡å‡†è¾“å‡ºçš„æ•°æ®ï¼Œ
ç¬¬äºŒä¸ªè¾“å‡ºæ˜¯æ ‡å‡†é”™è¯¯è¾“å‡ºçš„å†…å®¹ã€‚</p>
<p>è¿™é‡Œæœ‰æ®µè„šæœ¬èƒ½è®©æˆ‘ä»¬æµ‹è¯•æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºçš„è¡¨ç°è¡Œä¸ºï¼Œ
å°†å®ƒå­˜ä¸º <code>test1.py</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Message to stdout</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Message to stderr</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>æ‰§è¡Œå®ƒï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="s1">&#39;test1.py&#39;</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Message</span> <span class="n">to</span> <span class="n">stderr</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="s1">&#39;Message to stdout</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span></span></code></pre></div><p>æ³¨æ„æ ‡å‡†é”™è¯¯è¾“å‡ºåœ¨è¢«ç”Ÿæˆåå°±æ‰“å°äº†ï¼Œè€Œæ ‡å‡†è¾“å‡ºåˆ™è¢«ç®¡é“ä¼ è¾“äº†ã€‚
è¿™æ˜¯å› ä¸ºæˆ‘ä»¬åªè®¾å®šäº†æ ‡å‡†è¾“å‡ºçš„ç®¡é“ï¼Œè®©æˆ‘ä»¬åŒæ—¶ä¹Ÿè®¾å®šæ ‡å‡†é”™è¯¯è¾“å‡ºã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="s1">&#39;test1.py&#39;</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="s1">&#39;Message to stdout</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Message to stderr</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>è¿™æ¬¡æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºéƒ½è¢« Python è·å–åˆ°äº†ã€‚</p>
<p>ç°åœ¨æ‰€æœ‰çš„æ¶ˆæ¯èƒ½è¢«æ‰“å°å‡ºæ¥äº†ï¼Œå¦‚æœæˆ‘ä»¬å†æ¬¡è°ƒç”¨ <code>communicate()</code>ï¼Œ
åˆ™ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="n">File</span> <span class="s2">&#34;&lt;stdin&gt;&#34;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="n">File</span> <span class="s2">&#34;/usr/lib/python2.5/subprocess.py&#34;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">668</span><span class="p">,</span> <span class="ow">in</span> <span class="n">communicate</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_communicate</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">File</span> <span class="s2">&#34;/usr/lib/python2.5/subprocess.py&#34;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1207</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_communicate</span>
</span></span><span class="line"><span class="cl">	<span class="n">rlist</span><span class="p">,</span> <span class="n">wlist</span><span class="p">,</span> <span class="n">xlist</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">read_set</span><span class="p">,</span> <span class="n">write_set</span><span class="p">,</span> <span class="p">[])</span>
</span></span><span class="line"><span class="cl"><span class="ne">ValueError</span><span class="p">:</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span> <span class="n">operation</span> <span class="n">on</span> <span class="n">closed</span> <span class="n">file</span>
</span></span></code></pre></div><p><code>communicate()</code> æ–¹æ³•è¯»å–æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºæ—¶å€™ï¼Œé‡åˆ°ç»“æŸç¬¦ï¼ˆEOFï¼‰
å°±ä¼šç»“æŸã€‚</p>
<h3 id="é‡å®šå‘-stderr-åˆ°-stdout">é‡å®šå‘ stderr åˆ° stdout</h3>
<p>å¦‚æœä½ æƒ³å°†é”™è¯¯ä¿¡æ¯é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼Œåªéœ€è¦ç»™ <code>stderr</code>
å‚æ•°æŒ‡å®šä¸€ä¸ªç‰¹æ®Šå€¼ï¼š <code>stderr=subprocess.STDOUT</code> å³å¯ã€‚</p>
<h2 id="å†™å…¥æ ‡å‡†è¾“å…¥">å†™å…¥æ ‡å‡†è¾“å…¥</h2>
<p>å†™æ•°æ®å…¥ä¸€ä¸ªè¿›ç¨‹å’Œä¹‹å‰æ‰€è¿°æ¯”è¾ƒç±»ä¼¼ã€‚ä¸ºäº†è¦å†™å…¥æ•°æ®ï¼Œéœ€è¦å…ˆæ‰“å¼€ä¸€ä¸ªç®¡é“åˆ°æ ‡å‡†è¾“å…¥ã€‚
é€šè¿‡è®¾å®š <code>Popen</code> å‚æ•° <code>stdin=subproces.PIPE</code> å¯ä»¥å®ç°ã€‚</p>
<p>ä¸ºäº†æµ‹è¯•ï¼Œè®©æˆ‘ä»¬å¦å¤–å†™ä¸€ä¸ªä»…è¾“å‡º <code>Received:</code> å’Œè¾“å…¥æ•°æ®çš„ç¨‹åºã€‚
å®ƒåœ¨é€€å‡ºä¹‹å‰ä¼šè¾“å‡ºæ¶ˆæ¯ã€‚è°ƒç”¨è¿™ä¸ª <code>test2.py</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="nb">input</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Received: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="nb">input</span><span class="p">)</span>
</span></span></code></pre></div><p>ä¸ºäº†å‘é€æ¶ˆæ¯åˆ°æ ‡å‡†è¾“å…¥ï¼ŒæŠŠä½ æƒ³å‘é€çš„ä¿¡æ¯ä½œä¸º <code>communicate()</code> çš„å‚æ•° <code>input</code> ã€‚è®©æˆ‘ä»¬è·‘èµ·æ¥ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="s1">&#39;test2.py&#39;</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">(</span><span class="s1">&#39;How are you?&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Received</span><span class="p">:</span> <span class="n">How</span> <span class="n">are</span> <span class="n">you</span><span class="err">?</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span></span></code></pre></div><p>æ³¨æ„ <code>test2.py</code> å‘é€çš„ä¿¡æ¯è¢«æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºï¼Œéšåçš„æ˜¯ <code>(None, None)</code> ï¼Œ
è¿™æ˜¯å› ä¸ºæ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºæ²¡æœ‰è®¾å®šè¾“å‡ºç®¡é“ã€‚</p>
<p>ä½ å¯ä»¥å’Œä¹‹å‰é‚£æ ·æŒ‡å®š <code>stdout=subprocess.PIPE</code>
å’Œ <code>stderr=subprocess.PIPE</code> æ¥è®¾å®šè¾“å‡ºç®¡é“ã€‚</p>
<h3 id="ç±»æ–‡ä»¶å±æ€§">ç±»æ–‡ä»¶å±æ€§</h3>
<p><code>Popen</code> æ‹¥æœ‰ <code>stdout</code> å’Œ <code>stderr</code> å±æ€§ï¼Œä»è€Œå¯ä»¥å½“ä½œæ–‡ä»¶ä¸€æ ·å†™å‡ºæ•°æ®ï¼ŒåŒæ—¶ <code>stdin</code> å±æ€§å¯ä»¥åƒæ–‡ä»¶ä¸€æ ·è¯»å–æ•°æ®ã€‚
ä½ å¯ä»¥ä½¿ç”¨ä»–ä»¬æ¥æ›¿æ¢ <code>communicate()</code>ã€‚ä¸‹é¢æˆ‘ä»¬å°†çœ‹å¦‚ä½•ç”¨å®ƒä»¬ã€‚</p>
<h3 id="è¯»å†™åŒä¸€ä¸ªè¿›ç¨‹">è¯»å†™åŒä¸€ä¸ªè¿›ç¨‹</h3>
<p>è¿™é‡Œæœ‰ä¸ªä¾‹å­ï¼Œå°†å®ƒä¿å­˜ä¸º <code>test3.py</code>ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="nb">input</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Received: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="nb">input</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span></span></code></pre></div><p>è¿™ä¸ªç¨‹åºä¹Ÿæ˜¯ç®€å•çš„å“åº”æ¥å—åˆ°çš„æ•°æ®ï¼Œè®©æˆ‘ä»¬æŠŠå®ƒè·‘èµ·æ¥ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="s1">&#39;test3.py&#39;</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>     <span class="n">process</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>     <span class="n">output</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>     <span class="nb">print</span> <span class="n">output</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>     <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">Received</span><span class="p">:</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Received</span><span class="p">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Received</span><span class="p">:</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Received</span><span class="p">:</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Received</span><span class="p">:</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span>
</span></span></code></pre></div><p>æ¯éš”ä¸€ç§’é’Ÿä¼šè¾“å‡ºä¸€è¡Œã€‚</p>
<p>ç°åœ¨ä½ åº”è¯¥æŒæ¡äº†æ‰€æœ‰éœ€è¦é€šè¿‡ Python æ¥è·Ÿ Shell äº¤äº’éœ€è¦çš„çŸ¥è¯†ã€‚</p>
<h2 id="è·å–è¿”å›å€¼-poll-å’Œ-wait">è·å–è¿”å›å€¼ï¼Œ <code>poll()</code> å’Œ <code>wait()</code></h2>
<p>å½“ä¸€ä¸ªç¨‹åºé€€å‡ºæ—¶å€™ï¼Œä»–ä¼šè¿”å›ä¸€ä¸ªæ­£æ•´æ•°æ¥è¡¨æ˜å®ƒçš„é€€å‡ºçŠ¶æ€ã€‚
0 ä»£è¡¨ã€ŒæˆåŠŸåœ°ç»“æŸã€ï¼Œéé›¶åˆ™è¡¨ç¤ºã€Œéæ­£å¸¸ç»“æŸã€ã€‚
å¤§éƒ¨åˆ†ç³»ç»Ÿè¦æ±‚è¿”å›å€¼åœ¨ 0-127 ä¹‹é—´ï¼Œå…¶ä»–éƒ½æ˜¯æœªå®šä¹‰çš„ç»“æœã€‚
ä¸€äº›ç³»ç»Ÿä¼šæœ‰äº‹å…ˆå®šä¹‰å¥½çš„é”™è¯¯å¯¹åº”å…³ç³»ï¼Œä½†ä¸€èˆ¬ä¸è¢«æ‹¿å‡ºæ¥ç”¨ã€‚
Unix ç¨‹åºé€šå¸¸ä½¿ç”¨ 2 ä½œä¸ºå‘½ä»¤è¯­æ³•é”™è¯¯ï¼Œ1 ä½œä¸ºå…¶ä»–é”™è¯¯ã€‚</p>
<p>ä½ å¯ä»¥é€šè¿‡ <code>Popen</code> çš„ <code>.returncode</code> å±æ€§è·å–ç¨‹åºè¿”å›å€¼ã€‚è¿™å„¿æœ‰ä¸ªä¾‹å­ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;echo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello world!&#39;</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">process</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">process</span><span class="o">.</span><span class="n">returncode</span>
</span></span><span class="line"><span class="cl"><span class="kc">None</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="n">process</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">process</span><span class="o">.</span><span class="n">returncode</span>
</span></span><span class="line"><span class="cl"><span class="mi">0</span>
</span></span></code></pre></div><p>è¿™ä¸ª <code>returncode</code> å¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±è®¾å®šå¥½çš„ï¼Œæœ€åˆæ˜¯é»˜è®¤å€¼ <code>None</code>ï¼Œ
å®ƒä¼šä¸€ç›´æ˜¯ <code>None</code> çŸ¥é“ä½ è°ƒç”¨ <code>subprocess</code> çš„æ–¹æ³•æ¯”å¦‚ <code>poll()</code> å’Œ <code>wait()</code>ã€‚
è¿™äº›æ–¹æ³•ä¼šè®¾å®š <code>returncode</code>ã€‚å› æ­¤ï¼Œå¦‚æœä½ æƒ³çŸ¥é“è¿”å›å€¼ï¼Œé‚£å°±è°ƒç”¨ <code>poll()</code>
å’Œ <code>wait()</code>ã€‚</p>
<p><code>poll()</code> å’Œ <code>wait()</code> æ–¹æ³•åŒºåˆ«å¾ˆå°ï¼š</p>
<dl>
<dt><code>Popen.poll()</code></dt>
<dd>æ£€æŸ¥å­è¿›ç¨‹æ˜¯å¦ç»“æŸã€‚å¹¶è®¾ç½®å’Œè¿”å› <code>.returncode</code> å±æ€§ã€‚
<code>Popen.wait()</code></dd>
<dd>ç­‰å¾…å­è¿›ç¨‹ç»“æŸã€‚å¹¶è®¾ç½®å’Œè¿”å› <code>.returncode</code> å±æ€§ã€‚</dd>
</dl>
<h2 id="ä¾¿æ·çš„æ–¹æ³•">ä¾¿æ·çš„æ–¹æ³•</h2>
<p><code>subprocess</code> æ¨¡å—è¿˜æä¾›äº†å¾ˆå¤šæ–¹ä¾¿çš„æ–¹æ³•æ¥ä½¿å¾—æ‰§è¡Œ shell å‘½ä»¤æ›´æ–¹ä¾¿ã€‚
æˆ‘æ²¡æœ‰å…¨éƒ¨è¯•è¯•ã€‚ï¼ˆè¯‘è€…ï¼šæ„æ€æ˜¯è®©è¯»è€…è‡ªå·±æŒ–æ˜ï¼Ÿï¼‰</p>
<h2 id="ç†è§£-sysargv">ç†è§£ <code>sys.argv</code></h2>
<p>å¦‚æœä½ æƒ³å†™ä¸€ä¸ª Python è„šæœ¬æ¥æ¥å—å‘½ä»¤è¡Œå‚æ•°ï¼Œ
é‚£ä¹ˆå‘½ä»¤è¡Œçš„å‚æ•°ä¼šè¢«ä¼ é€å¹¶æˆå‚æ•° <code>sys.argv</code>ã€‚
è¿™é‡Œæœ‰ä¸ªå°èŒƒä¾‹ï¼Œå°†å®ƒä¿å­˜æˆ <code>command.py</code> ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span> <span class="s2">&#34;Executable: </span><span class="si">%s</span><span class="s2">&#34;</span><span class="o">%</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span> <span class="s2">&#34;Arg: </span><span class="si">%s</span><span class="s2">&#34;</span><span class="o">%</span><span class="n">arg</span>
</span></span></code></pre></div><p><code>if __name__ == '__main__'</code> è¿™è¡Œç¡®ä¿ä»£ç åœ¨è¢«æ‰§è¡Œæ˜¯æ‰è¿è¡Œï¼Œ
è€Œä¸æ˜¯è¢«å¼•å…¥æ—¶å€™è¿è¡Œã€‚ç»™è¿™ä¸ªæ–‡ä»¶æ‰§è¡Œæƒé™ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ chmod <span class="m">755</span> command.py
</span></span></code></pre></div><p>è¿™é‡Œæ˜¯ä¸€äº›è¿è¡Œæ—¶çš„èŒƒä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ python command.py
</span></span><span class="line"><span class="cl">Executable: command.py
</span></span><span class="line"><span class="cl">$ python command.py arg1
</span></span><span class="line"><span class="cl">Executable: command.py
</span></span><span class="line"><span class="cl">Arg: arg1
</span></span><span class="line"><span class="cl">$ python command.py arg1 arg2
</span></span><span class="line"><span class="cl">Executable: command.py
</span></span><span class="line"><span class="cl">Arg: arg1
</span></span><span class="line"><span class="cl">Arg: arg2
</span></span></code></pre></div><p>æ³¨æ„æ— è®º Python è„šæœ¬æ€ä¹ˆæ‰§è¡Œï¼Œ <code>sys.argv[0]</code> å§‹ç»ˆæ˜¯è„šæœ¬çš„åç§°ã€‚
<code>sys.argv[1]</code> å’Œä¹‹åçš„å‚æ•°æ˜¯å‘½ä»¤è¡Œæ¥å—çš„å‚æ•°ã€‚
ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨å‚æ•° <code>-m</code> æ¥å¼ºåˆ¶ Python è„šæœ¬ä½œä¸ºæ¨¡å—å¯¼å…¥ä½¿ç”¨ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ python -m <span class="nb">command</span>
</span></span><span class="line"><span class="cl">Executable: /home/james/Desktop/command.py
</span></span><span class="line"><span class="cl">$ python -m <span class="nb">command</span> arg1
</span></span><span class="line"><span class="cl">Executable: /home/james/Desktop/command.py
</span></span><span class="line"><span class="cl">Arg: arg1
</span></span><span class="line"><span class="cl">$ python -m <span class="nb">command</span> arg1 arg2
</span></span><span class="line"><span class="cl">Executable: /home/james/Desktop/command.py
</span></span><span class="line"><span class="cl">Arg: arg1
</span></span><span class="line"><span class="cl">Arg: arg2
</span></span></code></pre></div><p>å¦‚ä½ æ‰€è§ï¼ŒPython å°† <code>-m</code> ä½œä¸ºå‘½ä»¤çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤ `sys.srgv[0] åŒ…å«äº†è„šæœ¬çš„å…¨è·¯å¾„ã€‚
ç°åœ¨æˆ‘ä»¬æ¥ç›´æ¥æ‰§è¡Œå®ƒï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ./command.py
</span></span><span class="line"><span class="cl">Executable: ./command.py
</span></span><span class="line"><span class="cl">$ ./command.py arg1
</span></span><span class="line"><span class="cl">Executable: ./command.py
</span></span><span class="line"><span class="cl">Arg: arg1
</span></span><span class="line"><span class="cl">$ ./command.py arg1 arg2
</span></span><span class="line"><span class="cl">Executable: ./command.py
</span></span><span class="line"><span class="cl">Arg: arg1
</span></span><span class="line"><span class="cl">Arg: arg2
</span></span></code></pre></div><p>çœ‹å§ï¼Œ<code>sys.argv[0]</code> åŒ…å« Python è„šæœ¬çš„åç§°ï¼Œ <code>sys.argv[1]</code>
ä»¥åŠä»–çš„å…„å¼Ÿä»¬è¿˜æ˜¯è€æ ·å­ï¼ŒåŒ…å«å„ç±»å‚æ•°ã€‚</p>
<h3 id="å±•å¼€-shell">å±•å¼€ Shell</h3>
<p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šåœ¨ shell ä¸­ä½¿ç”¨é€šé…ç¬¦æ¥è®¾å®šä¸€ç»„å‚æ•°ï¼Œæ¯”å¦‚ï¼Œ
æˆ‘ä»¬åœ¨ Bash ä¸­è¿è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ./command.py *.txt
</span></span></code></pre></div><p>ä½ å¯èƒ½è§‰å¾—è¾“å‡ºåº”è¯¥æ˜¯ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Executable: ./command.py
</span></span><span class="line"><span class="cl">Arg: *.txt
</span></span></code></pre></div><p>è¿™ä¸æ˜¯ä½ æƒ³è¦çš„ç»“æœã€‚è¾“å‡ºç»“æœåº”è¯¥ä¾èµ–å½“å‰æ–‡ä»¶å¤¹ä¸­ <code>.txt</code> æ–‡ä»¶çš„æ•°ç›®ã€‚æ‰§è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Executable: ./command.py
</span></span><span class="line"><span class="cl">Arg: errors.txt
</span></span><span class="line"><span class="cl">Arg: new.txt
</span></span><span class="line"><span class="cl">Arg: output.txt
</span></span></code></pre></div><p>Bash ä¼šå°† <code>\*.txt</code> è‡ªåŠ¨å±•å¼€æˆæ‰€æœ‰ç¬¦åˆ <code>.txt</code> çš„å‚æ•°ã€‚æ‰€ä»¥æ¥å—åˆ°çš„å‚æ•°ä¼šè¶…è¿‡ä½ é¢„æœŸã€‚</p>
<p>ä½ å¯ä»¥é€šè¿‡å°†å‚æ•°ç”¨å¼•å·æŠ±èµ·æ¥æ¥å…³é—­ Shell è§£é‡Šç‰¹æ€§ï¼Œ
ä½†æ˜¯åªè¦ä½ ç”¨è¿‡ï¼Œå°±ä¼šæ„è¯†åˆ°åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹é¢è¿™æ˜¯éå¸¸æœ‰ç”¨çš„åŠŸèƒ½ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ./command.py <span class="s2">&#34;*.txt&#34;</span>
</span></span><span class="line"><span class="cl">Executable: ./command.py
</span></span><span class="line"><span class="cl">Arg: *.txt
</span></span></code></pre></div><p>æ›´å¤šå…³äº Bash è§£é‡Šä¿¡æ¯ï¼Œå¯ä»¥çœ‹ <a href="http://www.gnu.org/software/bash/manual/bashref.html#Filename-Expansion">http://www.gnu.org/software/bash/manual/bashref.html#Filename-Expansion</a></p>
<h2 id="æ‹“å±•é˜…è¯»">æ‹“å±•é˜…è¯»</h2>
<p>å¯ä»¥å‚è€ƒï¼š</p>
<ul>
<li><a href="http://www.doughellmann.com/PyMOTW/subprocess/">http://www.doughellmann.com/PyMOTW/subprocess/</a> (and its O&rsquo;Reilly copy here)</li>
<li><a href="http://docs.python.org/library/subprocess.html">http://docs.python.org/library/subprocess.html</a></li>
<li><a href="http://webpython.codepoint.net/cgi_shell_command">http://webpython.codepoint.net/cgi_shell_command</a></li>
<li><a href="http://www.artima.com/weblogs/viewpost.jsp?thread=4829">http://www.artima.com/weblogs/viewpost.jsp?thread=4829</a> (About writing main() functions)</li>
</ul>
<p>æœªæ¥ç›¸å…³çš„æ–‡ç« ï¼š</p>
<ul>
<li>è¿›ç¨‹é—´ä¿¡å·é€šä¿¡</li>
<li>åå°æ‰§è¡Œç¨‹åº</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>MoinMoin Wiki è½¬æ¢ Text è„šæœ¬</title>
      <link>https://blog.alswl.com/2012/07/moin2txt/</link>
      <pubDate>Fri, 27 Jul 2012 09:02:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2012/07/moin2txt/</guid>
      <description>&lt;p&gt;æˆ‘ä½¿ç”¨ MoinMoin ä½œä¸ºæˆ‘çš„ KMSï¼Œå…·ä½“ä½¿ç”¨æ–¹å¼å¯ä»¥å‚è€ƒ
[ä½¿ç”¨MoinMoinä½œä¸ºä¸ªäººKMS][moin-kms]ã€‚å¦å¤–ï¼Œæˆ‘å°† MoinMoin çš„ &lt;code&gt;data&lt;/code&gt;
ç›®å½•é“¾æ¥åˆ° Dropbox åŒæ­¥ç›®å½•ä¸‹é¢ï¼Œä»è€Œå¯ä»¥å¤‡ä»½å¹¶æŸ¥çœ‹æˆ‘çš„çŸ¥è¯†åº“ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æˆ‘æƒ³åŒæ­¥é˜…è¯»-kms-æ•°æ®&#34;&gt;æˆ‘æƒ³åŒæ­¥é˜…è¯» KMS æ•°æ®&lt;/h2&gt;
&lt;p&gt;æƒ³åœ¨ç§»åŠ¨è®¾å¤‡é˜…è¯» KMS æ•°æ®æ—¶ï¼Œæˆ‘é‡åˆ°ä¸€ä¸ªéº»çƒ¦ï¼ŒMoinMoin ä½¿ç”¨æ–‡ä»¶æ¥ä¿å­˜ wiki æ•°æ®ï¼Œ
æ¯”å¦‚ã€Œ28ä¸ªUnix.Linuxçš„å‘½ä»¤è¡Œç¥å™¨ã€è¿™ç¯‡ wiki ç›®å½•åœ¨
&lt;code&gt;data/28(e4b8aa)Unix(2e)Linux(e79a84e591bde4bba4e8a18ce7a59ee599a8)&lt;/code&gt; ä¸­ï¼Œ
ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;!-- more --&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;|---revisions
|        |---00000002
|        |---00000001
|---edit-log
|---current
|---attachments
|          |---http___coolshell.cn_wp-content_uploads_2012_07_xargs_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_sl.jpg
|          |---http___coolshell.cn_wp-content_uploads_2012_07_mtr_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_lftp_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_htop_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_calcurse_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_multitail_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_ack_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_tpp_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_powertop_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_newsbeuter_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_socat_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_siege_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_duplicity_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_ipbt_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_iftop_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_curl_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_iptraf-tcpudp.gif
|          |---http___coolshell.cn_wp-content_uploads_2012_07_vim_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_earthquake.jpg
|          |---http___coolshell.cn_wp-content_uploads_2012_07_tmux3.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_cowsay_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_TaskWarrior2.0.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_vifm_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_taskwarrior_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_linuxlogo.jpg
|          |---http___coolshell.cn_wp-content_uploads_2012_07_ranger.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_nethack_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_rtorrent_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_dtach+dvtm.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_gnu_screen_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_ledger_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_rsync_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_byobu-tmux.jpg
|          |---http___coolshell.cn_wp-content_uploads_2012_07_ttytter_screenshot.png
|---cache
|    |---text_html
|    |---pagelinks
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œä¸­æ–‡åç§°çš„ wiki åœ¨å­˜å‚¨æ—¶å€™ï¼ŒMoinMoin ä¼šå°†ä¸­æ–‡ä¿å­˜ä¸º utf-8 ç ï¼Œ
ä¸èƒ½ç›´æ¥é˜…è¯»ã€‚å¹¶ä¸”æˆ‘éœ€è¦å°†ç›®å½•ä¸‹é¢æœ‰å¤šçº§ç›®å½•ï¼Œé˜…è¯»éº»çƒ¦ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>æˆ‘ä½¿ç”¨ MoinMoin ä½œä¸ºæˆ‘çš„ KMSï¼Œå…·ä½“ä½¿ç”¨æ–¹å¼å¯ä»¥å‚è€ƒ
[ä½¿ç”¨MoinMoinä½œä¸ºä¸ªäººKMS][moin-kms]ã€‚å¦å¤–ï¼Œæˆ‘å°† MoinMoin çš„ <code>data</code>
ç›®å½•é“¾æ¥åˆ° Dropbox åŒæ­¥ç›®å½•ä¸‹é¢ï¼Œä»è€Œå¯ä»¥å¤‡ä»½å¹¶æŸ¥çœ‹æˆ‘çš„çŸ¥è¯†åº“ã€‚</p>
<h2 id="æˆ‘æƒ³åŒæ­¥é˜…è¯»-kms-æ•°æ®">æˆ‘æƒ³åŒæ­¥é˜…è¯» KMS æ•°æ®</h2>
<p>æƒ³åœ¨ç§»åŠ¨è®¾å¤‡é˜…è¯» KMS æ•°æ®æ—¶ï¼Œæˆ‘é‡åˆ°ä¸€ä¸ªéº»çƒ¦ï¼ŒMoinMoin ä½¿ç”¨æ–‡ä»¶æ¥ä¿å­˜ wiki æ•°æ®ï¼Œ
æ¯”å¦‚ã€Œ28ä¸ªUnix.Linuxçš„å‘½ä»¤è¡Œç¥å™¨ã€è¿™ç¯‡ wiki ç›®å½•åœ¨
<code>data/28(e4b8aa)Unix(2e)Linux(e79a84e591bde4bba4e8a18ce7a59ee599a8)</code> ä¸­ï¼Œ
ç»“æ„å¦‚ä¸‹ï¼š</p>
<!-- more -->
<pre tabindex="0"><code>|---revisions
|        |---00000002
|        |---00000001
|---edit-log
|---current
|---attachments
|          |---http___coolshell.cn_wp-content_uploads_2012_07_xargs_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_sl.jpg
|          |---http___coolshell.cn_wp-content_uploads_2012_07_mtr_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_lftp_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_htop_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_calcurse_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_multitail_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_ack_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_tpp_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_powertop_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_newsbeuter_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_socat_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_siege_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_duplicity_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_ipbt_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_iftop_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_curl_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_iptraf-tcpudp.gif
|          |---http___coolshell.cn_wp-content_uploads_2012_07_vim_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_earthquake.jpg
|          |---http___coolshell.cn_wp-content_uploads_2012_07_tmux3.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_cowsay_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_TaskWarrior2.0.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_vifm_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_taskwarrior_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_linuxlogo.jpg
|          |---http___coolshell.cn_wp-content_uploads_2012_07_ranger.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_nethack_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_rtorrent_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_dtach+dvtm.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_gnu_screen_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_ledger_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_rsync_screenshot.png
|          |---http___coolshell.cn_wp-content_uploads_2012_07_byobu-tmux.jpg
|          |---http___coolshell.cn_wp-content_uploads_2012_07_ttytter_screenshot.png
|---cache
|    |---text_html
|    |---pagelinks
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸­æ–‡åç§°çš„ wiki åœ¨å­˜å‚¨æ—¶å€™ï¼ŒMoinMoin ä¼šå°†ä¸­æ–‡ä¿å­˜ä¸º utf-8 ç ï¼Œ
ä¸èƒ½ç›´æ¥é˜…è¯»ã€‚å¹¶ä¸”æˆ‘éœ€è¦å°†ç›®å½•ä¸‹é¢æœ‰å¤šçº§ç›®å½•ï¼Œé˜…è¯»éº»çƒ¦ã€‚</p>
<h2 id="ä¸€ä¸ªè„šæœ¬">ä¸€ä¸ªè„šæœ¬</h2>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å†™äº†å¦‚ä¸‹å°è„šæœ¬ï¼Œå¸®æˆ‘è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<pre tabindex="0"><code>#!/usr/bin/env python2
# coding=utf-8

# convert MoinMoin wiki to text
# for moinmoin 1.9.x
# author: alswl
# update at: 2012-07-22

import sys
import os
import argparse
import binascii
import re
import shutil

IS_DECODE_PATH = False

def convert(root, dir, target):
    name = name_decode(dir)
    if not name:
        return
    dst = os.path.join(target, name.replace(&#39;/&#39;, &#39;-&#39;) + &#39;.txt&#39;)
    try:
        version = open(os.path.join(root, dir, &#39;current&#39;),
                       &#39;r&#39;).readline().strip()
        src = os.path.join(root, dir, &#39;revisions&#39;, version)
        shutil.copyfile(src, dst)
    except IOError, e:
        if IS_DECODE_PATH:
            dir = dir.replace(&#39;(&#39;, r&#39;\(&#39;).replace(&#39;)&#39;, r&#39;\)&#39;)
        sys.stderr.write(&#39;File %s, Name: %s, Message: %s\n&#39;
                         %(dir, name, str(e)))

def name_decode(name):
    raw = &#39;&#39;
    lastpos = 0
    ENCODE_RE = re.compile(r&#39;\(([\w\d]+)\)&#39;)
    match =ENCODE_RE.search(name)
    while(match):
        raw += name[lastpos : lastpos + match.start()]
        raw += binascii.unhexlify(match.groups()[0])
        lastpos += match.end()
        match = ENCODE_RE.search(name[lastpos:])
    return raw

def walk(path, target):
    for dir in os.listdir(path):
        convert(path, dir, target)

def main():
    parser = argparse.ArgumentParser(
        description=&#39;Convert moin wiki to text archieves&#39;
        )
    parser.add_argument(&#39;--input&#39;, &#39;-i&#39;,
                        help=&#39;the path of moinmoin/data/pages&#39;,
                        type=str,
                        required=True)
    parser.add_argument(&#39;--output&#39;, &#39;-o&#39;,
                        help=&#39;the path os target&#39;,
                        type=str,
                        required=True)
    args = parser.parse_args()

    walk(args.input, args.output)

if __name__ == &#39;__main__&#39;:
    main()
</code></pre><p>ä½¿ç”¨å¸®åŠ©ï¼š</p>
<pre tabindex="0"><code>usage: moin2txt.py [-h] --input INPUT --output OUTPUT

Convert moin wiki to text archieves

optional arguments:
  -h, --help            show this help message and exit
  --input INPUT, -i INPUT
                        the path of moinmoin/data/pages
  --output OUTPUT, -o OUTPUT
                        the path os target
</code></pre><p>ä½¿ç”¨èŒƒä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python moin2txt.py -i /your/moin/path/data/pages -o /your/dropbox/path/kms
</span></span></code></pre></div><p>å‘½ä»¤è¿è¡Œå®Œï¼Œå°±èƒ½åœ¨å¯¹åº”ç›®å½•ç”Ÿæˆä¸€å¨ txt æ–‡ä»¶ï¼Œæ–‡ä»¶åè¿˜æ˜¯ä¸­æ–‡çš„ï¼ŒMission complete.</p>
<p>æˆ‘å°†è¿™ä¸ªå‘½ä»¤åŠ å…¥äº† cronï¼Œæ¯å¤©æ‰§è¡Œä¸€æ¬¡ï¼Œä¿è¯ Dropbox ä¸­æ˜¯æœ€æ–°çš„ wikiã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>GAE ç¼–ç¨‹æŒ‡å—è¯»ä¹¦ç¬”è®°</title>
      <link>https://blog.alswl.com/2012/03/gae/</link>
      <pubDate>Sat, 24 Mar 2012 00:00:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2012/03/gae/</guid>
      <description>&lt;p&gt;GAE å’Œæˆ‘è›®æœ‰ç¼˜åˆ†ï¼Œæˆ‘åˆå­¦ Python çš„å…¶ä¸­ä¸€ä¸ªåŸå› å°±æ˜¯å½“æ—¶ GAE åˆšæ¨å‡ºï¼Œ å½“æ—¶æƒ³æ³•æ˜¯å…è´¹çš„åº”ç”¨è¦ç”¨èµ·æ¥ï¼Œè¦ä¸ç„¶å°±æµªè´¹äº†ã€‚éšåä¹Ÿå‡æ¨¡å‡æ ·çš„çœ‹æ–‡æ¡£ï¼Œ
å°±æ˜¯æ²¡æœ‰ä»€ä¹ˆäº§å‡ºã€‚&lt;/p&gt;
&lt;p&gt;å»å¹´å†™äº†ä¸€ä¸ªå°åº”ç”¨ &lt;a href=&#34;https://github.com/alswl/dbevent2gc&#34;&gt;dbevent2gc&lt;/a&gt; ï¼Œ æœŸé—´å‘ç° GAE
å’Œæ™®é€šç¨‹åºå¼€å‘çš„è¯¸å¤šä¸åŒï¼Œåˆé­é‡ GAE é…é¢å¤§å¹…ç¼©æ°´ï¼Œ å†™å‡ºæ¥çš„åº”ç”¨è¿è½¬çš„ä¸å¤ªç¨³å®šã€‚åœ¨å—äº¬å›¾ä¹¦é¦†çš„æ¶ä¸Šçœ‹è§è¿™æœ¬ã€ŠGAE ç¼–ç¨‹æŒ‡å—è¯»ä¹¦ç¬”è®°ã€‹ï¼Œ
ç«‹å³å€Ÿå›å®¶ä»”ç»†é˜…è¯»ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;GAE çš„ç®€ä»‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿è¡Œæ—¶ç¯å¢ƒ Python / Java&lt;/li&gt;
&lt;li&gt;æ•°æ®å­˜å‚¨ Datastoreï¼ˆå®ä½“ / æŸ¥è¯¢ / ç´¢å¼• / äº‹åŠ¡ï¼‰&lt;/li&gt;
&lt;li&gt;æœåŠ¡ï¼ˆMemcache / GAccount / ä»»åŠ¡é˜Ÿåˆ— / è®¡åˆ’ä»»åŠ¡ï¼‰&lt;/li&gt;
&lt;li&gt;å·¥å…·ï¼ˆSDK / appcfg / dev_appserver / æ§åˆ¶å°ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…¥é—¨ï¼ˆå®‰è£… / GAccount / webapp / app.yaml / /_ah/admin / æ³¨å†Œéƒ¨ç½² / login:requiredï¼‰&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>GAE å’Œæˆ‘è›®æœ‰ç¼˜åˆ†ï¼Œæˆ‘åˆå­¦ Python çš„å…¶ä¸­ä¸€ä¸ªåŸå› å°±æ˜¯å½“æ—¶ GAE åˆšæ¨å‡ºï¼Œ å½“æ—¶æƒ³æ³•æ˜¯å…è´¹çš„åº”ç”¨è¦ç”¨èµ·æ¥ï¼Œè¦ä¸ç„¶å°±æµªè´¹äº†ã€‚éšåä¹Ÿå‡æ¨¡å‡æ ·çš„çœ‹æ–‡æ¡£ï¼Œ
å°±æ˜¯æ²¡æœ‰ä»€ä¹ˆäº§å‡ºã€‚</p>
<p>å»å¹´å†™äº†ä¸€ä¸ªå°åº”ç”¨ <a href="https://github.com/alswl/dbevent2gc">dbevent2gc</a> ï¼Œ æœŸé—´å‘ç° GAE
å’Œæ™®é€šç¨‹åºå¼€å‘çš„è¯¸å¤šä¸åŒï¼Œåˆé­é‡ GAE é…é¢å¤§å¹…ç¼©æ°´ï¼Œ å†™å‡ºæ¥çš„åº”ç”¨è¿è½¬çš„ä¸å¤ªç¨³å®šã€‚åœ¨å—äº¬å›¾ä¹¦é¦†çš„æ¶ä¸Šçœ‹è§è¿™æœ¬ã€ŠGAE ç¼–ç¨‹æŒ‡å—è¯»ä¹¦ç¬”è®°ã€‹ï¼Œ
ç«‹å³å€Ÿå›å®¶ä»”ç»†é˜…è¯»ã€‚</p>
<ul>
<li>
<p>GAE çš„ç®€ä»‹</p>
<ul>
<li>è¿è¡Œæ—¶ç¯å¢ƒ Python / Java</li>
<li>æ•°æ®å­˜å‚¨ Datastoreï¼ˆå®ä½“ / æŸ¥è¯¢ / ç´¢å¼• / äº‹åŠ¡ï¼‰</li>
<li>æœåŠ¡ï¼ˆMemcache / GAccount / ä»»åŠ¡é˜Ÿåˆ— / è®¡åˆ’ä»»åŠ¡ï¼‰</li>
<li>å·¥å…·ï¼ˆSDK / appcfg / dev_appserver / æ§åˆ¶å°ï¼‰</li>
</ul>
</li>
<li>
<p>å…¥é—¨ï¼ˆå®‰è£… / GAccount / webapp / app.yaml / /_ah/admin / æ³¨å†Œéƒ¨ç½² / login:requiredï¼‰</p>
</li>
<li>
<p>å¤„ç†æµç¨‹ï¼šè¯·æ±‚ - å‰ç«¯ - å¼•ç”¨æœåŠ¡å™¨ / é™æ€æ–‡ä»¶æœåŠ¡å™¨ - æœåŠ¡</p>
<ul>
<li>é…é¢é™åˆ¶ï¼šè¯·æ±‚é™åˆ¶ / CPU é™åˆ¶ / æœåŠ¡é™åˆ¶ / éƒ¨ç½²é™åˆ¶ ï¼ˆæœ€æ–°é…é¢ï¼šhttp://code.google.com/intl/zh-CN/appengine/docs/quotas.htmlï¼‰</li>
</ul>
</li>
<li>
<p>æ•°æ®å­˜å‚¨</p>
<ul>
<li>
<p>GAE çš„æ•°æ®å­˜å‚¨æ–¹å¼å’Œä¼ ç»Ÿçš„ RDBMS å·®å¼‚æ¯”è¾ƒå¤§ï¼Œæ›´ç±»ä¼¼äºå¯¹è±¡æ•°æ®åº“ã€‚</p>
</li>
<li>
<p>ç±»åˆ« kind / é”® / é”®å key name</p>
</li>
<li>
<p>å¯ä»¥é€šè¿‡é”®æ¥è·å–å’Œæ“ä½œå¯¹è±¡</p>
<ul>
<li><code>e = db.get(db.Key('Entity', 'alphabeta'))</code> / <code>e = Entity.get(k)</code></li>
<li><code>e = db.get(k)</code></li>
<li><code>e.delete()</code> / <code>db.delete(e1, e2)</code> / <code>db.delete(k)</code></li>
</ul>
</li>
<li>
<p>Expando åŸºç±»å¯ä»¥ä»»æ„æ‰©å±•å±æ€§ï¼ŒModel åŸºç±»åˆ™ä¸å¯ã€‚</p>
</li>
<li>
<p>GAE ä¸­åŸºæœ¬ç±»å‹ä¸ Python / Java ä¸­åŸºæœ¬ç±»å‹çš„å·®å¼‚</p>
</li>
<li>
<p>å¤šå€¼å±æ€§</p>
</li>
</ul>
</li>
<li>
<p>æ•°æ®æŸ¥è¯¢</p>
<ul>
<li>æŸ¥è¯¢å’Œç±»åˆ« <code>db.query()</code> <code>query.filter()</code> <code>query.order()</code></li>
<li>æŸ¥è¯¢å’Œé”®ï¼šæŸ¥è¯¢ç»“æœè¦ä¹ˆè¿”å›å®ä½“ï¼Œè¦ä¹ˆè¿”å›é”®ï¼ˆ <code>key_only=True</code> ï¼‰</li>
<li>å¯ä»¥ç”¨ GQL å†™æŸ¥è¯¢è¯­å¥ï¼Œä¸èƒ½å†™ CUD</li>
<li>è·å–ç»“æœï¼š <code>fetch()</code></li>
</ul>
</li>
<li>
<p>ç´¢å¼•</p>
<ul>
<li>æ¯æ¡æŸ¥è¯¢éƒ½éœ€è¦ç»´æŠ¤ä¸€æ¡ç´¢å¼•ï¼Œåœ¨ <code>index.yaml</code> ä¸­å¯ä»¥é…ç½®</li>
<li>æ’åºä¹‹åçš„ç´¢å¼•æŸ¥è¯¢å¾ˆå¿«ï¼ŒæŸ¥è¯¢æ•ˆç‡å’Œè¿”å›ç»“æœé›†æœ‰å…³</li>
<li>å®ä½“çš„æ¯ä¸ªå±æ€§ä¼šè‡ªåŠ¨ç»´æŠ¤ä¸¤æ¡ç´¢å¼•ï¼šå‡åºå’Œé™åº</li>
<li>æŸ¥è¯¢æ—¶å€™é€‰å–å¯¹åº”çš„ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢ï¼Œæ¡ä»¶è¯­å¥å¯èƒ½å’Œæ’åºè¯­å¥ç›¸å†²çª</li>
<li>ä¸ç­‰äº / IN æ“ä½œç¬¦å°†å¼•å‘ä¸€ç³»åˆ—å˜æ¢å‡ºçš„æŸ¥è¯¢</li>
<li>å¤šå€¼å­—æ®µçš„ç´¢å¼•ï¼šæ¯ä¸ªå€¼ä¼šæˆä¸ºç´¢å¼•ä¸­ä¸€è¡Œ / å®ä½“ä¼šå› æ­¤åˆ†æ•£ / å–ç¬¬ä¸€æ¬¡æˆåŠŸæ‰«æåˆ°çš„è¡Œ</li>
<li>å¤šå€¼ä¼šå¼•å…¥çˆ†ç‚¸ç´¢å¼•é—®é¢˜</li>
</ul>
</li>
<li>
<p>äº‹åŠ¡</p>
<ul>
<li>é€šè¿‡å®ä½“ç»„æ¥æ§åˆ¶äº‹åŠ¡ï¼Œå®ä½“ç»„ä¼šåœ¨åŒä¸€å—å­˜å‚¨åŒº</li>
<li>GAE ä½¿ç”¨ä¹è§‚é”</li>
<li>ä½¿ç”¨ <code>AModel(parent=p)</code> æ„é€ ç¥–å…ˆï¼Œç„¶åé€šè¿‡ <code>run_in_transation()</code> å›è°ƒäº‹åŠ¡å¤„ç†å‡½æ•°</li>
<li>BigTable ä¸­ä½¿ç”¨æ—¥å¿—+æ—¶é—´æˆ³æ¥è·Ÿè¸ªå®ä½“çš„ä¿®æ”¹ï¼Œä¿è¯æ•°æ®å¹¶å‘å’Œä¸€è‡´æ€§</li>
<li>äº‹åŠ¡æ›´æ–°å’Œç´¢å¼•æ›´æ–°ï¼šå¯èƒ½è¿”å›çš„ç´¢å¼•ç»“æœå’Œå®ä½“ä¸ä¸€è‡´</li>
</ul>
</li>
<li>
<p>Python æ•°æ®å»ºæ¨¡</p>
<ul>
<li>
<p>å£°æ˜ / ç±»å‹ / éªŒè¯ï¼ˆ <code>validate()</code> ï¼‰</p>
</li>
<li>
<p>ä¸ç¼–å…¥ç´¢å¼•çš„å±æ€§ <code>indexed=False</code></p>
</li>
<li>
<p>æ—¶é—´ç±»å‹çš„è‡ªåŠ¨å€¼</p>
</li>
<li>
<p>æ¨¡å‹å˜åŒ–å¸¦æ¥çš„ç»´æŠ¤é—®é¢˜ï¼šä¿®æ”¹å±æ€§ç±»å‹ / æ·»åŠ ä¸€ä¸ªå¿…è¦å±æ€§æ˜¯ä¸å‘åå…¼å®¹çš„ã€‚</p>
</li>
<li>
<p>å…³ç³»å»ºæ¨¡</p>
<ul>
<li>db.ReferenceProperty</li>
<li>collection_name</li>
</ul>
</li>
<li>
<p>å¤šå¯¹å¤šå…³ç³»çš„å¤„ç†</p>
<ul>
<li>é”®åˆ—è¡¨æ–¹æ³•ï¼šä½¿ç”¨å¤šå€¼å±æ€§</li>
<li>é“¾æ¥æ¨¡å‹æ–¹æ³•ï¼šç›¸å½“äºä¸­é—´è¡¨æ¦‚å¿µ</li>
</ul>
</li>
<li>
<p>æ¨¡å‹çš„ç»§æ‰¿ï¼šé€šè¿‡ <code>db.PolyModel</code> å®ç°å¤šæ€æŸ¥è¯¢</p>
</li>
</ul>
</li>
<li>
<p>Memcache</p>
<ul>
<li>CRUD</li>
</ul>
</li>
<li>
<p>è·å– URL èµ„æº</p>
<ul>
<li><code>urlfetch()</code></li>
</ul>
</li>
<li>
<p>RPC å¼‚æ­¥è¯·æ±‚è°ƒç”¨ï¼Œé—­åŒ…è°ƒç”¨</p>
</li>
<li>
<p>é‚®ä»¶å’Œ XMPP</p>
<ul>
<li>é¢ï¼Œäº²ç”¨åˆ°æ—¶å€™çœ‹ Google å®˜æ–¹æ–‡æ¡£å§ï½</li>
</ul>
</li>
<li>
<p>å¤§æ‰¹é‡æ•°æ®æ“ä½œå’Œè¿œç¨‹è®¿é—®</p>
<ul>
<li><code>/remote_api</code></li>
<li>Bulk Loader å¤§é‡æ•°æ®æ“ä½œ</li>
<li>è¿œç¨‹ shell <code>remote_api_shell.py app-id</code></li>
</ul>
</li>
<li>
<p>ä»»åŠ¡é˜Ÿåˆ—å’Œè®¡åˆ’ä»»åŠ¡</p>
<ul>
<li>é˜Ÿåˆ—ï¼š <code>queue.yaml</code> / ä»¤ç‰Œæ¡¶</li>
<li>è®¡åˆ’ä»»åŠ¡ï¼š <code>cron.yaml</code></li>
<li>éƒ½æ˜¯é€šè¿‡è®¾å®šä¸»åŠ¨è§¦å‘æŸä¸ª url</li>
</ul>
</li>
<li>
<p>Django</p>
<ul>
<li>çœ‹ Django æ–‡æ¡£å§ï¼Œäº²ï½</li>
</ul>
</li>
<li>
<p>éƒ¨ç½²</p>
<ul>
<li>ä¸Šä¼  <code>appcfg.py update ./clock</code></li>
<li>é€šè¿‡ url ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬ï¼š <code>version-id.latest.app-id.appspot.com</code></li>
<li>ç‰ˆæœ¬åªç»´æŠ¤ä»£ç ï¼Œæ•°æ®åº“è¿˜æ˜¯åŒä¸€ä»½</li>
<li>ä¸‹è½½æ—¥å¿— <code>appcfg.py request_logs clock logs.txt</code></li>
</ul>
</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>åœ¨Pythonä¸­è°ƒè¯•ä»£ç </title>
      <link>https://blog.alswl.com/2012/03/python-debug/</link>
      <pubDate>Tue, 20 Mar 2012 00:00:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2012/03/python-debug/</guid>
      <description>&lt;p&gt;æ’°å†™ç¨‹åºæ—¶å€™ï¼Œéœ€è¦åœ¨è°ƒè¯•ä¸Šé¢èŠ±è´¹ä¸å°‘æ—¶é—´ï¼Œå¥½çš„è°ƒè¯•å·¥å…·å¯ä»¥è®©è¿™ä¸ªè¿‡ç¨‹å¦‚è™æ·»ç¿¼ï¼Œ é æ‰“ log è°ƒè¯•ä¼šæ˜¯ä¸€ç§å¾ˆç—›è‹¦çš„è¿‡ç¨‹ï¼Œæˆ‘æ€»ç»“ä¸€ä¸‹ Pylons
å¼€å‘çš„è°ƒè¯•æŠ€å·§ã€‚&lt;/p&gt;
&lt;p&gt;åæ§½ï¼šå›¢é˜Ÿå¼€å‘æ—¶å€™ï¼Œæ¯ä¸ªæˆå‘˜éœ€è¦å­¦ä¹ ã€æ€»ç»“å’Œåˆ†äº«å„è‡ªçš„å¼€å‘æŠ€å·§ï¼Œ è¿™æ ·æ‰èƒ½è‡ªæˆ‘æå‡å¹¶æé«˜å¼€å‘æ•ˆç‡ã€‚è¿™å±äºå›¢é˜Ÿæ–‡åŒ–å»ºè®¾ï¼Œå¼€å‘æ˜¯ä¸€ç§è‰ºæœ¯åˆ›é€ è¿‡ç¨‹ï¼Œ
ç»å¯¹ä¸æ˜¯ç®€å•çš„å¤åˆ¶å’Œç²˜å¸–ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åœ¨-python-ä¸­è°ƒè¯•&#34;&gt;åœ¨ Python ä¸­è°ƒè¯•&lt;/h2&gt;
&lt;h3 id=&#34;pdb&#34;&gt;pdb&lt;/h3&gt;
&lt;p&gt;åœ¨ä»£ç ä¸­åŠ å…¥ä¸‹åˆ—è¯­å¥å³å¯å¯ç”¨äº¤äº’å¼è°ƒè¯•ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import pdb;pdb.set_trace()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨ pdb ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;h / l / b / n / s / c / j / a / p / ! / q&lt;/code&gt; è¿™äº›å‘½ä»¤æ‰€ä»£è¡¨çš„å«ä¹‰å¯ä»¥é€šè¿‡
&lt;code&gt;h(elp)&lt;/code&gt; æ‰“å°å‡ºæ¥ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>æ’°å†™ç¨‹åºæ—¶å€™ï¼Œéœ€è¦åœ¨è°ƒè¯•ä¸Šé¢èŠ±è´¹ä¸å°‘æ—¶é—´ï¼Œå¥½çš„è°ƒè¯•å·¥å…·å¯ä»¥è®©è¿™ä¸ªè¿‡ç¨‹å¦‚è™æ·»ç¿¼ï¼Œ é æ‰“ log è°ƒè¯•ä¼šæ˜¯ä¸€ç§å¾ˆç—›è‹¦çš„è¿‡ç¨‹ï¼Œæˆ‘æ€»ç»“ä¸€ä¸‹ Pylons
å¼€å‘çš„è°ƒè¯•æŠ€å·§ã€‚</p>
<p>åæ§½ï¼šå›¢é˜Ÿå¼€å‘æ—¶å€™ï¼Œæ¯ä¸ªæˆå‘˜éœ€è¦å­¦ä¹ ã€æ€»ç»“å’Œåˆ†äº«å„è‡ªçš„å¼€å‘æŠ€å·§ï¼Œ è¿™æ ·æ‰èƒ½è‡ªæˆ‘æå‡å¹¶æé«˜å¼€å‘æ•ˆç‡ã€‚è¿™å±äºå›¢é˜Ÿæ–‡åŒ–å»ºè®¾ï¼Œå¼€å‘æ˜¯ä¸€ç§è‰ºæœ¯åˆ›é€ è¿‡ç¨‹ï¼Œ
ç»å¯¹ä¸æ˜¯ç®€å•çš„å¤åˆ¶å’Œç²˜å¸–ã€‚</p>
<h2 id="åœ¨-python-ä¸­è°ƒè¯•">åœ¨ Python ä¸­è°ƒè¯•</h2>
<h3 id="pdb">pdb</h3>
<p>åœ¨ä»£ç ä¸­åŠ å…¥ä¸‹åˆ—è¯­å¥å³å¯å¯ç”¨äº¤äº’å¼è°ƒè¯•ã€‚</p>
<pre><code>import pdb;pdb.set_trace()
</code></pre>
<p>åœ¨ pdb ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>h / l / b / n / s / c / j / a / p / ! / q</code> è¿™äº›å‘½ä»¤æ‰€ä»£è¡¨çš„å«ä¹‰å¯ä»¥é€šè¿‡
<code>h(elp)</code> æ‰“å°å‡ºæ¥ã€‚</p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<ul>
<li><a href="http://magustest.com/blog/python/use-pdb-debug-python/comment-page-1">ç”¨PDBåº“è°ƒè¯•Pythonç¨‹åº</a></li>
</ul>
<h3 id="ipdb">ipdb</h3>
<p>æ¯” pdb æ›´å¥½ç”¨çš„æ˜¯ ipdbï¼Œéœ€è¦é¢„å…ˆå®‰è£… IPythonï¼Œé€šè¿‡ IPython å¯ä»¥æä¾›æ›´å¼ºçš„äº¤äº’åŠŸèƒ½ã€‚</p>
<p>å®‰è£… ipdb: <code>easy_install ipdb</code> ï¼Œ ä½¿ç”¨æ–¹æ³•ä¾ç„¶æ˜¯ <code>import ipdb;ipdb.set_trace()</code> ã€‚</p>
<p>ps: æ ¹æ®æˆ‘çš„æµ‹è¯•ï¼Œipdb 0.61 ä¸èƒ½å’Œ ipython 0.91 æ­£å¸¸å·¥ä½œï¼Œ ä¼šæŠ¥ <code>ImportError: No module named core.debugger</code> é”™è¯¯ï¼Œè¯·å°è¯•ä½¿ç”¨ ipython 0.10 æˆ–è€…æ›´æ–°ç‰ˆæœ¬ã€‚è¿™ä¸ªé”™è¯¯åœ¨ ipdb å®˜ç½‘æœ‰ issue æè¿°
ï¼ˆ<a href="https://github.com/gotcha/ipdb/issues/9">link</a>ï¼‰ã€‚</p>
<h3 id="ä½¿ç”¨-embed-python-shell">ä½¿ç”¨ embed python shell</h3>
<p>é™¤äº†ç‰¹å®šä»£ç çš„è°ƒè¯•ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬è¿˜éœ€è¦åœ¨å¼€å‘ä¸€ä¸ªåŠŸèƒ½ä¹‹å‰è¿›è¡Œå°è¯•æ€§ä»£ç æ’°å†™ï¼Œ è¿™ç‚¹åœ¨ web å¼€å‘æ—¶å€™å°¤å…¶æœ‰ç”¨ã€‚æ‰˜ Python
åŠ¨æ€è¯­è¨€ç‰¹æ€§çš„ç¦ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„ä½¿ç”¨ Interactivate Shell è¿›è¡Œå¼€å‘ã€‚</p>
<p>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•å»ºç«‹ä¸€ä¸ª Python è„šæœ¬ï¼Œæ¯”å¦‚ <code>shell.py</code> ï¼Œå…¶ä¸­ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code>#!/usr/bin/env python
#coding=utf-8
</code></pre>
<h1 id="desc-è¿™ä¸ªshellæä¾›pythonä¸Šä¸‹æ–‡ç¯å¢ƒæ–¹ä¾¿è°ƒè¯•">desc: è¿™ä¸ªshellæä¾›Pythonä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œæ–¹ä¾¿è°ƒè¯•</h1>
<h1 id="author-alswl">author: alswl</h1>
<h1 id="date-2012-03-20">date: 2012-03-20</h1>
<p>def main():</p>
<h1 id="do-something-for-init-here">Do something for init here.</h1>
<p>try:</p>
<p>from IPython.frontend.terminal.embed import InteractiveShellEmbed</p>
<p>ipshell = InteractiveShellEmbed()</p>
<p>ipshell()</p>
<p>except ImportError:</p>
<p>import code</p>
<p>pyshell = code.InteractiveConsole(locals=locals())</p>
<p>pyshell.interact()</p>
<p>if <strong>name</strong> == &lsquo;<strong>main</strong>&rsquo;:</p>
<p>main()</p>
<p>è¿™æ®µä»£ç å…ˆå°è¯•ä½¿ç”¨ IPython ä½œä¸ºäº¤äº’ shellï¼Œå¦‚æœæ²¡æœ‰å®‰è£…å°±ä½¿ç”¨åŸç”Ÿ Python ä½œä¸º äº¤äº’ Shellã€‚(å¼ºçƒˆå»ºè®®ä½¿ç”¨ IPython)ã€‚</p>
<p>è¯·åœ¨ <code>main()</code> æ–¹æ³•å¼€å§‹æ—¶å€™åšä¸€äº›åˆå§‹åŒ–åŠ¨ä½œï¼Œæ¯”å¦‚è½½å…¥ webapp çš„å®ä¾‹å¹¶åˆå§‹åŒ–å„è·¯configï¼Œ
è¿™æ ·å°±èƒ½å®ç°å³æ—¶ä»£ç æµ‹è¯•åŠŸèƒ½ï¼Œæé«˜å¼€å‘æ•ˆç‡ï¼Œä¸ç”¨ä¸€ééåœ°è·‘æµç¨‹ã€‚</p>
<p>å‚è€ƒé“¾æ¥</p>
<ul>
<li><a href="http://qixinglu.com/archives/embed_python_shell_in_code">http://qixinglu.com/archives/embed_python_shell_in_code</a> ï¼ˆæ³¨æ„ï¼Œ è¿™ç¯‡æ–‡ç« æ˜¯2011å¹´çš„ï¼Œå…¶ä¸­å¼•å…¥ IPython çš„ <code>InteractiveShellEmbed</code> çš„æ–¹æ³•å·²ç»è¿‡æœŸï¼Œè¯·å‚è€ƒä¸Šé¢çš„ä»£ç ï¼‰</li>
</ul>
<h3 id="gae-ä¸­çš„-pdb">GAE ä¸­çš„ pdb</h3>
<p>æœ‰ä¸€äº›ç‰¹å®šç³»ç»Ÿï¼Œæ¯”å¦‚ GAE å’Œ nosetestsï¼Œä»–ä»¬ä¼šé‡å®šå‘ <code>std:in</code> å’Œ <code>std:out</code> ï¼Œ é€ æˆ pdb
æ— æ³•æ­£ç¡®è¾“å…¥å’Œè¾“å‡ºï¼Œåœ¨ä½¿ç”¨çš„ä½¿ç”¨ï¼Œéœ€è¦ç”¨ä»¥ä¸‹ä»£ç åšä¸ª hackã€‚</p>
<pre><code>import sys
import pdb
for attr in ('stdin', 'stdout', 'stderr'):
    setattr(sys, attr, getattr(sys, '__%s__' % attr))
pdb.set_trace()
</code></pre>
<h2 id="pylons-è°ƒè¯•">Pylons è°ƒè¯•</h2>
<p>Paster çš„ Shell äº¤äº’å¼è°ƒè¯•æ›´æ˜¾çŠ€åˆ©ï¼ˆå®˜æ–¹æ‰€ç§°æ€æ‰‹çº§åŠŸèƒ½ï¼‰ï¼Œ å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>paster shell dev.ini</code>
å‘½ä»¤å¯ç”¨äº¤äº’ç•Œé¢ï¼Œé»˜è®¤ä¼šå…ˆå°è¯•è½½å…¥ IPythonï¼Œä¸å­˜åœ¨å°±è½½å…¥åŸç”Ÿ Shellã€‚</p>
<p>æˆ‘å½“å‰ä½¿ç”¨çš„ Paster ç‰ˆæœ¬ä¸º 1.7.5,æ— æ³•æ­£ç¡®è¯† IPython 0.11åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œ è¯·ä½¿ç”¨0.9.1æˆ–è€…0.10ã€‚</p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<ul>
<li><a href="http://wiki.pylonshq.com/pages/viewpage.action?pageId=9011323">How can I use &ldquo;paster shell&rdquo; to develop doctest tests?</a></li>
<li><a href="http://stackoverflow.com/questions/7389388/pylons-paster-shell-does-not-run-in-ipython">stackoverflow ä¸Šå…³äº IPython ç‰ˆæœ¬çš„é—®é¢˜</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>ç»™MoinMoinå†™æ’ä»¶</title>
      <link>https://blog.alswl.com/2012/02/the-write-the-plugins-for-moinmoin/</link>
      <pubDate>Fri, 10 Feb 2012 00:00:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2012/02/the-write-the-plugins-for-moinmoin/</guid>
      <description>&lt;h2 id=&#34;1-ä½¿ç”¨-moinmoin&#34;&gt;1. ä½¿ç”¨ MoinMoin&lt;/h2&gt;
&lt;p&gt;å‰äº›æ—¥å­ï¼Œæˆ‘å†™äº†ä¸€ç¯‡&lt;a href=&#34;../2011/12/moinmoin-kms&#34;&gt;ä½¿ç”¨MoinMoinä½œä¸ºä¸ªäººKMS&lt;/a&gt;
å¤§èµMoinMoinçš„å„ç§å¥½å¤„ã€‚MoinMoinçš„å…¶ä¸­ä¸€ä¸ªå¥½å¤„æ˜¯åŸºäºGPLçš„å¼€æºï¼Œ
æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„ç»™MoinMoinæ’°å†™è‡ªå·±çš„æ’ä»¶ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥å»å®˜æ–¹çš„wikiä¸Šè·å–å¤§é‡ç°æˆæ’ä»¶ï¼‰ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://moinmo.in/MoinDev&#34;&gt;MoinMoinå¼€å‘è€…wikiåœ°å€&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://docs.moinmo.in/&#34;&gt;MoinMoinå¼€å‘APIæ–‡æ¡£ï¼ˆè¿™ä¸ªå®˜æ–¹wikiå±…ç„¶å¾ˆå°‘æåŠï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://moinmo.in/MoinDev/Translation&#34;&gt;MoinMoinçš„å¤šå›½è¯­ç¿»è¯‘ç»„wikiåœ°å€&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘åœ¨ä½¿ç”¨MoinMoinè¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ä¸ªæ€¥è¿«éœ€è¦çš„åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¿å­˜ä¸€ç¯‡ç½‘é¡µæ—¶å€™ï¼Œè¦å°†é‡Œé¢çš„å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å¤–é“¾æ¥æ–¹å¼ä¿å­˜ï¼Œ å› ä¸ºç”±äºå„ç§ä¸å¯é¢„æµ‹çš„åŸå› ï¼ŒåŸå§‹å›¾ç‰‡æ•°æ®å¾ˆæœ‰å¯èƒ½ä¸¢å¤±æˆ–è€…æ— æ³•è¿æ¥ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸ªåŠŸèƒ½å¯¹äºå°†Wikiäº§å“è½¬åŒ–ä¸ºKMSåº”ç”¨éå¸¸éœ€è¦ï¼Œå¯æƒœMoinMoinå®˜æ–¹å¹¶æ²¡æœ‰æä¾›ï¼Œ
æˆ‘ä¹Ÿæ²¡åœ¨MoinMoinçš„å¼€å‘è€…æ’ä»¶åº“ä¸­æ‰¾åˆ°ç±»ä¼¼åŠŸèƒ½ï¼Œå°±è‡ªå·±å†™äº†ä¸€ä¸ªæ’ä»¶image2attachã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<h2 id="1-ä½¿ç”¨-moinmoin">1. ä½¿ç”¨ MoinMoin</h2>
<p>å‰äº›æ—¥å­ï¼Œæˆ‘å†™äº†ä¸€ç¯‡<a href="../2011/12/moinmoin-kms">ä½¿ç”¨MoinMoinä½œä¸ºä¸ªäººKMS</a>
å¤§èµMoinMoinçš„å„ç§å¥½å¤„ã€‚MoinMoinçš„å…¶ä¸­ä¸€ä¸ªå¥½å¤„æ˜¯åŸºäºGPLçš„å¼€æºï¼Œ
æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„ç»™MoinMoinæ’°å†™è‡ªå·±çš„æ’ä»¶ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥å»å®˜æ–¹çš„wikiä¸Šè·å–å¤§é‡ç°æˆæ’ä»¶ï¼‰ã€‚</p>
<ul>
<li><a href="http://moinmo.in/MoinDev">MoinMoinå¼€å‘è€…wikiåœ°å€</a></li>
<li><a href="http://docs.moinmo.in/">MoinMoinå¼€å‘APIæ–‡æ¡£ï¼ˆè¿™ä¸ªå®˜æ–¹wikiå±…ç„¶å¾ˆå°‘æåŠï¼‰</a></li>
<li><a href="http://moinmo.in/MoinDev/Translation">MoinMoinçš„å¤šå›½è¯­ç¿»è¯‘ç»„wikiåœ°å€</a></li>
</ul>
<p>æˆ‘åœ¨ä½¿ç”¨MoinMoinè¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ä¸ªæ€¥è¿«éœ€è¦çš„åŠŸèƒ½ï¼š</p>
<blockquote>
<p>ä¿å­˜ä¸€ç¯‡ç½‘é¡µæ—¶å€™ï¼Œè¦å°†é‡Œé¢çš„å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å¤–é“¾æ¥æ–¹å¼ä¿å­˜ï¼Œ å› ä¸ºç”±äºå„ç§ä¸å¯é¢„æµ‹çš„åŸå› ï¼ŒåŸå§‹å›¾ç‰‡æ•°æ®å¾ˆæœ‰å¯èƒ½ä¸¢å¤±æˆ–è€…æ— æ³•è¿æ¥ã€‚</p></blockquote>
<p>è¿™ä¸ªåŠŸèƒ½å¯¹äºå°†Wikiäº§å“è½¬åŒ–ä¸ºKMSåº”ç”¨éå¸¸éœ€è¦ï¼Œå¯æƒœMoinMoinå®˜æ–¹å¹¶æ²¡æœ‰æä¾›ï¼Œ
æˆ‘ä¹Ÿæ²¡åœ¨MoinMoinçš„å¼€å‘è€…æ’ä»¶åº“ä¸­æ‰¾åˆ°ç±»ä¼¼åŠŸèƒ½ï¼Œå°±è‡ªå·±å†™äº†ä¸€ä¸ªæ’ä»¶image2attachã€‚</p>
<ul>
<li><a href="http://moinmo.in/MoinMoinExtensions">MoinMoinæ’ä»¶åº“</a></li>
<li><a href="http://moinmo.in/ActionMarket/Image2Attach">image2attachåœ¨MoinMoinå®˜æ–¹Wikiçš„åœ°å€</a></li>
</ul>
<p>ç°åœ¨æˆ‘åˆ†äº«ä¸€ä¸‹å¦‚ä½•å†™MoinMoinæ’ä»¶ï¼ŒæŠ€æœ¯å¤§ç‰›å¯ä»¥ç›´æ¥ç§»æ­¥å®˜æ–¹å¼€å‘æ–‡æ¡£ï¼Œ æˆ‘è¿™é‡Œåªæ˜¯å†™ä¸€äº›ç®€å•çš„å†…å®¹ï¼Œå¸®åŠ©åƒæˆ‘ä¸€æ ·çš„åŒå­¦ã€‚</p>
<p>ä»¥ä¸‹å†…å®¹éœ€è¦Pythonç¼–ç¨‹åŸºç¡€ï½</p>
<h2 id="2-moinmoin-ç³»ç»Ÿç»“æ„">2. MoinMoin ç³»ç»Ÿç»“æ„</h2>
<p>MoinMoinçš„UMLå›¾ï¼š</p>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201202/MoinMoinArchitecture.png" alt="MoinMoin"  />


</p>
<h2 id="3-moinmoin-å¸¸ç”¨å¯¹è±¡">3. MoinMoin å¸¸ç”¨å¯¹è±¡</h2>
<h3 id="31-request">3.1. request</h3>
<p>è¿™ä¸ªrequestå’Œæ™®é€šjsp/aspä¸­requestå¾ˆç±»ä¼¼ï¼ˆå®é™…ä¸Šè¿™ä¸ªrequestå°±æ˜¯ç»§æ‰¿
<a href="http://werkzeug.pocoo.org/">werkzeug</a>çš„Requestï¼‰ã€‚</p>
<p>é™¤äº†æ­£å¸¸çš„web requeståŠŸèƒ½ï¼ŒMoinçš„requestè¿˜å¸¦äº†Wikiè‡ªèº«çš„ä¿¡æ¯ã€‚</p>
<ul>
<li>request.getText # å¤šå›½è¯­å‡½æ•°ï¼Œç»å¸¸ä½¿ç”¨ <code>_ = request.getText</code> æ¥ç®€åŒ–ä»£ç </li>
<li>request.dicts # è·å–å®šä¹‰åœ¨é¡µé¢ä¸­çš„Dictï¼Œå‚è§http://moinmo.in/HelpOnDictionaries</li>
<li>request.groups # è·å–æƒé™ç®¡ç†ä¸­çš„ç»„åˆ«</li>
<li>request.user.may # æ£€æŸ¥ç”¨æˆ·æƒé™</li>
</ul>
<h3 id="32-page">3.2. Page</h3>
<p>Pageæ˜¯æœ€å¸¸è§çš„ç±»ï¼Œå®ƒä»£è¡¨æŸä¸ªWikié¡µé¢ï¼Œé€šè¿‡å®ƒå¯ä»¥è·å–æŸä¸ªé¡µé¢æ‰€æœ‰ä¿¡æ¯ã€‚ ageæœ¬èº«æ˜¯åªè¯»çš„ï¼Œå¦‚æœéœ€è¦ç¼–è¾‘éœ€è¦ä½¿ç”¨PageEditorã€‚</p>
<ul>
<li>Page.exists() # æ˜¯å¦å­˜åœ¨</li>
<li>Page.getRevList() # ç‰ˆæœ¬åˆ—è¡¨</li>
<li>Page.current_rev() # å½“å‰ç‰ˆæœ¬</li>
<li>Page.getPagePath() # å­˜å‚¨è·¯å¾„</li>
<li>Page.get_raw_body() # è·å–å­˜å‚¨çš„æ•°æ®</li>
<li>Page.send_page() # å‘é€æ ¼å¼åŒ–å¥½é¡µé¢</li>
</ul>
<h3 id="33-pageeditor">3.3. PageEditor</h3>
<p>ä¸Šé¢è¯´åˆ°Pageæ˜¯åªè¯»çš„ï¼Œé‚£å½“æˆ‘ä»¬éœ€è¦ç¼–è¾‘é¡µé¢æ—¶å€™ï¼Œå°±è¦ç”¨åˆ°PageEditorç±»äº†ã€‚</p>
<ul>
<li>PageEditor.saveText() # ä¿å­˜å†…å®¹</li>
<li>PageEditor.deletePage() # åˆ é™¤é¡µé¢</li>
</ul>
<h3 id="34-attachfile">3.4. AttachFile</h3>
<p>é¡¾åæ€ä¹‰ï¼ŒAttachFileç”¨æ¥ç®¡ç†é¡µé¢é™„ä»¶ã€‚</p>
<ul>
<li>AttachFile.exists() # æ£€æŸ¥é™„ä»¶æ˜¯å¦å­˜åœ¨</li>
<li>AttachFile.getAttachDir() # è·å–é™„ä»¶å­˜æ”¾çš„æœ¬åœ°ç›®å½•</li>
<li>AttachFile.getAttachUrl() # è·å–é™„ä»¶url</li>
</ul>
<h3 id="35-wikiutil">3.5. wikiutil</h3>
<p>wikiutil æ˜¯MoinMoinæä¾›çš„ä¸€ä¸ªå¸®åŠ©ç±»ï¼ŒåŒ…å«ä¸€äº›å¸¸ç”¨çš„å°åŠŸèƒ½ã€‚</p>
<ul>
<li>wikiutil.escape() # htmlè½¬ä¹‰</li>
<li>wikiutil.createTicket() # ç”Ÿæˆä¸€ä¸²å”¯ä¸€keyï¼Œç”¨æ¥é¡µé¢éªŒè¯</li>
<li>wikiutil.checkTicket() # æ£€æŸ¥ticket</li>
<li>wikiutil.invoke_extension_function() # æ³¨å…¥è„šæœ¬ç±»æ’ä»¶</li>
<li>wikiutil.version2timestamp() # å°†MoinMoinæ—¶é—´è½¬æ¢æˆUNIXæ—¶é—´æˆ³</li>
<li>wikiutil.timestamp2version() # å‚è€ƒæ¥¼ä¸Š</li>
<li>wikiutil.renderText() # å°†wiki textè½¬æ¢æˆhtmlæ¥å±•ç°</li>
</ul>
<h3 id="36-user">3.6. user</h3>
<p>ç”¨æˆ·ç±»ï¼ŒCRUDæ“ä½œï¼Œä¸è§£é‡Šã€‚</p>
<h3 id="37-formatter">3.7. formatter</h3>
<p>formatterå°†è¾“å‡ºå±•ç°ç±»ï¼Œå°†wiki textè½¬æ¢ä¸ºå„ç§é¢„å®šä¹‰çš„æ ¼å¼ã€‚ éœ€è¦å’Œparseré…åˆä½¿ç”¨ï¼ˆä¸¤è€…å…³ç³»çœ‹ä¸Šå»åƒæŠ½è±¡å·¥å‚æ¨¡å¼ï¼‰ã€‚</p>
<ul>
<li>formatter.text() # æ ¼å¼åŒ–ä¸ºæ™®é€šæ–‡æœ¬</li>
<li>formatter.img() # æ ¼å¼åŒ–ä¸ºå›¾ç‰‡</li>
<li>formatter.number_list() # æ ¼å¼åŒ–ä¸ºæœ‰åºåˆ—è¡¨</li>
<li>formatter.bullet_list() # æ ¼å¼åŒ–ä¸ºæ— åºåˆ—è¡¨</li>
<li>formatter.listitem() # æ ¼å¼åŒ–ä¸ºåˆ—è¡¨é¡¹</li>
</ul>
<h3 id="38-parser">3.8. parser</h3>
<p>formatterå®Œæˆçš„å·¥ä½œæ˜¯å±•ç°è§£æåçš„wikiå†…å®¹ï¼Œè€Œè´Ÿè´£è§£æçš„å°±æ˜¯parseräº†ã€‚</p>
<p>æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code>wiki -&gt; parser -&gt; formatter
</code></pre>
<p>æ¯ä¸€ä¸ªparseréƒ½å¯¹åº”ä¸€ä¸ªæˆ–è€…å¤šä¸ªformatterã€‚ç³»ç»Ÿå†…ç½®çš„ parser/formatter æœ‰ï¼š</p>
<ul>
<li>docbook</li>
<li>html</li>
<li>plain</li>
<li>python</li>
<li>rst</li>
<li>cvs</li>
</ul>
<h2 id="4-moinmoin-è¿è¡Œæµç¨‹">4. MoinMoin è¿è¡Œæµç¨‹</h2>
<ol>
<li>cgi.py</li>
<li>é€šè¿‡urlè·å–pagenameå’Œactionï¼Œç„¶åè°ƒç”¨å¯¹åº”çš„Pageæ–¹æ³•å’ŒActionå¯¹è±¡</li>
</ol>
<pre><code>1. Page().send_page()åˆ›å»ºæ™®é€šé¡µé¢
2. MoinMoin.action.getHandler()ç”¨æ¥è·å–å¯¹åº”action
</code></pre>
<h2 id="5-moinmoin-å¼€å‘é…ç½®">5. MoinMoin å¼€å‘é…ç½®</h2>
<h3 id="51-ç¦ç”¨pycç¼“å­˜">5.1. ç¦ç”¨pycç¼“å­˜</h3>
<p>MoinMoin ä¸ºäº†æé«˜ç³»ç»Ÿæ•ˆç‡ï¼Œä¼šä¸º python æ–‡ä»¶ç”Ÿæˆpycç¼“å­˜ï¼Œå¦‚æœæ”¾ä»»å®ƒä»¬çš„è¯ã€‚
æ¯æ¬¡ä¿®æ”¹pythonæºç æ•ˆæœéƒ½å¾—ä¸åˆ°ç«‹å³ä½“ç°ã€‚æ‰€ä»¥æˆ‘ä»¬è¦åœ¨å¼€å‘é˜¶æ®µç¦ç”¨ç³»ç»Ÿç¼“å­˜ã€‚</p>
<p>åœ¨æ–‡ä»¶ <code>/usr/lib/python2.7/site-packages/MoinMoin/config/multiconfig.py</code>
çš„ç¬¬815è¡Œå·¦å³ï¼Œä¿®æ”¹ <code>options_no_group_name</code> ä¸­çš„ <code>cache</code> æ—¶é—´ã€‚</p>
<p>å½“æ”¹ä¸º0æ—¶å€™ï¼Œå°±ä¸ä½¿ç”¨ <code>pyc</code> ç¼“å­˜ï¼Œè¿™æ ·å°±ä¸ç”¨é‡å¯æœåŠ¡å™¨æ¥æ¸…æ¥šç¼“å­˜äº†ã€‚</p>
<pre><code>options_no_group_name = {
        # ...
        #'cache': (600, 30), # cache action is very cheap/efficient
        'cache': (0, 0), # cache action is very cheap/efficient #XXX alswl
        # ...
}
</code></pre>
<h2 id="6-image2attach-èŒƒä¾‹">6. image2attach èŒƒä¾‹</h2>
<p>image2attachè¿™ä¸ªæ’ä»¶åŠŸèƒ½å¾ˆç®€å•ï¼Œå°±æ˜¯è¯»å–wikiæ–‡æœ¬å†…å®¹ï¼Œæ‰¾å‡ºæ‰€æœ‰å›¾ç‰‡ï¼Œ
ç„¶ä¼šå°†è¿™äº›å›¾ç‰‡ä»äº’è”ç½‘ä¸Šä¸‹è½½åˆ°æœ¬åœ°ï¼Œå¹¶å°†æ–‡ä¸­çš„å›¾ç‰‡é“¾æ¥æ”¹ä¸ºMoinMoinçš„é™„ä»¶é“¾æ¥ã€‚</p>
<h3 id="61-åˆ›å»ºæ’ä»¶æ–‡ä»¶">6.1. åˆ›å»ºæ’ä»¶æ–‡ä»¶</h3>
<p>åœ¨ <code>data/plugin/action/</code> ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶Image2Attach.pyã€‚
ï¼ˆè¯·ä½¿ç”¨å¤§å†™æ–‡ä»¶ï¼ŒMoinä¼šè‡ªåŠ¨è¯†åˆ«å¤§å†™å¼€å¤´çš„Pythonæ–‡ä»¶ä¸ºæ’ä»¶ï¼‰</p>
<h3 id="62-åŸºæœ¬æ¡†æ¶">6.2. åŸºæœ¬æ¡†æ¶</h3>
<ol>
<li><code>execute()</code> ï¼šhookå‡½æ•°ï¼Œç”¨æ¥ç»™ä¸Šå±‚è°ƒç”¨ï¼Œç­¾åå¿…é¡»æ˜¯ <code>def execute(pagename, request)</code></li>
<li><code>Class Image2Attach</code> ï¼šä¸»è¦ç±»ï¼Œå¤„ç†é€»è¾‘ã€‚</li>
</ol>
<pre><code>1. `process() / process_line()` ï¼šå¤„ç†æ¯è¡Œwiki textï¼Œä¼šæŠ“å–&lt;a&gt;å’Œ&lt;img&gt;
2. `process_transclude() / process_link()` ï¼šåˆ†åˆ«å¤„ç†&lt;a&gt; / &lt;img&gt;
3. `fetch_image()` ï¼šä¸‹è½½å›¾ç‰‡
4. `add_attachment()` ï¼šå°†å›¾ç‰‡ä½œä¸ºé™„ä»¶åŠ å…¥åˆ°wiki
5. `write_file()` ï¼šå†™å…¥wiki text
</code></pre>
<p>æ€»çš„æ¥è¯´ï¼Œå¼€å‘Moinæ’ä»¶è¿˜æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ï¼Œå®˜æ–¹æä¾›äº†è¯¦å°½ï¼ˆä½†ä¸å¤Ÿé¡ºç•…ï¼‰çš„æ•™ç¨‹å’Œ
<a href="http://docs.moinmo.in/moin/1.9/">APIæ–‡æ¡£</a>ã€‚ æˆ‘å¤§éƒ¨åˆ†æ—¶é—´åœ¨çœ‹Moinçš„APIæ–‡æ¡£ï¼Œ
Moinä½œä¸ºä¸€æ¬¾ä¹…ç»è€ƒç ”çš„Wikiç³»ç»Ÿï¼Œå¼€æ”¾çš„ä»£ç ä¹Ÿæœ‰å¾ˆå¤šåœ°æ–¹å¯ä»¥å­¦ä¹ ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>baidu tingä¸‹è½½éŸ³ä¹è„šæœ¬</title>
      <link>https://blog.alswl.com/2012/01/tingdownload/</link>
      <pubDate>Tue, 03 Jan 2012 00:00:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2012/01/tingdownload/</guid>
      <description>&lt;p&gt;åº¦å¨˜ç»ˆäºå¹²äº†ä¸€ä»¶å¥½äº‹ï¼Œ&lt;a href=&#34;http://ting.baidu.com&#34;&gt;Baidu Ting&lt;/a&gt;ä¸Šçº¿äº†ï¼Œ
æ­£ç‰ˆéŸ³ä¹å…è´¹ä¸‹è½½ï¼Œç±»ä¼¼äº&lt;a href=&#34;http://www.google.cn/music&#34;&gt;è°·æ­ŒéŸ³ä¹&lt;/a&gt;ã€‚ å…³äºéŸ³ä¹ç‰ˆæƒå’Œå…è´¹çš„é—®é¢˜ï¼Œ æœ‰å¾ˆå¤šé—®é¢˜éœ€è¦å–è®¨è®ºï¼Œ
æ¯”å¦‚è¯´è¿™ç§å•†ä¸šæ¨¡å¼æ˜¯å¦å¯¹ä¼ ç»Ÿå”±ç‰‡ä¸šäº§ç”Ÿå†²å‡»åˆæˆ–æ˜¯æœ‰ç§¯æå½±å“ï¼Ÿ ä½œä¸ºæ™®é€šæ¶ˆè´¹è€…ï¼Œæš‚æ—¶ä¸ç”¨è€ƒè™‘è¿™äº›é—®é¢˜ï¼Œå…ˆäº«å—è¿™äº›æœåŠ¡å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;Baidu Tingçš„éŸ³ä¹è´¨é‡æ˜¯128KBpsï¼ŒéŸ³è´¨ç®—å¥½ï¼Œé‡Œé¢çš„idv3ä¿¡æ¯ä¹Ÿå‹‰å¼ºå¯ä»¥ï¼Œæœ‰:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ­Œå&lt;/li&gt;
&lt;li&gt;æ­Œæ‰‹&lt;/li&gt;
&lt;li&gt;éƒ¨åˆ†ä¸“è¾‘åï¼ˆå¶å°”ä¹Ÿå‡ºç°&amp;quot;201-8æœˆæ–°æ­Œå¿«é€’&amp;quot;è¿™ç§æ¯”è¾ƒå±±å¯¨çš„å­—ï¼‰&lt;/li&gt;
&lt;li&gt;éƒ¨åˆ†å”±ç‰‡å°é¢å›¾ç‰‡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è™½ç„¶æ¯”ä¸ä¸Šè°·æ­ŒéŸ³ä¹è¿æ­Œæ›²é£æ ¼éƒ½å‡†å¤‡å¥½äº†ï¼Œä½†æ˜¯æ¯”æ‚ä¹±æ— ç« çš„é‚£äº›éŸ³ä¹mp3è¦å¥½å¤ªå¤šäº†ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>åº¦å¨˜ç»ˆäºå¹²äº†ä¸€ä»¶å¥½äº‹ï¼Œ<a href="http://ting.baidu.com">Baidu Ting</a>ä¸Šçº¿äº†ï¼Œ
æ­£ç‰ˆéŸ³ä¹å…è´¹ä¸‹è½½ï¼Œç±»ä¼¼äº<a href="http://www.google.cn/music">è°·æ­ŒéŸ³ä¹</a>ã€‚ å…³äºéŸ³ä¹ç‰ˆæƒå’Œå…è´¹çš„é—®é¢˜ï¼Œ æœ‰å¾ˆå¤šé—®é¢˜éœ€è¦å–è®¨è®ºï¼Œ
æ¯”å¦‚è¯´è¿™ç§å•†ä¸šæ¨¡å¼æ˜¯å¦å¯¹ä¼ ç»Ÿå”±ç‰‡ä¸šäº§ç”Ÿå†²å‡»åˆæˆ–æ˜¯æœ‰ç§¯æå½±å“ï¼Ÿ ä½œä¸ºæ™®é€šæ¶ˆè´¹è€…ï¼Œæš‚æ—¶ä¸ç”¨è€ƒè™‘è¿™äº›é—®é¢˜ï¼Œå…ˆäº«å—è¿™äº›æœåŠ¡å¥½äº†ã€‚</p>
<p>Baidu Tingçš„éŸ³ä¹è´¨é‡æ˜¯128KBpsï¼ŒéŸ³è´¨ç®—å¥½ï¼Œé‡Œé¢çš„idv3ä¿¡æ¯ä¹Ÿå‹‰å¼ºå¯ä»¥ï¼Œæœ‰:</p>
<ul>
<li>æ­Œå</li>
<li>æ­Œæ‰‹</li>
<li>éƒ¨åˆ†ä¸“è¾‘åï¼ˆå¶å°”ä¹Ÿå‡ºç°&quot;201-8æœˆæ–°æ­Œå¿«é€’&quot;è¿™ç§æ¯”è¾ƒå±±å¯¨çš„å­—ï¼‰</li>
<li>éƒ¨åˆ†å”±ç‰‡å°é¢å›¾ç‰‡</li>
</ul>
<p>è™½ç„¶æ¯”ä¸ä¸Šè°·æ­ŒéŸ³ä¹è¿æ­Œæ›²é£æ ¼éƒ½å‡†å¤‡å¥½äº†ï¼Œä½†æ˜¯æ¯”æ‚ä¹±æ— ç« çš„é‚£äº›éŸ³ä¹mp3è¦å¥½å¤ªå¤šäº†ã€‚</p>
<h2 id="è‡ªåŠ¨ä¸‹è½½è„šæœ¬tingdownload">è‡ªåŠ¨ä¸‹è½½è„šæœ¬tingdownload</h2>
<p>æ—©ä¸Šä¸‹äº†å‡ é¦–éŸ³ä¹ï¼Œå°±é¡ºæ‰‹å†™äº†ä¸€ä¸ªè„šæœ¬ï¼Œç”¨æ¥æ‰¹é‡ä»Badu Tingä¸‹è½½éŸ³ä¹ã€‚</p>
<p>ä»£ç åœ¨<a href="https://github.com/alswl/tingdownload">github-tingdownload</a></p>
<h2 id="éœ€è¦">éœ€è¦</h2>
<ul>
<li>Python 2 (ä»…åœ¨Python2.7ä¸‹æµ‹è¯•)</li>
<li>BeautifulSoup(å·²åŒ…å«åœ¨ç›®å½•ä¸‹)</li>
<li>simplejsonï¼ˆå·²åŒ…å«åœ¨ç›®å½•ä¸‹)</li>
<li>ä¸€ç‚¹ç‚¹PythonåŸºç¡€</li>
<li>Linux/Windowsï¼ˆæˆ‘åœ¨Linuxæ²¡é—®é¢˜ï¼ŒWindowsåº”è¯¥ä¹Ÿå¯ä»¥ï¼‰</li>
</ul>
<h2 id="ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•</h2>
<p>åœ¨Shell(å‘½ä»¤è¡Œ)é‡Œè¾“å…¥ä¸‹é¢éšä¾¿ä¸€ä¸ªå‘½ä»¤ï¼Œå°±ä¼šåœ¨å½“å‰ç›®å½•ä¸‹é¢å‡ºç° <code>musics</code> æ–‡ä»¶å¤¹ï¼Œ é‡Œé¢å°±æœ‰ä¸‹è½½å¥½çš„éŸ³ä¹ã€‚</p>
<pre><code># ä½¿ç”¨è¯´æ˜
usage: tingdownload.py [-h] [--input INPUT] [Keyword [Keyword ...]]
</code></pre>
<p>A script to download music from ting.baidu.com.</p>
<p>positional arguments:</p>
<p>Keyword</p>
<p>optional arguments:</p>
<p>-h, &ndash;help show this help message and exit<br />
&ndash;input INPUT, -i INPUT<br />
a list file to input musics</p>
<pre><code># ç¤ºä¾‹
python tingdownload.py è€ç”·å­© #å•ä¸ªæ–‡ä»¶ä¸‹è½½
./tingdownload.py è€ç”·å­© #å•ä¸ªæ–‡ä»¶ä¸‹è½½ï¼ˆç»™pythonæ–‡ä»¶åŠ ä¸Šå¯æ‰§è¡Œæƒé™ï¼‰
python tingdownload.py è€ç”·å­© Raise\n Me\n Up # å¤šæ–‡ä»¶åï¼Œå¦‚æœæœ‰ç©ºæ ¼ï¼Œè¯·è®°å¾—åŠ ä¸Šç©ºæ ¼åè½¬'\n'
</code></pre>
<p>æ‰¹é‡ä¸‹è½½çš„è¯ï¼Œå¯ä»¥å‡†å¤‡ä¸€ä¸ªåˆ—è¡¨æ–‡ä»¶ï¼Œæ¯ä¸ªæ­Œæ›²åç”¨å›è½¦éš”å¼€ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code>è¿˜è¿‡å¾—å»
ä¸æ•¢å¤ªå¹¸ç¦
å°æƒ…æ­Œ
çˆ±æƒ…é ä¸ä½
æˆ‘çˆ±æˆ‘
ä½ å¯ä»¥ä¸ç”¨ç»™æˆ‘ç­”æ¡ˆ     é‡‘è
æ²¡æœ‰è¿™é¦–æ­Œ         åå¼¦
        å›ä¸å»äº†å—         è§äºšè½©
        æœ‰äº›äº‹ç°åœ¨ä¸åš ä¸€è¾ˆå­éƒ½ä¸ä¼šåšäº†  äº”æœˆå¤©
        ç¬¬ä¸€å¤«äºº    å¼ æ°
</code></pre>
<p>å°†è¿™ä¸ªlistæ–‡ä»¶ä½œä¸ºè¾“å…¥ä¼ å…¥æ‰§è¡Œè„šæœ¬ï¼š</p>
<pre><code>python2.7 tingdownload.py --input ~/music.txt
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œåˆ—å‡ºå››ç§æƒ…å†µï¼š</p>
<ul>
<li>
<p>ä¸‹è½½æˆåŠŸï¼Œå¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œä¼šè·³è¿‡</p>
</li>
<li>
<p>ä¸‹è½½å¤±è´¥ï¼Œç”±äºç½‘ç»œåŸå› </p>
</li>
<li>
<p>ä¸‹è½½å¤±è´¥ï¼Œç”±äºå…³é”®è¯ä¸å‡†ç¡®è€Œå‡ºç°å¤ªå¤šç»“æœ</p>
</li>
<li>
<p>ä¸‹è½½å¤±è´¥ï¼Œæ²¡æœ‰å…³é”®è¯åŒ¹é…çš„ç»“æœ</p>
<p>â–ˆâ–“â–’â–‘alswl@x201â–ˆâ–“â–’â–‘ ~/dev/project/python/tingdownload/ ./tingdownload.py é»„æ˜\ å‘¨ä¼ é›„ è€ƒè¯•ä»€ä¹ˆ &ndash;input ~/a.txt</p>
<blockquote>
<p>Start download é»„æ˜ å‘¨ä¼ é›„&hellip;</p></blockquote>
<h1 id="info-file-homealswldevprojectpythontingdownloadmusicså‘¨ä¼ é›„-é»„æ˜mp3-exists">Info: File &ldquo;/home/alswl/dev/project/python/tingdownload/musics/å‘¨ä¼ é›„-é»„æ˜.mp3&rdquo; exists.</h1>
<blockquote>
<p>Start download è€ƒè¯•ä»€ä¹ˆ&hellip;</p></blockquote>
<h1 id="info-file-homealswldevprojectpythontingdownloadmusicså¾è‰¯-è€ƒè¯•ä»€ä¹ˆçš„å»æ­»å§mp3-exists">Info: File &ldquo;/home/alswl/dev/project/python/tingdownload/musics/å¾è‰¯-è€ƒè¯•ä»€ä¹ˆçš„å»æ­»å§.mp3&rdquo; exists.</h1>
<blockquote>
<p>Start download è¿˜è¿‡å¾—å»&hellip;</p></blockquote>
</li>
</ul>
<blockquote>
<p>Start download ä¸æ•¢å¤ªå¹¸ç¦&hellip;</p></blockquote>
<blockquote>
<p>Start download å°æƒ…æ­Œ&hellip;</p></blockquote>
<h1 id="failed-too-more-result-found-for-keyword-å°æƒ…æ­Œ">Failed: Too more result found for keyword å°æƒ…æ­Œ.</h1>
<blockquote>
<p>Start download çˆ±æƒ…é ä¸ä½&hellip;</p></blockquote>
<p>== Download success (4) ==</p>
<p>é»„æ˜ å‘¨ä¼ é›„</p>
<p>è€ƒè¯•ä»€ä¹ˆ</p>
<p>è¿˜è¿‡å¾—å»</p>
<p>ä¸æ•¢å¤ªå¹¸ç¦</p>
<p>== Download failed for too many result (1) ==</p>
<p>å°æƒ…æ­Œ</p>
<p>Enjoy it.</p>
]]></content:encoded>
    </item>
    <item>
      <title>MoinMoin plugin: image2attach</title>
      <link>https://blog.alswl.com/2011/12/moinmoin-plugin-image2attach/</link>
      <pubDate>Sun, 18 Dec 2011 00:00:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2011/12/moinmoin-plugin-image2attach/</guid>
      <description>&lt;p&gt;




&lt;img loading=&#34;lazy&#34; src=&#34;https://blog.alswl.com/images/upload_dropbox/201112/moinmoin.png&#34; alt=&#34;MoinMoin&#34;  /&gt;


&lt;/p&gt;
&lt;h2 id=&#34;whats-this&#34;&gt;What&amp;rsquo;s this&lt;/h2&gt;
&lt;p&gt;Image2Attach is a extension for &lt;a href=&#34;http://moinmo.in&#34;&gt;MoinMoin&lt;/a&gt;.
It can create a page action to save images from web to page&amp;rsquo;s attachments.&lt;/p&gt;
&lt;h2 id=&#34;requirment&#34;&gt;Requirment&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;MoinMoin 1.9 (I only test in this version.)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;install&#34;&gt;Install&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;copy action/Image2Attach.py to data/plugin/action/&lt;/li&gt;
&lt;li&gt;restart python server&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;usage&#34;&gt;Usage&lt;/h2&gt;
&lt;p&gt;Go into a page, click &lt;code&gt;more action&lt;/code&gt; - &lt;code&gt;Image2Attach&lt;/code&gt; .
It will take a while to fetch the images,
after that it will save the image to attachments and replace the
image&amp;rsquo;s link with attachment&amp;rsquo;s link.
Finnally it will commit a change with message
&lt;code&gt;internet image save to attachment&lt;/code&gt; to wiki.&lt;/p&gt;
&lt;p&gt;Enjoy it, any bugs can report to
&lt;a href=&#34;https://github.com/alswl/image2attach/issues&#34;&gt;Issue Report&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;support&#34;&gt;Support&lt;/h2&gt;
&lt;p&gt;You can get some develop infomation in
&lt;a href=&#34;http://log4d.com/tag/image2attach&#34;&gt;Image2attach - Log4D&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;licence&#34;&gt;Licence&lt;/h2&gt;
&lt;p&gt;Distributed under the &lt;a href=&#34;http://www.gnu.org/licenses/gpl-2.0.htmwl&#34;&gt;GPL v2&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Source code powered by &lt;a href=&#34;https://github.com/alswl/image2attach&#34;&gt;https://github.com/alswl/image2attach&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;update&#34;&gt;update&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;2012-05-28&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;fix url catch bug(Issue 4 / Issue 6)&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;2011-12-25&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;support link([[http://xxx.com/xxx.jpg|)&lt;/li&gt;
&lt;li&gt;fix url has &amp;lsquo;attachment&amp;rsquo; string bug.&lt;/li&gt;
&lt;li&gt;support image attachment rewrite.&lt;/li&gt;
&lt;/ul&gt;</description>
      <content:encoded><![CDATA[<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201112/moinmoin.png" alt="MoinMoin"  />


</p>
<h2 id="whats-this">What&rsquo;s this</h2>
<p>Image2Attach is a extension for <a href="http://moinmo.in">MoinMoin</a>.
It can create a page action to save images from web to page&rsquo;s attachments.</p>
<h2 id="requirment">Requirment</h2>
<ul>
<li>MoinMoin 1.9 (I only test in this version.)</li>
</ul>
<h2 id="install">Install</h2>
<ul>
<li>copy action/Image2Attach.py to data/plugin/action/</li>
<li>restart python server</li>
</ul>
<h2 id="usage">Usage</h2>
<p>Go into a page, click <code>more action</code> - <code>Image2Attach</code> .
It will take a while to fetch the images,
after that it will save the image to attachments and replace the
image&rsquo;s link with attachment&rsquo;s link.
Finnally it will commit a change with message
<code>internet image save to attachment</code> to wiki.</p>
<p>Enjoy it, any bugs can report to
<a href="https://github.com/alswl/image2attach/issues">Issue Report</a>.</p>
<h2 id="support">Support</h2>
<p>You can get some develop infomation in
<a href="http://log4d.com/tag/image2attach">Image2attach - Log4D</a></p>
<h2 id="licence">Licence</h2>
<p>Distributed under the <a href="http://www.gnu.org/licenses/gpl-2.0.htmwl">GPL v2</a></p>
<p>Source code powered by <a href="https://github.com/alswl/image2attach">https://github.com/alswl/image2attach</a>.</p>
<h2 id="update">update</h2>
<ul>
<li>2012-05-28</li>
</ul>
<ul>
<li>fix url catch bug(Issue 4 / Issue 6)</li>
</ul>
<ul>
<li>2011-12-25</li>
</ul>
<ul>
<li>support link([[http://xxx.com/xxx.jpg|)</li>
<li>fix url has &lsquo;attachment&rsquo; string bug.</li>
<li>support image attachment rewrite.</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>dbevent2gc v0.1å‘å¸ƒ</title>
      <link>https://blog.alswl.com/2011/11/dbevent2gc-v0-1-released/</link>
      <pubDate>Fri, 25 Nov 2011 00:00:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2011/11/dbevent2gc-v0-1-released/</guid>
      <description>&lt;p&gt;é‡è¦é€šçŸ¥ï¼šLog4Dçš„åŸŸåç”± &lt;a href=&#34;http://dddspace.com&#34;&gt;http://dddspace.com&lt;/a&gt; è¿ç§»åˆ°
&lt;a href=&#34;http://log4d.com&#34;&gt;http://log4d.com&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;p&gt;è®¢é˜…åœ°å€ç°åœ¨æ”¹ä¸º &lt;a href=&#34;http://log4d.com/feed&#34;&gt;http://log4d.com/feed&lt;/a&gt; å’Œ
&lt;a href=&#34;http://feeds.feedburner.com/dddspace&#34;&gt;http://feeds.feedburner.com/dddspace&lt;/a&gt;
ã€‚ï¼ˆFeedBurnerçš„åœ°å€æœªå‘ç”Ÿå˜åŒ–ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;strike&gt;&lt;a href=&#34;http://feed.dddspace.com&#34;&gt;http://feed.dddspace.com&lt;/a&gt;&lt;/strike&gt; å¼ƒç”¨&lt;/p&gt;
&lt;p&gt;è¯·è®¢é˜…æˆ‘åšå®¢çš„æœ‹å‹æ›´æ–°ä¸€ä¸‹è®¢é˜…åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;




&lt;img loading=&#34;lazy&#34; src=&#34;https://blog.alswl.com/images/upload_dropbox/201111/dbevent2gc.png&#34; alt=&#34;dbevent2gc&#34;  /&gt;


&lt;/p&gt;
&lt;h2 id=&#34;å…³äºdbevent2gc&#34;&gt;å…³äºdbevent2gc&lt;/h2&gt;
&lt;p&gt;A application to sync douban.com events to Google Calendar.&lt;/p&gt;
&lt;p&gt;dbevent2gcæ˜¯ä¸€ä¸ªGAEåº”ç”¨ï¼Œå®ƒå°†è±†ç“£åŒåŸçš„æ´»åŠ¨åŒæ­¥åˆ°Google Calendarçš„æ—¥å†ï¼Œ å…è®¸ç”¨æˆ·è®¢é˜…æ´»åŠ¨è€ŒçŸ¥é“æœ€è¿‘å‡ å‘¨å‘¨è¾¹å°†å‘ç”Ÿæ´»åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;dbevent2gcæ˜¯åŸºäºPython/web.py/mako/iCalendarçš„ï¼Œæºä»£ç åœ°å€åœ¨
&lt;a href=&#34;https://github.com/alswl/dbevent2gc&#34;&gt;https://github.com/alswl/dbevent2gc&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨æ–¹æ³•&#34;&gt;ä½¿ç”¨æ–¹æ³•&lt;/h2&gt;
&lt;p&gt;ç›®å‰dbevent2gcè¿è¡Œåœ¨GAEä¸Šé¢ï¼Œåœ°å€æ˜¯ &lt;a href=&#34;http://dbevent2gc.appspot.com&#34;&gt;http://dbevent2gc.appspot.com&lt;/a&gt; ï¼ˆå¢™å¤–ï¼‰
&lt;a href=&#34;http://dbevent2gc.log4d.com/&#34;&gt;http://dbevent2gc.log4d.com/&lt;/a&gt; ï¼ˆæˆ‘åšçš„æœ¬åœ°åå‘ä»£ç†ï¼‰
ç™»å½•è¿™ä¸ªåœ°å€å¯ä»¥é€‰æ‹©éœ€è¦è®¢é˜…çš„åŸå¸‚å’Œæ´»åŠ¨ç±»å‹ï¼Œç„¶åä¼šç”Ÿæˆä¸€ä¸ªæŒ‰é’®ï¼Œ ç‚¹å‡»è¿™ä¸ªæŒ‰é’®å¯ä»¥ç›´æ¥å°†é€‰æ‹©çš„æ´»åŠ¨è®¢é˜…åˆ°Googleæ—¥å†ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>é‡è¦é€šçŸ¥ï¼šLog4Dçš„åŸŸåç”± <a href="http://dddspace.com">http://dddspace.com</a> è¿ç§»åˆ°
<a href="http://log4d.com">http://log4d.com</a> ã€‚</p>
<p>è®¢é˜…åœ°å€ç°åœ¨æ”¹ä¸º <a href="http://log4d.com/feed">http://log4d.com/feed</a> å’Œ
<a href="http://feeds.feedburner.com/dddspace">http://feeds.feedburner.com/dddspace</a>
ã€‚ï¼ˆFeedBurnerçš„åœ°å€æœªå‘ç”Ÿå˜åŒ–ï¼‰</p>
<p><strike><a href="http://feed.dddspace.com">http://feed.dddspace.com</a></strike> å¼ƒç”¨</p>
<p>è¯·è®¢é˜…æˆ‘åšå®¢çš„æœ‹å‹æ›´æ–°ä¸€ä¸‹è®¢é˜…åœ°å€ã€‚</p>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201111/dbevent2gc.png" alt="dbevent2gc"  />


</p>
<h2 id="å…³äºdbevent2gc">å…³äºdbevent2gc</h2>
<p>A application to sync douban.com events to Google Calendar.</p>
<p>dbevent2gcæ˜¯ä¸€ä¸ªGAEåº”ç”¨ï¼Œå®ƒå°†è±†ç“£åŒåŸçš„æ´»åŠ¨åŒæ­¥åˆ°Google Calendarçš„æ—¥å†ï¼Œ å…è®¸ç”¨æˆ·è®¢é˜…æ´»åŠ¨è€ŒçŸ¥é“æœ€è¿‘å‡ å‘¨å‘¨è¾¹å°†å‘ç”Ÿæ´»åŠ¨ã€‚</p>
<p>dbevent2gcæ˜¯åŸºäºPython/web.py/mako/iCalendarçš„ï¼Œæºä»£ç åœ°å€åœ¨
<a href="https://github.com/alswl/dbevent2gc">https://github.com/alswl/dbevent2gc</a></p>
<h2 id="ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•</h2>
<p>ç›®å‰dbevent2gcè¿è¡Œåœ¨GAEä¸Šé¢ï¼Œåœ°å€æ˜¯ <a href="http://dbevent2gc.appspot.com">http://dbevent2gc.appspot.com</a> ï¼ˆå¢™å¤–ï¼‰
<a href="http://dbevent2gc.log4d.com/">http://dbevent2gc.log4d.com/</a> ï¼ˆæˆ‘åšçš„æœ¬åœ°åå‘ä»£ç†ï¼‰
ç™»å½•è¿™ä¸ªåœ°å€å¯ä»¥é€‰æ‹©éœ€è¦è®¢é˜…çš„åŸå¸‚å’Œæ´»åŠ¨ç±»å‹ï¼Œç„¶åä¼šç”Ÿæˆä¸€ä¸ªæŒ‰é’®ï¼Œ ç‚¹å‡»è¿™ä¸ªæŒ‰é’®å¯ä»¥ç›´æ¥å°†é€‰æ‹©çš„æ´»åŠ¨è®¢é˜…åˆ°Googleæ—¥å†ã€‚</p>
<p>å¦‚æœä½ æ— æ³•ç¿»å¢™ï¼Œå¯ä»¥ä½¿ç”¨ [http://dbevent2gc.appspot.com/event/location/beijing?type=all](h
ttp://dbevent2gc.appspot.com/event/location/beijing?type=all) è¿™æ ·çš„åœ°å€æ·»åŠ åˆ°ä½ çš„Google
Calenderé‡Œé¢ã€‚</p>
<p>æ¥å—çš„å‚æ•°ï¼š</p>
<ul>
<li>åŸå¸‚ï¼ˆæŠŠæœ€åçš„beijingæ›¿æ¢æˆä½ æƒ³è¦çš„åŸå¸‚æ‹¼éŸ³ï¼Œ æ›´å¤šåŸå¸‚æ‹¼éŸ³æŸ¥çœ‹<a href="http://www.douban.com/location/world/?others=true">è¿™é‡Œ</a></li>
<li>æ´»åŠ¨ç±»å‹ typeï¼Œæ”¯æŒall, commonweal, drama, exhibition, film, music, others, party, salon, sports, travel. å¯é€‰å‚æ•°,é»˜è®¤ä¸ºall</li>
</ul>
<h2 id="å®‰è£…æ–¹æ³•">å®‰è£…æ–¹æ³•</h2>
<p>å¦‚æœæƒ³è‡ªå·±æ­å»ºGAEåº”ç”¨ï¼Œä¹Ÿå¾ˆç®€å•ï¼Œç›´æ¥ä½¿ç”¨ <code>git://github.com/alswl/dbevent2gc.git</code> å°±å¯ä»¥è·å–æœ€æ–°ä»£ç ï¼Œ
ç„¶åå˜›å»GAEæ³¨å†Œä¸€ä¸ªåº”ç”¨ï¼Œä¸Šä¼ å³å¯è¿è¡Œäº†ã€‚</p>
<p>dbevent2gcçœ‹ä¸Šå»å¯ä»¥ç”¨äº†ï¼Œæˆ‘æ˜¨æ™šå‘å¸ƒäº†v0.1ç‰ˆæœ¬ã€‚</p>
<p>æ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è¯•è¯•ï¼Œç°åœ¨çš„é—®é¢˜æ˜¯è·å–çš„æ´»åŠ¨å¯èƒ½å¤ªå¤šäº†ï¼Œ<strike>æˆ‘åæœŸä¼šåŠ ä¸Šè¿‡æ»¤åŠŸèƒ½</strike>ï¼ˆupdate
2011-11-26ï¼Œæˆ‘å·²ç»æ·»åŠ äº†æ´»åŠ¨ç±»å‹é€‰æ‹©åŠŸèƒ½ï¼‰ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>ä½¿ç”¨noseåšæµ‹è¯•</title>
      <link>https://blog.alswl.com/2011/09/nose/</link>
      <pubDate>Thu, 22 Sep 2011 00:00:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2011/09/nose/</guid>
      <description>&lt;p&gt;ä¸åšå•å…ƒæµ‹è¯•çš„ç¨‹åºå‘˜ä¸æ˜¯å¥½ç¨‹åºå‘˜ã€‚æœ€è¿‘æˆ‘åœ¨Pylonsä¸‹é¢åšå¼€å‘ï¼Œ ä½¿ç”¨
&lt;a href=&#34;http://readthedocs.org/docs/nose/en/latest&#34;&gt;nose&lt;/a&gt; åšå•å…ƒæµ‹è¯•ï¼Œé¢‡æœ‰å¿ƒå¾—ï¼Œ åœ¨è¿™é‡Œåˆ†äº«ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;1-pylonsä¸­ä¾èµ–åŒ…&#34;&gt;1. Pylonsä¸­ä¾èµ–åŒ…&lt;/h2&gt;
&lt;p&gt;å…ˆç®€å•ä»‹ç»ä¸€ä¸‹Pylons, Pylonsä¸å…¶è¯´æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œä¸å¦‚è¯´æ˜¯ä¸€å †æ¡†æ¶çš„ç»„åˆï¼Œ Pylonsåœ¨å…¶ä¸­åšåˆ°ä¸€ä¸ªèƒ¶æ°´çš„ä½œç”¨ã€‚Pylonsä¾èµ–çš„åŒ…å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/danielfm/pybreaker&#34;&gt;breakerï¼Œç¼“å­˜å’ŒSession&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://formencode.org/&#34;&gt;FormEncodeï¼Œç”¨æˆ·è¾“å…¥æ£€æŸ¥&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.makotemplates.org/&#34;&gt;Makoï¼Œæ¨¡æ¿æ¸²æŸ“&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://readthedocs.org/docs/nose/en/latest/&#34;&gt;noseï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://pythonpaste.org/script/&#34;&gt;Pasteï¼ŒæœåŠ¡å™¨&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://routes.groovie.org/&#34;&gt;Routes, è·¯ç”±&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://pythonpaste.org/tempita/&#34;&gt;Tempitaï¼ŒPasteçš„æ¨¡æ¿&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://packages.python.org/WebCore/modules/thirdparty/weberror.html&#34;&gt;Weberror&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://docs.webob.org/en/latest/index.html&#34;&gt;WebObï¼Œæä¾›WSGIè¯·æ±‚å“åº”ç­‰å¯¹è±¡&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://pythonpaste.org/webtest/&#34;&gt;WebTestï¼ŒPasteè‡ªå¸¦çš„æµ‹è¯•å°æ¡†æ¶ï¼Œ æä¾›TestResponseå’ŒTestRequestä¸¤ä¸ªæœ‰ç”¨çš„å°ä¸œè¥¿&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Pylonsçš„æµ‹è¯•ä¸»è¦ä½¿ç”¨çš„å…¶ä¸­çš„ Paste / nose / WebOb / WebTestã€‚ é‡åˆ°é—®é¢˜çš„æ—¶å€™ï¼Œå¯ä»¥å»ç¿»ä¸€ç¿»ä¸Šé¢çš„æ–‡æ¡£ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>ä¸åšå•å…ƒæµ‹è¯•çš„ç¨‹åºå‘˜ä¸æ˜¯å¥½ç¨‹åºå‘˜ã€‚æœ€è¿‘æˆ‘åœ¨Pylonsä¸‹é¢åšå¼€å‘ï¼Œ ä½¿ç”¨
<a href="http://readthedocs.org/docs/nose/en/latest">nose</a> åšå•å…ƒæµ‹è¯•ï¼Œé¢‡æœ‰å¿ƒå¾—ï¼Œ åœ¨è¿™é‡Œåˆ†äº«ä¸€ä¸‹ã€‚</p>
<h2 id="1-pylonsä¸­ä¾èµ–åŒ…">1. Pylonsä¸­ä¾èµ–åŒ…</h2>
<p>å…ˆç®€å•ä»‹ç»ä¸€ä¸‹Pylons, Pylonsä¸å…¶è¯´æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œä¸å¦‚è¯´æ˜¯ä¸€å †æ¡†æ¶çš„ç»„åˆï¼Œ Pylonsåœ¨å…¶ä¸­åšåˆ°ä¸€ä¸ªèƒ¶æ°´çš„ä½œç”¨ã€‚Pylonsä¾èµ–çš„åŒ…å¦‚ä¸‹ã€‚</p>
<ul>
<li><a href="https://github.com/danielfm/pybreaker">breakerï¼Œç¼“å­˜å’ŒSession</a></li>
<li><a href="http://formencode.org/">FormEncodeï¼Œç”¨æˆ·è¾“å…¥æ£€æŸ¥</a></li>
<li><a href="http://www.makotemplates.org/">Makoï¼Œæ¨¡æ¿æ¸²æŸ“</a></li>
<li><a href="http://readthedocs.org/docs/nose/en/latest/">noseï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•</a></li>
<li><a href="http://pythonpaste.org/script/">Pasteï¼ŒæœåŠ¡å™¨</a></li>
<li><a href="http://routes.groovie.org/">Routes, è·¯ç”±</a></li>
<li><a href="http://pythonpaste.org/tempita/">Tempitaï¼ŒPasteçš„æ¨¡æ¿</a></li>
<li><a href="http://packages.python.org/WebCore/modules/thirdparty/weberror.html">Weberror</a></li>
<li><a href="http://docs.webob.org/en/latest/index.html">WebObï¼Œæä¾›WSGIè¯·æ±‚å“åº”ç­‰å¯¹è±¡</a></li>
<li><a href="http://pythonpaste.org/webtest/">WebTestï¼ŒPasteè‡ªå¸¦çš„æµ‹è¯•å°æ¡†æ¶ï¼Œ æä¾›TestResponseå’ŒTestRequestä¸¤ä¸ªæœ‰ç”¨çš„å°ä¸œè¥¿</a></li>
</ul>
<p>Pylonsçš„æµ‹è¯•ä¸»è¦ä½¿ç”¨çš„å…¶ä¸­çš„ Paste / nose / WebOb / WebTestã€‚ é‡åˆ°é—®é¢˜çš„æ—¶å€™ï¼Œå¯ä»¥å»ç¿»ä¸€ç¿»ä¸Šé¢çš„æ–‡æ¡£ã€‚</p>
<h2 id="2-pylonsä¸­æµ‹è¯•ç›®å½•ç»“æ„">2. Pylonsä¸­æµ‹è¯•ç›®å½•ç»“æ„</h2>
<p>ç›®å½•ç»“æ„å¦‚ä¸‹</p>
<pre tabindex="0"><code>â”œâ”€config
â”œâ”€controllers
â”œâ”€lib
â”œâ”€model
â”œâ”€public
â”œâ”€templates
â””â”€tests
    â””â”€functional
</code></pre><p>ç›®å½•ä¸­çš„ <code>config / controllers / lib / model / public</code>
åœ¨ä¸åŒçš„webæ¡†æ¶ä¸‹é¢å¯èƒ½ä¼šç•¥æœ‰å·®åˆ«ï¼Œåœ¨è¿™é‡Œæˆ‘ä¸å…³æ³¨ä»–ä»¬ï¼Œæˆ‘å…³æ³¨ <code>tests / functional</code> ä¸­å­˜æ”¾ç›¸åº”çš„æµ‹è¯•è„šæœ¬ï¼Œæ¯”å¦‚
<code>test_user.py</code></p>
<h2 id="3-ç¬¬ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç”¨ä¾‹">3. ç¬¬ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç”¨ä¾‹</h2>
<h3 id="31-æ’°å†™å•å…ƒæµ‹è¯•æ–‡ä»¶">3.1. æ’°å†™å•å…ƒæµ‹è¯•æ–‡ä»¶</h3>
<p>æœ€ç®€å•çš„testè„šæœ¬å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">myb.tests</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TestIndexController</span><span class="p">(</span><span class="n">TestController</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">test_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">pass</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Test response...</span>
</span></span></code></pre></div><p>è¿™é‡Œæˆ‘ä»¬ä» <code>myb.tests</code> è¿™ä¸ªç›®å½•ä¸‹é¢å¼•å…¥äº†æ‰€æœ‰åŒ… ï¼ˆå…¶å®èµ·ä½œç”¨çš„æ˜¯ <code>__init__.py</code> ï¼‰</p>
<p><code>__init__.py</code> å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python</span>
</span></span><span class="line"><span class="cl"><span class="c1">#coding: utf-8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">webob.headers</span> <span class="kn">import</span> <span class="n">ResponseHeaders</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">TestCase</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">paste.deploy</span> <span class="kn">import</span> <span class="n">loadapp</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">paste.script.appinstall</span> <span class="kn">import</span> <span class="n">SetupCommand</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pylons</span> <span class="kn">import</span> <span class="n">url</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">routes.util</span> <span class="kn">import</span> <span class="n">URLGenerator</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">webtest</span> <span class="kn">import</span> <span class="n">TestApp</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pylons.test</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;environ&#39;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">,</span> <span class="s1">&#39;TestController&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Invoke websetup with the current config file</span>
</span></span><span class="line"><span class="cl"><span class="n">SetupCommand</span><span class="p">(</span><span class="s1">&#39;setup-app&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">pylons</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">pylonsapp</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;__file__&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl"><span class="n">environ</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">TestController</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">wsgiapp</span> <span class="o">=</span> <span class="n">pylons</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">pylonsapp</span>
</span></span><span class="line"><span class="cl">        <span class="n">config</span> <span class="o">=</span> <span class="n">wsgiapp</span><span class="o">.</span><span class="n">config</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">TestApp</span><span class="p">(</span><span class="n">wsgiapp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">url</span><span class="o">.</span><span class="n">_push_object</span><span class="p">(</span><span class="n">URLGenerator</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;routes.map&#39;</span><span class="p">],</span> <span class="n">environ</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">TestCase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œä½¿ç”¨äº† <code>TestController</code> ç»§æ‰¿äº† <code>TestCase</code> è¿™ä¸ªå•å…ƒæµ‹è¯•åŸºç±»ï¼Œ å¹¶ä¸”åœ¨é‡Œé¢è¿›è¡Œäº†webåº”ç”¨çš„ç¯å¢ƒåˆå§‹åŒ–ã€‚</p>
<h3 id="32-æ’°å†™æµ‹è¯•é…ç½®æ–‡ä»¶">3.2. æ’°å†™æµ‹è¯•é…ç½®æ–‡ä»¶</h3>
<p>ä¸Šæ–‡æ’°å†™äº†ä¸€ä¸ªæœ€ç®€å•çš„æµ‹è¯•ä»£ç ï¼Œæˆ‘ä»¬æ¥ç€åšä¸€äº›å•å…ƒæµ‹è¯•é…ç½®ã€‚</p>
<p>åœ¨appåº”ç”¨çš„åŒçº§æ–‡ä»¶é‡Œé¢ï¼Œä¿®æ”¹ <code>test.ini</code> æ–‡ä»¶ã€‚</p>
<pre tabindex="0"><code>[DEFAULT]
debug = true
#email_to = you@yourdomain.com
smtp_server = localhost
error_email_from = paste@localhost

[server:main]
use = egg:Paste#http
host = 127.0.0.1
port = 5000

[app:main]
use = config:development.ini
sqlalchemy.url = mysql://username:password@localhost/myb_test?charset=utf8&amp;use_unicode=1

# Logging configuration
[loggers]
keys = root, routes, myb, sqlalchemy

[handlers]
keys = console

[formatters]
keys = generic

[logger_root]
level = INFO
handlers = console

[logger_routes]
level = INFO
handlers =
qualname = routes.middleware

# &#34;level = DEBUG&#34; logs the route matched and routing variables.
[logger_myb]
level = DEBUG
handlers =
qualname = myb

[logger_sqlalchemy]
level = INFO
handlers =
qualname = sqlalchemy.engine

# &#34;level = INFO&#34; logs SQL queries.
# &#34;level = DEBUG&#34; logs SQL queries and results.
# &#34;level = WARN&#34; logs neither. (Recommended for production systems.)

[handler_console]
class = StreamHandler
args = (sys.stderr,)
level = NOTSET
formatter = generic

[formatter_generic]
format = %(asctime)s,%(msecs)03d %(levelname)-5.5s [%(name)s] [%(threadName)s] %(message)s
datefmt = %H:%M:%S
</code></pre><p>è¿™ä¸ªé…ç½®æ–‡ä»¶è®¾å®šäº†åŸºæœ¬è°ƒè¯•ä¿¡æ¯ï¼Œæ•°æ®åº“ï¼ˆä½¿ç”¨myb_testæ•°æ®åº“æ¥é¿å…ä¿®æ”¹åŸå§‹æ•°æ®ï¼‰ ï¼Œlogæ–¹å¼ã€‚</p>
<p>åœ¨ <code>[app:main]</code> é‡Œé¢ï¼Œæˆ‘ç›´æ¥å¼•ç”¨äº† <code>development.ini</code> çš„é…ç½®ã€‚</p>
<h3 id="33-è¿è¡Œnose">3.3. è¿è¡Œnose</h3>
<p>åœ¨shellé‡Œé¢åˆ‡æ¢åˆ°appæ‰€åœ¨çš„ç›®å½•ï¼ˆtest.iniï¼‰æ‰€åœ¨çš„ç›®å½•ï¼Œè¿è¡Œ <code>nosetests myb/tests/functional/test_hello world.py</code> ã€‚ ä¹‹åä¼šå‡ºç°ä¸€äº›logå†…å®¹ï¼Œä¸å‡ºæ„å¤–çš„è¯ï¼Œåº”è¯¥å‡ºç° <code>OK</code> ã€‚</p>
<p>å¦‚æœé‡åˆ° <code>FAILED</code> ï¼Œé‚£å°±æ ¹æ®é”™è¯¯æç¤ºçš„ä¿¡æ¯æ¥æŸ¥é”™ã€‚ noseä¼šè¾“å‡ºlogçš„ä¿¡æ¯å’Œprintæ ‡å‡†è¾“å‡ºçš„ä¿¡æ¯ã€‚</p>
<h2 id="4-é«˜çº§ä¸€ç‚¹çš„æµ‹è¯•æ–¹æ³•">4. é«˜çº§ä¸€ç‚¹çš„æµ‹è¯•æ–¹æ³•</h2>
<p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤å®šå•å…ƒæµ‹è¯•æ˜¯å¦æ­£ç¡®ï¼Œæˆ‘ç½—åˆ—ä¸€äº›å¸¸è§çš„ç”¨æ³•</p>
<h3 id="41-æµ‹è¯•è¿”å›ç±»å‹ä¸ºhttp-statusçš„æ–¹æ³•">4.1. æµ‹è¯•è¿”å›ç±»å‹ä¸ºHTTP STATUSçš„æ–¹æ³•</h3>
<p>æ¯æ¬¡HTTPè¯·æ±‚éƒ½ä¼šè¿”å›HTTP STATUSï¼Œæ­£å¸¸æ˜¯200ï¼Œæ‰¾ä¸åˆ°æ˜¯404ï¼ŒæœåŠ¡å™¨é”™è¯¯æ˜¯500ï¼Œ æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™äº›è¿”å›çŠ¶æ€å€¼æ¥åˆ¤æ–­æµ‹è¯•æ˜¯å¦è·‘é€šã€‚</p>
<pre tabindex="0"><code>class TestQuestionController(TestController):

  def test_suggest_question(self):

    #æ­£å¸¸è¿”å›200
    response = self.app.get(url=url(controller=&#39;question&#39;,
    action=&#39;suggest_question&#39;,
    ),

    params={
    },
    headers=self.headers,
    status=200,
    )
</code></pre><p>#ä¸å­˜åœ¨çš„idè¿”å›404</p>
<pre tabindex="0"><code>response = self.app.get(url=url(controller=&#39;question&#39;,

action=&#39;suggest_question&#39;,

),

params={

&#39;id&#39;: &#39;345&#39;,

},

headers=self.headers,

status=404,

)
</code></pre><p>æˆ‘ä¹ æƒ¯ä½¿ç”¨ <code>url()</code> æ–¹æ³•æ¥ç”Ÿæˆurlï¼Œè¿™æ ·ä¸€æ–¹é¢ä¸ç”¨è®°ä½å†—é•¿çš„urlï¼Œ å¦å¤–åœ¨urlè·¯ç”±è¡¨å‘ç”Ÿå˜åŒ–ä¹‹åï¼Œä¹Ÿä¸ç”¨å»æ”¹å˜æµ‹è¯•ä»£ç ã€‚</p>
<h3 id="42-æµ‹è¯•è¿”å›ç±»å‹ä¸ºhtmlçš„æ–¹æ³•">4.2. æµ‹è¯•è¿”å›ç±»å‹ä¸ºhtmlçš„æ–¹æ³•</h3>
<pre tabindex="0"><code>        def test_register(self):
            response = self.app.post(url(controller = &#39;users&#39;,
                                         action = &#39;register&#39;,
                                         format = &#39;json&#39;),
                                     {
                                         &#39;login_name&#39;: &#39;nose_json&#39;,
                                         &#39;login_pass&#39;: &#39;123&#39;,
                                         &#39;user_name&#39;: &#39;æµ‹è¯•æœºå™¨äºº_json&#39;,
                                     },
                                     status=200
                                     )
            assert &#39;202cb962ac59075b964b07152d234b70&#39; in response.body #è¿”å›çš„åŠ å¯†å¯†ç 
            #log.debug( u&#39;å™¨&#39; in response.unicode_body) #æ— æ³•æµ‹è¯•ä¸­æ–‡
            #log.debug( u&#39;æµ‹è¯•æœºå™¨äºº_json&#39; in response.unicode_body) #æ— æ³•æµ‹è¯•ä¸­æ–‡
</code></pre><p>ä½¿ç”¨ <code>response.body</code> æ¥åˆ¤å®šhtmlé‡Œé¢çš„å†…å®¹ï¼ˆè¿™é‡Œå¯¹ä¸­æ–‡æ”¯æŒä¸å¤ªå¥½ï¼‰ã€‚</p>
<h3 id="43-æµ‹è¯•è¿”å›ç±»å‹ä¸ºjsonçš„æ–¹æ³•">4.3. æµ‹è¯•è¿”å›ç±»å‹ä¸ºjsonçš„æ–¹æ³•</h3>
<p>AJAXè¯·æ±‚æ­£å¸¸è¿”å›çš„çŠ¶æ€å—éƒ½æ˜¯200ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤å®šé‡Œé¢çš„å†…å®¹è¿›è¡Œassert</p>
<pre tabindex="0"><code>            response = self.app.post(url=url(controller=&#39;invitation&#39;,
                                             action=&#39;invite_by_mail&#39;),
                                     params={
                                         &#39;to_address&#39;: &#39;&#39;,
                                         &#39;to_user_name&#39;: &#39;å¤§çˆ·&#39;,
                                     },
                                     headers=self.headers,
                                     status=200
                                    )
            result = response.json
            assert(result[&#39;success&#39;] == False)
            assert(result[&#39;message&#39;] == u&#39;å‘é€å¤±è´¥ï¼šä½ å¦¹ä¸æ¼‚äº®&#39;)
</code></pre><h3 id="44-æµ‹è¯•è¿”å›ç±»å‹ä¸ºé‡å®šå‘çš„æ–¹æ³•">4.4. æµ‹è¯•è¿”å›ç±»å‹ä¸ºé‡å®šå‘çš„æ–¹æ³•</h3>
<p>è¿™æ˜¯HTTPçŠ¶æ€å—çš„ç‰¹æ®Šå½¢å¼ï¼Œæ¯”å¦‚ç™»å½•ä¹‹ååšä¸€æ¬¡è·³è½¬ä¹‹ç±»çš„ã€‚</p>
<pre tabindex="0"><code>        def test_add(self):
            #æˆåŠŸä¹‹åè¿”å›302åšè·³è½¬ï¼ŒåŒæ—¶åˆ¤å®šè¿”å›å†…å®¹ä¸­è·³è½¬è·¯å¾„
            response = self.app.post(url=url(controller=&#39;question&#39;,
                                             action=&#39;add&#39;,
                                             ),
                                     params={
                                         &#39;question_title&#39;: &#39;hwti1&#39;,
                                         &#39;question_content&#39;: &#39;wgtinzrs1&#39;,
                                     },
                                     headers=self.headers,
                                     status=302,
                                    )
            assert re.match(r&#39;^http://localhost/question/d*&#39;,
                            response.headers[&#39;Location&#39;])
</code></pre><h3 id="45-ç”¨æˆ·ç™»å½•ç”Ÿæˆsession">4.5. ç”¨æˆ·ç™»å½•ç”ŸæˆSession</h3>
<p>æœ‰äº›æ–¹æ³•éœ€è¦ç™»å½•åæ‰èƒ½è¿è¡Œï¼Œè¿™ä¾èµ–äºæœåŠ¡å™¨å’Œæµè§ˆå™¨ä¹‹é—´çš„Cookieã€‚å¦‚æœè¦å¯¹è¿™ç±»
æ–¹æ³•è¿›è¡Œæµ‹è¯•ï¼Œæˆ‘ä»¬éœ€è¦äº‹å…ˆè·å–Cookieï¼Œå†åœ¨æ¯ä¸€æ¬¡è¯·æ±‚å‘å‡ºçš„æ—¶å€™é™„å¸¦è¿™ä¸ªCookieã€‚</p>
<p>åœ¨ä¸‹é¢çš„æ–¹æ³•ä¸­ï¼Œæˆ‘å®ç°äº†ç”¨æˆ·ç™»å½•æ“ä½œã€‚ åœ¨testç›®å½•ä¸‹çš„ <code>__init.py__</code> ä¸­ <code>TestController</code> åŠ å…¥æ–°æ–¹æ³• <code>login()</code></p>
<pre tabindex="0"><code>        def login(self, login_name, login_pass):
            &#34;&#34;&#34;
            ç”¨æˆ·ç™»å½•æ“ä½œï¼Œè·å–Cookie

&#34;&#34;&#34;

response = self.app.post(url=url(controller=&#39;users&#39;,

action=&#39;login&#39;),

params={

&#39;login_name&#39;: login_name,

&#39;login_pass&#39;: login_pass,

},

)

cookie = response.headers.getall(&#39;Set-cookie&#39;)[0]

self.headers = ResponseHeaders()

self.headers.add(&#39;Cookie&#39;, cookie)
</code></pre><p>è¿™æ ·å°±å¯ä»¥é€šè¿‡ <code>self.headers</code> ä¿å­˜ç™»å½•ä¹‹åçš„cookieã€‚</p>
<h3 id="46-æ‰¹é‡æµ‹è¯•">4.6. æ‰¹é‡æµ‹è¯•</h3>
<p>é™¤äº†åˆ¶å®š <code>test_xxx.py</code> æ–‡ä»¶è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>nosetests</code> æµ‹è¯•æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ã€‚</p>
<pre><code>nosetests
//è¯¥ç›®å½•ä¸‹éœ€è¦å­˜åœ¨ test.ini é…ç½®æ–‡ä»¶
</code></pre>
<h2 id="5-é‡åˆ°çš„é—®é¢˜">5. é‡åˆ°çš„é—®é¢˜</h2>
<h3 id="51-ç¼–ç é—®é¢˜">5.1. ç¼–ç é—®é¢˜</h3>
<pre tabindex="0"><code>      File &#34;buildbdist.win32eggwebtest__init__.py&#34;, line 211, in post
        content_type=content_type)
      File &#34;buildbdist.win32eggwebtest__init__.py&#34;, line 191, in _gen_request
        expect_errors=expect_errors)
      File &#34;buildbdist.win32eggwebtest__init__.py&#34;, line 370, in do_request
        res = req.get_response(app, catch_exc_info=True)
      File &#34;buildbdist.win32eggwebobrequest.py&#34;, line 1004, in get_response
        application, catch_exc_info=True)
      File &#34;buildbdist.win32eggwebobrequest.py&#34;, line 977, in call_application
        app_iter = application(self.environ, start_response)
      File &#34;buildbdist.win32eggwebtestlint.py&#34;, line 170, in lint_app
        iterator = application(environ, start_response_wrapper)
      File &#34;d:programmingpython26libsite-packagespaste-1.7.5.1-py2.6.eggpastecascade.py&#34;, line 130, in __call__
        return self.apps[-1](environ, start_response)
      File &#34;d:programmingpython26libsite-packagespaste-1.7.5.1-py2.6.eggpasteregistry.py&#34;, line 379, in __call__
        app_iter = self.application(environ, start_response)
      File &#34;d:programmingpython26libsite-packagespylons-1.0-py2.6.eggpylonsmiddleware.py&#34;, line 150, in __call__
        self.app, environ, catch_exc_info=True)
      File &#34;d:programmingpython26libsite-packagespylons-1.0-py2.6.eggpylonsutil.py&#34;, line 48, in call_wsgi_application
        app_iter = application(environ, start_response)
      File &#34;d:programmingpython26libsite-packagesweberror-0.10.3-py2.6.eggweberrorevalexception.py&#34;, line 235, in __call__
        return self.respond(environ, start_response)
      File &#34;d:programmingpython26libsite-packagesweberror-0.10.3-py2.6.eggweberrorevalexception.py&#34;, line 418, in respond
        return self.application(environ, start_response)
      File &#34;d:programmingpython26libsite-packagesbeaker-1.5.4-py2.6.eggbeakermiddleware.py&#34;, line 152, in __call__
        return self.wrap_app(environ, session_start_response)
      File &#34;d:programmingpython26libsite-packagesroutes-1.12.3-py2.6.eggroutesmiddleware.py&#34;, line 131, in __call__
        response = self.app(environ, start_response)
      File &#34;d:programmingpython26libsite-packagespylons-1.0-py2.6.eggpylonswsgiapp.py&#34;, line 107, in __call__
        response = self.dispatch(controller, environ, start_response)
      File &#34;d:programmingpython26libsite-packagespylons-1.0-py2.6.eggpylonswsgiapp.py&#34;, line 312, in dispatch
        return controller(environ, start_response)
      File &#34;F:workxintongworkspaceMYB_WENDAmybmyblibbase.py&#34;, line 52, in __call__
        return WSGIController.__call__(self, environ, start_response)
      File &#34;d:programmingpython26libsite-packagespylons-1.0-py2.6.eggpylonscontrollerscore.py&#34;, line 266, in __call__
        return response(environ, self.start_response)
      File &#34;d:programmingpython26libsite-packageswebob-1.0.7-py2.6.eggwebobexc.py&#34;, line 517, in __call__
        environ, start_response)
      File &#34;d:programmingpython26libsite-packageswebob-1.0.7-py2.6.eggwebobexc.py&#34;, line 341, in __call__
        return self.generate_response(environ, start_response)
      File &#34;d:programmingpython26libsite-packageswebob-1.0.7-py2.6.eggwebobexc.py&#34;, line 322, in generate_response
        body = self.plain_body(environ)
      File &#34;d:programmingpython26libsite-packageswebob-1.0.7-py2.6.eggwebobexc.py&#34;, line 301, in plain_body
        body = self._make_body(environ, no_escape)
      File &#34;d:programmingpython26libsite-packageswebob-1.0.7-py2.6.eggwebobexc.py&#34;, line 294, in _make_body
        args[k] = escape(v)
      File &#34;d:programmingpython26libsite-packageswebob-1.0.7-py2.6.eggwebobexc.py&#34;, line 182, in no_escape
        value = str(value)
      File &#34;d:programmingpython26libsite-packagespylons-1.0-py2.6.eggpylonsutil.py&#34;, line 112, in __repr__
        value_repr = repr(value)
    UnicodeEncodeError: &#39;ascii&#39; codec can&#39;t encode characters in position 8-18: ordinal not in range(128)
</code></pre><p>è¿™æ˜¯ä¸€ä¸ªæ˜æ˜¾ç”±ç¼–ç å¼•èµ·çš„é”™è¯¯ã€‚</p>
<p>ä¿®æ”¹pylons-1.0-py2.6.eggPylonsutil.pyä¸­112è¡Œä¿®æ”¹ä¸º</p>
<pre tabindex="0"><code>    try:
        value_repr = repr(value)
    except UnicodeEncodeError, e:
        log.error(&#39;encode error in pylons/utils.py&#39;)
        continue
</code></pre><p>è¿™æ ·è™½ç„¶ä¸èƒ½ä»æ ¹æœ¬ä¸Šè§£å†³é—®é¢˜ï¼Œä½†æ˜¯è‡³å°‘è§„é¿äº†é—®é¢˜ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>TypeError: sequence item 22: expected string or Unicode, long found</title>
      <link>https://blog.alswl.com/2011/08/mako-typeerror/</link>
      <pubDate>Thu, 25 Aug 2011 00:00:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2011/08/mako-typeerror/</guid>
      <description>&lt;p&gt;Mako ä¸‹é¢å¼€å‘æ—¶å€™ï¼Œé‡åˆ°è¿™ä¸ªé—®é¢˜&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;TypeError: sequence item : expected string or Unicode, long found&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Trace çš„æƒ…å†µå¤§æ¦‚è¿™æ ·ï¼ˆæˆ‘çš„é”™è¯¯ä¿¡æ¯æ— æ³•å†ç°ï¼Œè¿™æ˜¯æŸä½å¤–å›½å‹äººçš„é”™è¯¯ä¿¡æ¯ï¼‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;File &amp;lsquo;/Users/amaslov/Projects/dou-pylons/doupy/doupy/controllers/ root.py&amp;rsquo;,
line 239 in staticpage&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;return render(&amp;rsquo;/pages/%s.html&amp;rsquo; % name)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;File &amp;lsquo;/Users/amaslov/Projects/dou-pylons/py/lib/python2.5/site-
packages/Pylons-0.9.7-py2.5.egg/pylons/templating.py&amp;rsquo;, line 274 in render_mako&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;cache_type=cache_type, cache_expire=cache_expire)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;File &amp;lsquo;/Users/amaslov/Projects/dou-pylons/py/lib/python2.5/site-
packages/Pylons-0.9.7-py2.5.egg/pylons/templating.py&amp;rsquo;, line 249 in
cached_template&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;return render_func()&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;File &amp;lsquo;/Users/amaslov/Projects/dou-pylons/py/lib/python2.5/site-
packages/Pylons-0.9.7-py2.5.egg/pylons/templating.py&amp;rsquo;, line 271 in
render_template&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;return literal(template.render_unicode(**globs))&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;File &amp;lsquo;/Users/amaslov/Projects/dou-pylons/py/lib/python2.5/site-
packages/Mako-0.2.4-py2.5.egg/mako/template.py&amp;rsquo;, line 138 in render_unicode
return runtime.&lt;em&gt;render(self, self.callable&lt;/em&gt;, args, data, as_unicode=True) File
&amp;lsquo;/Users/amaslov/Projects/dou-pylons/py/lib/python2.5/site-
packages/Mako-0.2.4-py2.5.egg/mako/runtime.py&amp;rsquo;, line 348 in _render&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;return context._pop_buffer().getvalue()&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;File &amp;lsquo;/Users/amaslov/Projects/dou-pylons/py/lib/python2.5/site-
packages/Mako-0.2.4-py2.5.egg/mako/util.py&amp;rsquo;, line 74 in getvalue&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;return self.delim.join(self.data)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;TypeError: sequence item 68: expected string or Unicode, NoneType found&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Mako çš„é‚®ä»¶åˆ—è¡¨æ›¾åœ¨2009å¹´é‡åˆ°è¿™ä¸ªé”™è¯¯ï¼Œè®¨è®ºä¿¡æ¯åœ¨[è¿™é‡Œ](&lt;a href=&#34;http://www.mail-archive.com/pylons-&#34;&gt;http://www.mail-archive.com/pylons-&lt;/a&gt;
&lt;a href=&#34;mailto:discuss@googlegroups.com&#34;&gt;discuss@googlegroups.com&lt;/a&gt;/msg11021.html)ï¼ˆéœ€ç¿»å¢™ï¼‰&lt;/p&gt;
&lt;p&gt;è®¨è®ºäº†åŠå¤©ä¹Ÿæ²¡ä»€ä¹ˆç»“æœï¼Œä¸€ç›´å›´ç»•åœ¨ default_filter ä¸Šé¢ï¼Œæˆ‘æ”¹äº†åŠå¤©ï¼Œä¹Ÿæ²¡æ•ˆæœã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>Mako ä¸‹é¢å¼€å‘æ—¶å€™ï¼Œé‡åˆ°è¿™ä¸ªé—®é¢˜</p>
<blockquote>
<p>TypeError: sequence item : expected string or Unicode, long found</p></blockquote>
<p>Trace çš„æƒ…å†µå¤§æ¦‚è¿™æ ·ï¼ˆæˆ‘çš„é”™è¯¯ä¿¡æ¯æ— æ³•å†ç°ï¼Œè¿™æ˜¯æŸä½å¤–å›½å‹äººçš„é”™è¯¯ä¿¡æ¯ï¼‰</p>
<blockquote>
<p>File &lsquo;/Users/amaslov/Projects/dou-pylons/doupy/doupy/controllers/ root.py&rsquo;,
line 239 in staticpage</p></blockquote>
<blockquote>
</blockquote>
<blockquote>
<p>return render(&rsquo;/pages/%s.html&rsquo; % name)</p></blockquote>
<blockquote>
</blockquote>
<blockquote>
<p>File &lsquo;/Users/amaslov/Projects/dou-pylons/py/lib/python2.5/site-
packages/Pylons-0.9.7-py2.5.egg/pylons/templating.py&rsquo;, line 274 in render_mako</p></blockquote>
<blockquote>
</blockquote>
<blockquote>
<p>cache_type=cache_type, cache_expire=cache_expire)</p></blockquote>
<blockquote>
</blockquote>
<blockquote>
<p>File &lsquo;/Users/amaslov/Projects/dou-pylons/py/lib/python2.5/site-
packages/Pylons-0.9.7-py2.5.egg/pylons/templating.py&rsquo;, line 249 in
cached_template</p></blockquote>
<blockquote>
</blockquote>
<blockquote>
<p>return render_func()</p></blockquote>
<blockquote>
</blockquote>
<blockquote>
<p>File &lsquo;/Users/amaslov/Projects/dou-pylons/py/lib/python2.5/site-
packages/Pylons-0.9.7-py2.5.egg/pylons/templating.py&rsquo;, line 271 in
render_template</p></blockquote>
<blockquote>
</blockquote>
<blockquote>
<p>return literal(template.render_unicode(**globs))</p></blockquote>
<blockquote>
</blockquote>
<blockquote>
<p>File &lsquo;/Users/amaslov/Projects/dou-pylons/py/lib/python2.5/site-
packages/Mako-0.2.4-py2.5.egg/mako/template.py&rsquo;, line 138 in render_unicode
return runtime.<em>render(self, self.callable</em>, args, data, as_unicode=True) File
&lsquo;/Users/amaslov/Projects/dou-pylons/py/lib/python2.5/site-
packages/Mako-0.2.4-py2.5.egg/mako/runtime.py&rsquo;, line 348 in _render</p></blockquote>
<blockquote>
</blockquote>
<blockquote>
<p>return context._pop_buffer().getvalue()</p></blockquote>
<blockquote>
</blockquote>
<blockquote>
<p>File &lsquo;/Users/amaslov/Projects/dou-pylons/py/lib/python2.5/site-
packages/Mako-0.2.4-py2.5.egg/mako/util.py&rsquo;, line 74 in getvalue</p></blockquote>
<blockquote>
</blockquote>
<blockquote>
<p>return self.delim.join(self.data)</p></blockquote>
<blockquote>
</blockquote>
<blockquote>
<p>TypeError: sequence item 68: expected string or Unicode, NoneType found</p></blockquote>
<p>Mako çš„é‚®ä»¶åˆ—è¡¨æ›¾åœ¨2009å¹´é‡åˆ°è¿™ä¸ªé”™è¯¯ï¼Œè®¨è®ºä¿¡æ¯åœ¨[è¿™é‡Œ](<a href="http://www.mail-archive.com/pylons-">http://www.mail-archive.com/pylons-</a>
<a href="mailto:discuss@googlegroups.com">discuss@googlegroups.com</a>/msg11021.html)ï¼ˆéœ€ç¿»å¢™ï¼‰</p>
<p>è®¨è®ºäº†åŠå¤©ä¹Ÿæ²¡ä»€ä¹ˆç»“æœï¼Œä¸€ç›´å›´ç»•åœ¨ default_filter ä¸Šé¢ï¼Œæˆ‘æ”¹äº†åŠå¤©ï¼Œä¹Ÿæ²¡æ•ˆæœã€‚</p>
<p>æµ‹è¯•æœåŠ¡å™¨å’Œæ­£å¼ç¯å¢ƒéƒ½æ²¡æœ‰é—®é¢˜ï¼Œæœ€åè¯•äº†æ¸…ç©º<code>data/session, data/templates</code> ç›®å½•ï¼Œç»ˆäºæ²¡é”™è¯¯äº†ã€‚</p>
<p>Google ä¸Šè¿™ä¸ªé”™è¯¯ä¿¡æ¯èµ„æ–™å¤ªå°‘ï¼Œæˆ‘å°±è®°ä¸‹æ¥ï¼Œå¦‚æœå“ªä½åŒå­¦å‡ºç°åŒæ ·é”™è¯¯æ‰¾åˆ°æˆ‘è¿™é‡Œï¼Œå°±æ–¹ä¾¿è§£å†³äº†ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>go-pylons.pyåœ¨Python2.7ä¸‹é”™è¯¯è§£å†³</title>
      <link>https://blog.alswl.com/2011/08/go-pylons-py-in-python2-7/</link>
      <pubDate>Tue, 02 Aug 2011 00:00:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2011/08/go-pylons-py-in-python2-7/</guid>
      <description>&lt;p&gt;å½“ä½¿ç”¨ Python2.7 +&lt;a href=&#34;http://pylonshq.com/download/1.0/go-pylons.py&#34;&gt; go-pylons.py&lt;/a&gt;
åˆ›å»º Pylons è¿è¡Œç¯å¢ƒçš„è¯ï¼Œä¼šæŠ¥ä¸€ä¸‹é”™è¯¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[alswl@arch-vm xingtong]$ python go-pylons.py myb_env
New python executable in myb_env/bin/python
Traceback (most recent call last):
  File &amp;quot;/home/alswl/work/xingtong/myb_env/lib/python2.7/site.py&amp;quot;, line 67, in &amp;lt;module&amp;gt;
    import os
  File &amp;quot;/home/alswl/work/xingtong/myb_env/lib/python2.7/os.py&amp;quot;, line 398, in &amp;lt;module&amp;gt;
    import UserDict
  File &amp;quot;/home/alswl/work/xingtong/myb_env/lib/python2.7/UserDict.py&amp;quot;, line 83, in &amp;lt;module&amp;gt;
    import _abcoll
  File &amp;quot;/home/alswl/work/xingtong/myb_env/lib/python2.7/_abcoll.py&amp;quot;, line 11, in &amp;lt;module&amp;gt;
    from abc import ABCMeta, abstractmethod
  File &amp;quot;/home/alswl/work/xingtong/myb_env/lib/python2.7/abc.py&amp;quot;, line 8, in &amp;lt;module&amp;gt;
    from _weakrefset import WeakSet
ImportError: No module named _weakrefset
ERROR: The executable myb_env/bin/python is not functioning
ERROR: It thinks sys.prefix is &#39;/home/alswl/work/xingtong&#39; (should be &#39;/home/alswl/work/xingtong/myb_env&#39;)
ERROR: virtualenv is not compatible with this system or executable
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;STFW ä¹‹åï¼Œæ‰¾åˆ°äº†å¼•å‘é”™è¯¯çš„æ ¹æº&lt;a href=&#34;https://github.com/pypa/virtualenv&#34;&gt;virtualenv&lt;/a&gt;ï¼Œè¿™ä¸ª bug
åœ¨&lt;a href=&#34;https://github.com/pypa/virtualenv/issues/76&#34;&gt;è¿™é‡Œ&lt;/a&gt;å·²ç»ä¿®å¤äº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!diff
--- a/virtualenv.py        2010-09-14 21:48:58.078562930 +0200
+++ b/virtualenv.py        2010-09-14 21:46:20.650769346 +0200
@@ -51,6 +51,8 @@ REQUIRED_FILES = [&#39;lib-dynload&#39;, &#39;config
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;if sys.version_info[:2] &amp;gt;= (2, 6):&lt;/p&gt;
&lt;p&gt;REQUIRED_MODULES.extend([&amp;lsquo;warnings&amp;rsquo;, &amp;rsquo;linecache&amp;rsquo;, &amp;lsquo;_abcoll&amp;rsquo;, &amp;lsquo;abc&amp;rsquo;])&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;if sys.version_info[:2] &amp;gt;= (2, 7):&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;REQUIRED_MODULES.extend([&amp;rsquo;_weakrefset&amp;rsquo;])&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;if sys.version_info[:2] &amp;lt;= (2, 3):&lt;/p&gt;
&lt;p&gt;REQUIRED_MODULES.extend([&amp;lsquo;sets&amp;rsquo;, &amp;lsquo;&lt;strong&gt;future&lt;/strong&gt;&amp;rsquo;])&lt;/p&gt;
&lt;p&gt;if is_pypy:&lt;/p&gt;
&lt;p&gt;æ‡’äººå¯ä»¥ç‚¹å‡»&lt;a href=&#34;../../static/images/2011/08/go-pylons.py&#34;&gt;go-pylons.py&lt;/a&gt;ä¸‹è½½ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>å½“ä½¿ç”¨ Python2.7 +<a href="http://pylonshq.com/download/1.0/go-pylons.py"> go-pylons.py</a>
åˆ›å»º Pylons è¿è¡Œç¯å¢ƒçš„è¯ï¼Œä¼šæŠ¥ä¸€ä¸‹é”™è¯¯ã€‚</p>
<pre><code>[alswl@arch-vm xingtong]$ python go-pylons.py myb_env
New python executable in myb_env/bin/python
Traceback (most recent call last):
  File &quot;/home/alswl/work/xingtong/myb_env/lib/python2.7/site.py&quot;, line 67, in &lt;module&gt;
    import os
  File &quot;/home/alswl/work/xingtong/myb_env/lib/python2.7/os.py&quot;, line 398, in &lt;module&gt;
    import UserDict
  File &quot;/home/alswl/work/xingtong/myb_env/lib/python2.7/UserDict.py&quot;, line 83, in &lt;module&gt;
    import _abcoll
  File &quot;/home/alswl/work/xingtong/myb_env/lib/python2.7/_abcoll.py&quot;, line 11, in &lt;module&gt;
    from abc import ABCMeta, abstractmethod
  File &quot;/home/alswl/work/xingtong/myb_env/lib/python2.7/abc.py&quot;, line 8, in &lt;module&gt;
    from _weakrefset import WeakSet
ImportError: No module named _weakrefset
ERROR: The executable myb_env/bin/python is not functioning
ERROR: It thinks sys.prefix is '/home/alswl/work/xingtong' (should be '/home/alswl/work/xingtong/myb_env')
ERROR: virtualenv is not compatible with this system or executable
</code></pre>
<p>STFW ä¹‹åï¼Œæ‰¾åˆ°äº†å¼•å‘é”™è¯¯çš„æ ¹æº<a href="https://github.com/pypa/virtualenv">virtualenv</a>ï¼Œè¿™ä¸ª bug
åœ¨<a href="https://github.com/pypa/virtualenv/issues/76">è¿™é‡Œ</a>å·²ç»ä¿®å¤äº†ã€‚</p>
<pre><code>#!diff
--- a/virtualenv.py        2010-09-14 21:48:58.078562930 +0200
+++ b/virtualenv.py        2010-09-14 21:46:20.650769346 +0200
@@ -51,6 +51,8 @@ REQUIRED_FILES = ['lib-dynload', 'config
</code></pre>
<p>if sys.version_info[:2] &gt;= (2, 6):</p>
<p>REQUIRED_MODULES.extend([&lsquo;warnings&rsquo;, &rsquo;linecache&rsquo;, &lsquo;_abcoll&rsquo;, &lsquo;abc&rsquo;])</p>
<ul>
<li>
<p>if sys.version_info[:2] &gt;= (2, 7):</p>
</li>
<li>
<p>REQUIRED_MODULES.extend([&rsquo;_weakrefset&rsquo;])</p>
</li>
</ul>
<p>if sys.version_info[:2] &lt;= (2, 3):</p>
<p>REQUIRED_MODULES.extend([&lsquo;sets&rsquo;, &lsquo;<strong>future</strong>&rsquo;])</p>
<p>if is_pypy:</p>
<p>æ‡’äººå¯ä»¥ç‚¹å‡»<a href="../../static/images/2011/08/go-pylons.py">go-pylons.py</a>ä¸‹è½½ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>urllib2.urlopençš„ä¸­æ–‡URLé—®é¢˜</title>
      <link>https://blog.alswl.com/2011/06/urllib2-urlopen-unicode/</link>
      <pubDate>Tue, 14 Jun 2011 00:00:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2011/06/urllib2-urlopen-unicode/</guid>
      <description>&lt;p&gt;åœ¨urlä¸­ä½¿ç”¨ä¸­æ–‡å…¶å®æ˜¯ä¸€ä¸ªåä¹ æƒ¯ï¼Œä¼šå¸¦æ¥ä¸€ç³»åˆ—çš„è½¬ç é—®é¢˜ï¼Œ æˆ‘æ›´å–œæ¬¢è‹±æ–‡è¯‘åæˆ–è€…idæ¥æ ‡è¯†æŸä¸ªuriã€‚ä½†æ˜¯ç°å®å¾€å¾€æ˜¯æ®‹é…·çš„ï¼Œ
ç‰¹åˆ«æ˜¯åœ¨æˆ‘ä»¬è°ƒç”¨åˆ«äººæœåŠ¡æ—¶å€™ï¼Œæœ‰æ—¶å€™è¢«é€¼æ— å¥ˆä½¿ç”¨ä¸­æ–‡URLã€‚&lt;/p&gt;
&lt;p&gt;Pythonä¸­unicodeè½¬ç ä¸€å‘æ˜¯è®©äººå¤´ç–¼çš„é—®é¢˜ã€‚æ•°æ¬¡ç¢°å£ä¹‹åï¼Œæˆ‘ä¹Ÿæ‘¸å‡ºäº†ä¸€äº›é—¨é“ï¼Œ
ç ”è¯»å®Œ&lt;a href=&#34;http://ipie.blogbus.com/logs/19379694.html&#34;&gt;Pythonå­—ç¬¦ä¸²çš„encodeä¸decode&lt;/a&gt;
ä¹‹åï¼Œå°±è‡ªè®¤ä¸ºæ‰¾åˆ°äº†ä¸‡é‡‘æ²¹ï¼Œè°çŸ¥é“è¿™æ¬¡åˆç¢°ä¸Šè¿™ä¸ªè€å†¤å®¶ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Traceback (most recent call last):
  File &amp;quot;&amp;lt;stdin&amp;gt;&amp;quot;, line 1, in &amp;lt;module&amp;gt;
  File &amp;quot;/usr/lib/python2.6/urllib2.py&amp;quot;, line 126, in urlopen
    return _opener.open(url, data, timeout)
  File &amp;quot;/usr/lib/python2.6/urllib2.py&amp;quot;, line 391, in open
    response = self._open(req, data)
  File &amp;quot;/usr/lib/python2.6/urllib2.py&amp;quot;, line 409, in _open
    &#39;_open&#39;, req)
  File &amp;quot;/usr/lib/python2.6/urllib2.py&amp;quot;, line 369, in _call_chain
    result = func(*args)
  File &amp;quot;/usr/lib/python2.6/urllib2.py&amp;quot;, line 1170, in http_open
    return self.do_open(httplib.HTTPConnection, req)
  File &amp;quot;/usr/lib/python2.6/urllib2.py&amp;quot;, line 1142, in do_open
    h.request(req.get_method(), req.get_selector(), req.data, headers)
  File &amp;quot;/usr/lib/python2.6/httplib.py&amp;quot;, line 914, in request
    self._send_request(method, url, body, headers)
  File &amp;quot;/usr/lib/python2.6/httplib.py&amp;quot;, line 951, in _send_request
    self.endheaders()
  File &amp;quot;/usr/lib/python2.6/httplib.py&amp;quot;, line 908, in endheaders
    self._send_output()
  File &amp;quot;/usr/lib/python2.6/httplib.py&amp;quot;, line 780, in _send_output
    self.send(msg)
  File &amp;quot;/usr/lib/python2.6/httplib.py&amp;quot;, line 759, in send
    self.sock.sendall(str)
  File &amp;quot;&amp;lt;string&amp;gt;&amp;quot;, line 1, in sendall
UnicodeEncodeError: &#39;ascii&#39; codec can&#39;t encode characters in position 7-8: ordinal not in range(128)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™æ¬¡é”™è¯¯å¼•å‘æ˜¯åœ¨ &lt;code&gt;urlopen()&lt;/code&gt; å¼•èµ·çš„ï¼Œå¾ˆæœ‰ç‰¹è‰²ï¼Œå¼€å§‹ä½¿ç”¨ &lt;code&gt;url.encode(&#39;utf-8&#39;)&lt;/code&gt; å°±å¯ä»¥è§£å†³äº†ã€‚ ä»Šå¤©æˆ‘åšäº†ä¸€äº›æµ‹è¯•ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>åœ¨urlä¸­ä½¿ç”¨ä¸­æ–‡å…¶å®æ˜¯ä¸€ä¸ªåä¹ æƒ¯ï¼Œä¼šå¸¦æ¥ä¸€ç³»åˆ—çš„è½¬ç é—®é¢˜ï¼Œ æˆ‘æ›´å–œæ¬¢è‹±æ–‡è¯‘åæˆ–è€…idæ¥æ ‡è¯†æŸä¸ªuriã€‚ä½†æ˜¯ç°å®å¾€å¾€æ˜¯æ®‹é…·çš„ï¼Œ
ç‰¹åˆ«æ˜¯åœ¨æˆ‘ä»¬è°ƒç”¨åˆ«äººæœåŠ¡æ—¶å€™ï¼Œæœ‰æ—¶å€™è¢«é€¼æ— å¥ˆä½¿ç”¨ä¸­æ–‡URLã€‚</p>
<p>Pythonä¸­unicodeè½¬ç ä¸€å‘æ˜¯è®©äººå¤´ç–¼çš„é—®é¢˜ã€‚æ•°æ¬¡ç¢°å£ä¹‹åï¼Œæˆ‘ä¹Ÿæ‘¸å‡ºäº†ä¸€äº›é—¨é“ï¼Œ
ç ”è¯»å®Œ<a href="http://ipie.blogbus.com/logs/19379694.html">Pythonå­—ç¬¦ä¸²çš„encodeä¸decode</a>
ä¹‹åï¼Œå°±è‡ªè®¤ä¸ºæ‰¾åˆ°äº†ä¸‡é‡‘æ²¹ï¼Œè°çŸ¥é“è¿™æ¬¡åˆç¢°ä¸Šè¿™ä¸ªè€å†¤å®¶ã€‚</p>
<pre><code>Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/lib/python2.6/urllib2.py&quot;, line 126, in urlopen
    return _opener.open(url, data, timeout)
  File &quot;/usr/lib/python2.6/urllib2.py&quot;, line 391, in open
    response = self._open(req, data)
  File &quot;/usr/lib/python2.6/urllib2.py&quot;, line 409, in _open
    '_open', req)
  File &quot;/usr/lib/python2.6/urllib2.py&quot;, line 369, in _call_chain
    result = func(*args)
  File &quot;/usr/lib/python2.6/urllib2.py&quot;, line 1170, in http_open
    return self.do_open(httplib.HTTPConnection, req)
  File &quot;/usr/lib/python2.6/urllib2.py&quot;, line 1142, in do_open
    h.request(req.get_method(), req.get_selector(), req.data, headers)
  File &quot;/usr/lib/python2.6/httplib.py&quot;, line 914, in request
    self._send_request(method, url, body, headers)
  File &quot;/usr/lib/python2.6/httplib.py&quot;, line 951, in _send_request
    self.endheaders()
  File &quot;/usr/lib/python2.6/httplib.py&quot;, line 908, in endheaders
    self._send_output()
  File &quot;/usr/lib/python2.6/httplib.py&quot;, line 780, in _send_output
    self.send(msg)
  File &quot;/usr/lib/python2.6/httplib.py&quot;, line 759, in send
    self.sock.sendall(str)
  File &quot;&lt;string&gt;&quot;, line 1, in sendall
UnicodeEncodeError: 'ascii' codec can't encode characters in position 7-8: ordinal not in range(128)
</code></pre>
<p>è¿™æ¬¡é”™è¯¯å¼•å‘æ˜¯åœ¨ <code>urlopen()</code> å¼•èµ·çš„ï¼Œå¾ˆæœ‰ç‰¹è‰²ï¼Œå¼€å§‹ä½¿ç”¨ <code>url.encode('utf-8')</code> å°±å¯ä»¥è§£å†³äº†ã€‚ ä»Šå¤©æˆ‘åšäº†ä¸€äº›æµ‹è¯•ã€‚</p>
<h2 id="1-ascii--unicode-æµ‹è¯•">1. ascii + unicode æµ‹è¯•</h2>
<pre><code>&gt;&gt;&gt; 'a' + u'b'
&gt;&gt;&gt; 'ä½ ' + u'å¥½'
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
UnicodeDecodeError: 'ascii' codec can't decode byte 0xe4 in position 0: ordinal not in range(128)
&gt;&gt;&gt; u'ä½ ' + u'å¥½'
u'u4f60u597d'
&gt;&gt;&gt; u'a' + 'ä½ ' + u'å¥½'
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
UnicodeDecodeError: 'ascii' codec can't decode byte 0xe4 in position 0: ordinal not in range(128)
</code></pre>
<p>ä¸Šé¢çš„æµ‹è¯•è¯´æ˜asciiç å’Œunicodeç ç›¸è¿æ“ä½œï¼Œç»“è®ºæ˜¯æœ‰ä¸­æ–‡è®°å¾—å¸¦ä¸Šuï¼Œå°±ä¸ä¼šæœ‰é—®é¢˜ã€‚
Pythoné»˜è®¤è§£ç å™¨æ˜¯asciiï¼Œæ— æ³•è§£ç unicodeä¸­çš„ä¸­æ–‡ã€‚</p>
<h2 id="2-urllib2çš„æµ‹è¯•">2. urllib2çš„æµ‹è¯•</h2>
<pre><code>&gt;&gt;&gt; import urllib2
&gt;&gt;&gt; h1 = 'http://baidu.com'
&gt;&gt;&gt; urllib2.urlopen(h1)
&lt;addinfourl at 153439532 whose fp = &lt;socket._fileobject object at 0xb74e51ac&gt;&gt;
&gt;&gt;&gt; h2 = u'http://baidu.com'
&gt;&gt;&gt; urllib2.urlopen(h2)
&lt;addinfourl at 153440236 whose fp = &lt;socket._fileobject object at 0x925912c&gt;&gt;
&gt;&gt;&gt; h3 = 'http://baidu.com?w=æµ‹è¯•'
&gt;&gt;&gt; urllib2.urlopen(h3)
&lt;addinfourl at 153482348 whose fp = &lt;socket._fileobject object at 0x92593ac&gt;&gt;
&gt;&gt;&gt; h4 = u'http://baidu.com?w=æµ‹è¯•'
&gt;&gt;&gt; urllib2.urlopen(h4)
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/lib/python2.6/urllib2.py&quot;, line 126, in urlopen
    return _opener.open(url, data, timeout)
  File &quot;/usr/lib/python2.6/urllib2.py&quot;, line 391, in open
    response = self._open(req, data)
  File &quot;/usr/lib/python2.6/urllib2.py&quot;, line 409, in _open
    '_open', req)
  File &quot;/usr/lib/python2.6/urllib2.py&quot;, line 369, in _call_chain
    result = func(*args)
  File &quot;/usr/lib/python2.6/urllib2.py&quot;, line 1170, in http_open
    return self.do_open(httplib.HTTPConnection, req)
  File &quot;/usr/lib/python2.6/urllib2.py&quot;, line 1142, in do_open
    h.request(req.get_method(), req.get_selector(), req.data, headers)
  File &quot;/usr/lib/python2.6/httplib.py&quot;, line 914, in request
    self._send_request(method, url, body, headers)
  File &quot;/usr/lib/python2.6/httplib.py&quot;, line 951, in _send_request
    self.endheaders()
  File &quot;/usr/lib/python2.6/httplib.py&quot;, line 908, in endheaders
    self._send_output()
  File &quot;/usr/lib/python2.6/httplib.py&quot;, line 780, in _send_output
    self.send(msg)
  File &quot;/usr/lib/python2.6/httplib.py&quot;, line 759, in send
    self.sock.sendall(str)
  File &quot;&lt;string&gt;&quot;, line 1, in sendall
UnicodeEncodeError: 'ascii' codec can't encode characters in position 7-8: ordinal not in range(128)
</code></pre>
<p>è¿™ä¸ªæµ‹è¯•è¯´æ˜ï¼Œ <code>urllib2.urlopen()</code> å¯ä»¥æ¥å—ascii/unicodeçš„è‹±æ–‡ï¼Œä¹Ÿå¯ä»¥æ¥å—asciiçš„ä¸­æ–‡ï¼Œ
ä½†æ˜¯ä¸€æ—¦æ˜¯unicodeçš„ä¸­æ–‡urlï¼Œå°±ä¼šæŠ¥è½¬ç é”™è¯¯ã€‚</p>
<p>soï¼Œè¯·å°½é‡è‹±æ–‡urlï¼Œéè¦ç”¨ä¸­æ–‡ï¼Œè¯·è®°å¾—è½¬ç ã€‚</p>
]]></content:encoded>
    </item>
    <item>
      <title>ä¸€ä¸ªmako.vim</title>
      <link>https://blog.alswl.com/2011/06/mako-vim/</link>
      <pubDate>Thu, 09 Jun 2011 00:00:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2011/06/mako-vim/</guid>
      <description>&lt;p&gt;ç»™Vimæ‰¾äº†ä¸€ä¸ªMakoçš„è¯­æ³•é«˜äº®ï¼Œå‘ç°ç€è‰²å±…ç„¶æœ‰é—®é¢˜ã€‚æŸ¥çœ‹æ›´æ–°è®°å½•åå‘ç°ä½œè€…&lt;a href=&#34;http://lucumr.pocoo.org/&#34;&gt;Armin Ronacher&lt;/a&gt;åªæ›´æ–°åˆ°08å¹´9æœˆä»½ã€‚ä¹‹åMakoæ›´æ–°äº†ä¸€äº›å°‘è®¸ç»†èŠ‚ï¼Œæˆ‘ä¿®æ”¹äº†ä¸€ä¸‹mako.vimï¼Œæ”¾åœ¨è¿™é‡Œä¾›ä¸‹è½½ã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®æˆ‘åªæ”¹äº†57/58è¡Œï¼Œå¢åŠ ä¸€ä¸ªblockè¯­æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ç‚¹å‡»è¿™é‡Œä¸‹è½½ï¼š&lt;a href=&#34;../../static/images/upload_dropbox/201106/mako.vim&#34;&gt;mako.vim&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨æ–¹æ³•ï¼Œæ”¾å…¥vimfiles/syntax&lt;/p&gt;
&lt;p&gt;ç›¸å…³é“¾æ¥ï¼š&lt;/p&gt;
&lt;p&gt;åŸå§‹mako.vimï¼š&lt;a href=&#34;http://www.vim.org/scripts/script.php?script_id=1858&#34;&gt;http://www.vim.org/scripts/script.php?script_id=1858&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤–ä¸€ä¸ªmako.vimæ˜¯ç¼©è¿›ç”¨çš„ï¼Œæ”¾å…¥vimfiles/syntaxï¼š&lt;a href=&#34;http://www.vim.org/scripts/script.php?script_id=2663&#34;&gt;http://www.vim.org/scripts/script.php?script_id=2663&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;psï¼šMakoæ˜¯ä¸€ä¸ªPythonä¸‹é¢çš„Templateæ¡†æ¶ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>ç»™Vimæ‰¾äº†ä¸€ä¸ªMakoçš„è¯­æ³•é«˜äº®ï¼Œå‘ç°ç€è‰²å±…ç„¶æœ‰é—®é¢˜ã€‚æŸ¥çœ‹æ›´æ–°è®°å½•åå‘ç°ä½œè€…<a href="http://lucumr.pocoo.org/">Armin Ronacher</a>åªæ›´æ–°åˆ°08å¹´9æœˆä»½ã€‚ä¹‹åMakoæ›´æ–°äº†ä¸€äº›å°‘è®¸ç»†èŠ‚ï¼Œæˆ‘ä¿®æ”¹äº†ä¸€ä¸‹mako.vimï¼Œæ”¾åœ¨è¿™é‡Œä¾›ä¸‹è½½ã€‚</p>
<p>å…¶å®æˆ‘åªæ”¹äº†57/58è¡Œï¼Œå¢åŠ ä¸€ä¸ªblockè¯­æ³•ã€‚</p>
<p>ç‚¹å‡»è¿™é‡Œä¸‹è½½ï¼š<a href="../../static/images/upload_dropbox/201106/mako.vim">mako.vim</a></p>
<p>ä½¿ç”¨æ–¹æ³•ï¼Œæ”¾å…¥vimfiles/syntax</p>
<p>ç›¸å…³é“¾æ¥ï¼š</p>
<p>åŸå§‹mako.vimï¼š<a href="http://www.vim.org/scripts/script.php?script_id=1858">http://www.vim.org/scripts/script.php?script_id=1858</a></p>
<p>å¦å¤–ä¸€ä¸ªmako.vimæ˜¯ç¼©è¿›ç”¨çš„ï¼Œæ”¾å…¥vimfiles/syntaxï¼š<a href="http://www.vim.org/scripts/script.php?script_id=2663">http://www.vim.org/scripts/script.php?script_id=2663</a></p>
<p>psï¼šMakoæ˜¯ä¸€ä¸ªPythonä¸‹é¢çš„Templateæ¡†æ¶ã€‚</p>
<p>pssï¼šè²Œä¼¼æœåŠ¡å™¨ipè¢«è®¤è¯äº†ï¼Œè®¨åŒ~</p>
]]></content:encoded>
    </item>
    <item>
      <title>Eclipseä¸­è¿è¡ŒPylons</title>
      <link>https://blog.alswl.com/2011/05/run-pylons-in-eclipse/</link>
      <pubDate>Mon, 16 May 2011 00:00:00 +0800</pubDate>
      <guid>https://blog.alswl.com/2011/05/run-pylons-in-eclipse/</guid>
      <description>&lt;p&gt;å®˜æ–¹ä¸­pylonséƒ½æ˜¯é€šè¿‡åœ¨shellä¸­è¿è¡Œpaster serve &amp;ndash;reload
development.iniæ¥è¿è¡Œåº”ç”¨å®ä¾‹ã€‚è€Œæ•´å¤©åœ¨ä»»åŠ¡æ è·‘ç€ä¸€ä¸ªé»‘ä¹ä¹çš„shellå¾ˆç¢çœ¼ï¼Œé€šè¿‡ä¸€ä¸‹æ­¥éª¤å¯ä»¥åœ¨Eclipseä¸­è¿è¡Œpylonsã€‚&lt;/p&gt;
&lt;p&gt;é…ç½®Run Configuration - Python Runå¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;Mainé¡µç­¾ä¸­Main ModuleæŒ‡å‘paster-script.pyï¼Œå¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚&lt;/p&gt;
&lt;p&gt;




&lt;img loading=&#34;lazy&#34; src=&#34;https://blog.alswl.com/images/upload_dropbox/201105/eclipse-main.png&#34; alt=&#34;image&#34;  /&gt;


&lt;/p&gt;
&lt;p&gt;é…ç½®Argumentsé¡µç­¾çš„å‚æ•°ï¼Œæ·»åŠ serve &amp;ndash;reload development.iniï¼Œåé¢çš„inié…ç½®æ–‡ä»¶å¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>å®˜æ–¹ä¸­pylonséƒ½æ˜¯é€šè¿‡åœ¨shellä¸­è¿è¡Œpaster serve &ndash;reload
development.iniæ¥è¿è¡Œåº”ç”¨å®ä¾‹ã€‚è€Œæ•´å¤©åœ¨ä»»åŠ¡æ è·‘ç€ä¸€ä¸ªé»‘ä¹ä¹çš„shellå¾ˆç¢çœ¼ï¼Œé€šè¿‡ä¸€ä¸‹æ­¥éª¤å¯ä»¥åœ¨Eclipseä¸­è¿è¡Œpylonsã€‚</p>
<p>é…ç½®Run Configuration - Python Runå¦‚ä¸‹ã€‚</p>
<p>Mainé¡µç­¾ä¸­Main ModuleæŒ‡å‘paster-script.pyï¼Œå¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚</p>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201105/eclipse-main.png" alt="image"  />


</p>
<p>é…ç½®Argumentsé¡µç­¾çš„å‚æ•°ï¼Œæ·»åŠ serve &ndash;reload development.iniï¼Œåé¢çš„inié…ç½®æ–‡ä»¶å¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚</p>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201105/eclipse-arguments.png" alt="image"  />


</p>
<p>å‹¾é€‰Commonä¸‹çš„Allocate Consoleæ¥è¿›è¡Œpasterè°ƒè¯•ä¿¡æ¯è¾“å‡ºã€‚</p>
<p>åœ¨Windows - Preference - Pydev - Interpreter - Pythonä¸­çš„PYTHONPATHåŠ å…¥pylonsç›®æ ‡ç¯å¢ƒ
ï¼ŒæŠ¥è¿‡site-packagesç›®å½•å’Œsite-packagesç›®å½•ä¸‹é¢çš„eggæ–‡ä»¶ï¼ˆç†è§£ä¸ºjaråŒ…ï¼Œç§°ä¹‹ä¸ºèŸ’è›‡è›‹ï¼‰ã€‚</p>
<p>ä¸å‡ºæ„å¤–çš„è¯ï¼Œå°±å¯ä»¥é€šè¿‡Runè·‘èµ·æ•´ä¸ªåº”ç”¨äº†ã€‚</p>
<p>å¾ˆå¯æƒœçš„æ˜¯ï¼Œè¿™æ ·åšè¿˜æ˜¯ä¸èƒ½å¯¹åº”ç”¨è¿›è¡ŒDebugï¼Œpylonsçš„debugä¾ç„¶ä¾èµ–äºpylonsçš„&quot;äº¤äº’è°ƒè¯•é¡µé¢&quot;ã€‚</p>
<p>å‚è€ƒ[http://stackoverflow.com/questions/147650/debug-pylons-application-through-
eclipse](<a href="http://stackoverflow.com/questions/147650/debug-pylons-application-">http://stackoverflow.com/questions/147650/debug-pylons-application-</a>
through-eclipse)</p>
]]></content:encoded>
    </item>
  </channel>
</rss>
