<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>coding | Log4D</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="author" content="alswl">
<link rel="canonical" href="https://blog.alswl.com/categories/coding/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8a8fb2252e3b86ff50510aea076c0754a4ac19e57254bb71b15cc554106148fb.css" integrity="sha256-io&#43;yJS47hv9QUQrqB2wHVKSsGeVyVLtxsVzFVBBhSPs=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://blog.alswl.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.alswl.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.alswl.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://blog.alswl.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://blog.alswl.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://blog.alswl.com/categories/coding/rss.xml">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7S40P40QGJ"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-7S40P40QGJ', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="coding" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://blog.alswl.com/categories/coding/" /><meta property="og:site_name" content="Log4D" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="coding"/>
<meta name="twitter:description" content=""/>

</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.alswl.com" accesskey="h" title="Log4D (Alt + H)">Log4D</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://en.blog.alswl.com/" title="English Blog">
                    <span>English Blog</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://blog.alswl.com/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://blog.alswl.com/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://blog.alswl.com/archives/" title="存档">
                    <span>存档</span>
                </a>
            </li>
            <li>
                <a href="https://blog.alswl.com/about/" title="关于我">
                    <span>关于我</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="https://blog.alswl.com">Home</a>&nbsp;»&nbsp;<a href="https://blog.alswl.com/categories/">Categories</a></div>
  <h1>
    coding
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>在 Python 中使用 epoll[译文]
    </h2>
  </header>
  <div class="entry-content">
    
    
    
    <p>原文地址： http://scotdoyle.com/python-epoll-howto.html ， 我这里取精简内容翻译过来。 ============ 正文开始 ============ 介绍 Python 从 2.6 开始支持 epoll。现在我们用 Python3 来写基于这些 API 的 epoll 范例。 阻塞的 Socket 通信范例 import socket EOL1 = b&#39;\n\n&#39; EOL2 = b&#39;\n\r\n&#39; response = b&#39;HTTP/1.0 200 OK\r\ndate: &#34;2013-01-12T00:01:00&#43;08:00&#34; response &#43;= b&#39;Content-Type: text/plain\r\nContent-Length: 13\r\n\r\n&#39; response &#43;= b&#39;Hello, world!&#39; serversocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM) serversocket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) serversocket.bind((&#39;0.0.0.0&#39;, 8080)) serversocket.listen(1) try: while True: connectiontoclient, address = serversocket.accept() request = b&#39;&#39; while EOL1 not in request and EOL2 not in request: request &#43;= connectiontoclient.recv(1024) print(&#39;-&#39;*40 &#43; &#39;\n&#39; &#43; request.decode()[:-2]) connectiontoclient.send(response) connectiontoclient.close() finally: serversocket.close() 这个范例中的代码在 accept() 、 recv() 和 send() 时候会发生阻塞， 导致其他连接无法完成。 通常情况下，在我们使用阻塞模型时候，会专门建立一个主线程来进行监听， 将...</p>
  </div>
  <footer class="entry-footer">&lt;span title=&#39;2013-01-12 00:01:00 &#43;0800 &#43;0800&#39;&gt;2013-01-12&lt;/span&gt;&amp;nbsp;·&amp;nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to 在 Python 中使用 epoll[译文]" href="https://blog.alswl.com/2013/01/python-epoll/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>如何让 Instagram 在一百多万用户爆炸后稳定运行
    </h2>
  </header>
  <div class="entry-content">
    
    
    
    <p>原文链接：Keeping Instagram up with over a million new users in twelve hours 这周二我们发布了 Instagram for Android，反响空前强烈。 最近这几周我们一直（在基础设施方面）做负载计划，为所有可能发生的事故做准备。 尽管如此，在发布那天，最大的挑战仍然是如何快速定位问题，找到瓶颈并尽快修复他们。 在这里我们将分享一些帮助我们解决问题的工具和技术。 ##statsd## statsd 在 Instagram 很受欢迎。这是 Etsy 写的一个网络监控器， 能够统计并图形化数据。它有两种核心的统计方式：计数器和...</p>
  </div>
  <footer class="entry-footer">&lt;span title=&#39;2012-11-19 00:06:00 &#43;0800 &#43;0800&#39;&gt;2012-11-19&lt;/span&gt;&amp;nbsp;·&amp;nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to 如何让 Instagram 在一百多万用户爆炸后稳定运行" href="https://blog.alswl.com/2012/11/keeping-instagram-up-with-over-a-million-new-users-in-twelve-hours/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>KuKu-一个 Weekend Project
    </h2>
  </header>
  <div class="entry-content">
    
    
    <div class="thumbnail"><img src="https://e25ba8-log4d-c.dijingchao.com/images/upload_dropbox/201211/kuku.png" alt="Thumbnail" /></div>
    
    
    <p>一个小小的 Weekend Project，基于 web.py。 代码在 alswl / kuku ，很简陋，属于差不多能用阶段。 基于以下原因开发： 想把服务器去 PHP 化，以前的 upload.log4d.com 是基于 PHP 的， 详情请见 使用独立图床子域名。 刚买的 Linode VPS，终于从 128MB 内存解放出来了，赶紧放个 Python 程序跑跑。 想些 Python 了，手痒，想看看写这么简单的功能需要多长时间， 弥补上次没能参加黑客马拉松的遗憾。 KuKu 的发音是我家乡话的「看看」。 KuKu 中比较有趣的地方是，用了 Foundation 这个流式 Web 前端框架， 用了...</p>
  </div>
  <footer class="entry-footer">&lt;span title=&#39;2012-11-18 22:31:00 &#43;0800 &#43;0800&#39;&gt;2012-11-18&lt;/span&gt;&amp;nbsp;·&amp;nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to KuKu-一个 Weekend Project" href="https://blog.alswl.com/2012/11/kuku/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>PyCon 2012 见闻
    </h2>
  </header>
  <div class="entry-content">
    
    
    <div class="thumbnail"><img src="https://e25ba8-log4d-c.dijingchao.com/images/upload_dropbox/201210/PyConChina2012.png" alt="Thumbnail" /></div>
    
    
    <p>PyCon 是 Python 领域最著名的技术会议，从 2011 年开始，中国区开始举办自己的 PyCon 大会。这次 PyCon 2012 分成两个场地同时进行，北京和上海， 并且在网上提供同步转播，各地也有组织线下收看的。 去年时候我很遗憾的不能跑到上海来参加，现在我人就在上海， 怎能错过 Pythoner 的饕餮大餐呢？早就眼巴巴的买票准备参加了。 上海这边的主题如下： 《Python 产品构建与发布指南》- 沈崴 《实战游戏客户端》 - 林伟 《让程序运行更快》- 李小红 《演进或革命 - 选型和架构...</p>
  </div>
  <footer class="entry-footer">&lt;span title=&#39;2012-10-21 21:15:00 &#43;0800 &#43;0800&#39;&gt;2012-10-21&lt;/span&gt;&amp;nbsp;·&amp;nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to PyCon 2012 见闻" href="https://blog.alswl.com/2012/10/pycon-2012/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>Working with Python subprocess[译文]
    </h2>
  </header>
  <div class="entry-content">
    
    
    <div class="thumbnail"><img src="https://e25ba8-log4d-c.dijingchao.com/images/upload_dropbox/201209/Stdstreams-notitle.svg.png" alt="Thumbnail" /></div>
    
    
    <p>8月底到魔都开始新工作，头一个月当然各种忙，都没时间来更新博客。 这篇文章是在写 Btrace 脚本时候查资料看到的， 看着不错就顺手翻译，没想到差点烂在草稿箱出不来啊出不来。 熬了一个月才磨出来，媳妇都快成婆了有木有。 原文链接：Working with Python subprocess - Shells, Processes, Streams, Pipes, Redirects and More 注意 关于「执行命令时候发生了什么」这个问题，可以在 http://en.wikipedia.org/wiki/Redirection_(computing) 找到更多最新信息。这篇文章遵循 GFDL 协议。 在我的上一篇日志中，我写到如何 build a command line interface with sub-commands in Python。 这次...</p>
  </div>
  <footer class="entry-footer">&lt;span title=&#39;2012-10-16 00:42:00 &#43;0800 &#43;0800&#39;&gt;2012-10-16&lt;/span&gt;&amp;nbsp;·&amp;nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to Working with Python subprocess[译文]" href="https://blog.alswl.com/2012/10/working-with-python-subprocess/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>MoinMoin Wiki 转换 Text 脚本
    </h2>
  </header>
  <div class="entry-content">
    
    
    
    <p>我使用 MoinMoin 作为我的 KMS，具体使用方式可以参考 [使用MoinMoin作为个人KMS][moin-kms]。另外，我将 MoinMoin 的 data 目录链接到 Dropbox 同步目录下面，从而可以备份并查看我的知识库。 我想同步阅读 KMS 数据 想在移动设备阅读 KMS 数据时，我遇到一个麻烦，MoinMoin 使用文件来保存 wiki 数据， 比如「28个Unix.Linux的命令行神器」这篇 wiki 目录在 data/28(e4b8aa)Unix(2e)Linux(e79a84e591bde4bba4e8a18ce7a59ee599a8) 中， 结构如下： |---revisions | |---00000002 | |---00000001 |---edit-log |---current |---attachments | |---http___coolshell.cn_wp-content_uploads_2012_07_xargs_screenshot.png | |---http___coolshell.cn_wp-content_uploads_2012_07_sl.jpg | |---http___coolshell.cn_wp-content_uploads_2012_07_mtr_screenshot.png | |---http___coolshell.cn_wp-content_uploads_2012_07_lftp_screenshot.png | |---http___coolshell.cn_wp-content_uploads_2012_07_htop_screenshot.png | |---http___coolshell.cn_wp-content_uploads_2012_07_calcurse_screenshot.png | |---http___coolshell.cn_wp-content_uploads_2012_07_multitail_screenshot.png | |---http___coolshell.cn_wp-content_uploads_2012_07_ack_screenshot.png | |---http___coolshell.cn_wp-content_uploads_2012_07_tpp_screenshot.png...</p>
  </div>
  <footer class="entry-footer">&lt;span title=&#39;2012-07-27 09:02:00 &#43;0800 &#43;0800&#39;&gt;2012-07-27&lt;/span&gt;&amp;nbsp;·&amp;nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to MoinMoin Wiki 转换 Text 脚本" href="https://blog.alswl.com/2012/07/moin2txt/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>服务器 Push 技术
    </h2>
  </header>
  <div class="entry-content">
    
    
    
    <p>服务器 Push 技术表示服务器可以主动推送消息给客户端浏览器。 实现方式 Comet Ajax 轮询 iframe / htmlfile script tag （不中断的连续请求） Flash 通讯 WebSocket Comet 本意是彗星，彗星尾巴痕迹很像长连接工作方式，所以 Comet 指代长连接。 在 Ajax 轮询的分类上，存在一些分歧，这里我把轮询认为一种 Comet 方式。 ps：「长连接」在一些场景下，是另外一种意义「HTTP: Keep alive」。不在本文讨论的范围中。 参考链接： Comet：基于 HTTP 长连接的「服务器推」技术 Socket.IO Supported transports 浏览器支持情况 WebSocket...</p>
  </div>
  <footer class="entry-footer">&lt;span title=&#39;2012-05-30 10:40:00 &#43;0800 &#43;0800&#39;&gt;2012-05-30&lt;/span&gt;&amp;nbsp;·&amp;nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to 服务器 Push 技术" href="https://blog.alswl.com/2012/05/comet/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>让 Octopress 支持 RSS2.0
    </h2>
  </header>
  <div class="entry-content">
    
    
    
    <p>土鳖人人网的 日志导入 功能仅支持 RSS2.0，而 Octopress 输出的订阅格式是 Atom1.0。 于是为了让人人网的同学能看见我那些技术宅，又或非技术宅的文章， 我只能昧着良心，给 Octopress 加上过时的 RSS2.0 输出。 在 source/ 下创建新文件 rss.xml ，内容如下： --- layout: nil --- &lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt; &lt;rss xmlns:dc=&#34;http://purl.org/dc/elements/1.1/&#34; version=&#34;2.0&#34;&gt; &lt;channel&gt; &lt;description&gt;&lt;![CDATA[{{ site.title }}]]&gt;&lt;/description&gt; &lt;title&gt;&lt;![CDATA[{{ site.title }}]]&gt;&lt;/title&gt; &lt;link&gt;{{ site.url }}/&lt;/link&gt; &lt;pubDate&gt;{{ site.time | date_to_xmlschema }}&lt;/pubDate&gt; {% for post in site.posts limit: 20 %} &lt;item&gt; &lt;description&gt; &lt;![CDATA[ {{ post.content | expand_urls: site.url | cdata_escape }} {% include post/copyright.html %} ]]&gt; &lt;/description&gt; &lt;title&gt;&lt;![CDATA[{{ post.title | cdata_escape }}]]&gt;&lt;/title&gt; &lt;link&gt;{{ site.url }}{{ post.url }}&lt;/link&gt; &lt;pubDate&gt;{{ post.date | date_to_xmlschema }}&lt;/pubDate&gt; &lt;guid isPermaLink=&#34;false&#34;&gt;{{ site.url }}{{ post.id }}&lt;/guid&gt; &lt;source url=&#34;{{ site.url }}/rss.xml&#34;&gt;&lt;![CDATA[{{ site.title }}]]&gt;&lt;/source&gt; &lt;/item&gt; {% endfor %} &lt;/channel&gt; &lt;/rss&gt; 然后，访问 http://site.url/rss.xml 即可。 我的 RSS2.0...</p>
  </div>
  <footer class="entry-footer">&lt;span title=&#39;2012-05-22 16:18:00 &#43;0800 &#43;0800&#39;&gt;2012-05-22&lt;/span&gt;&amp;nbsp;·&amp;nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to 让 Octopress 支持 RSS2.0" href="https://blog.alswl.com/2012/05/support-rss/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>给 Octopress 加上标签功能
    </h2>
  </header>
  <div class="entry-content">
    
    
    
    <p>上周，我将 Log4D 由 Wordpress 转换为 Octopress，略加打理，颇为顺手。 自动分类 / 评论转移 / 代码高亮 / 图床 的问题一一解决之后， 就只剩下 tag 的问题没有搞定了。 我当时使用了YORKXIN的修改版本来处理 Wordpress 的数据迁移，这个脚本很好用，数据没有遗失，甚至是让我担心的 category / tag 都给予了保留。具体使用方法可以参见从Wordpress迁移到Octopress。 只是虽然 tag 的数据保留了，但是 Octopress 仅支持 category 的分类，而完全忽略 tag。这是...</p>
  </div>
  <footer class="entry-footer">&lt;span title=&#39;2012-05-21 15:17:00 &#43;0800 &#43;0800&#39;&gt;2012-05-21&lt;/span&gt;&amp;nbsp;·&amp;nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to 给 Octopress 加上标签功能" href="https://blog.alswl.com/2012/05/tag-cloud/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2>关于 NetworkManager / PolicyKit / ConsoleKit 的那些屌事
    </h2>
  </header>
  <div class="entry-content">
    
    
    <div class="thumbnail"><img src="https://e25ba8-log4d-c.dijingchao.com/images/upload_dropbox/201205/insufficient-privileges.png" alt="Thumbnail" /></div>
    
    
    <p>在使用 Awesome 的过程中，我又遇到了一个老问题「NetworkManager 在非 Gnome 环境启动后，会无法 添加 / 删除 / 编辑 无线连接」。明眼人一看就知道， 这是权限的问题。 问题描述 我的环境是 ArchLinux / xmonad 0.10 / awesome v3.4.11 / GDM 3.4.1 / NetworkManager 0.9.4.0， 下面我用 awesome 做示例，其他非 Gnome WM 也应该是类似配置。 我的 WM 启动流程是： 通过 GDM 启动 xmonad / awesome，启动 xsession 是 /usr/share/xsessions/awesome.desktop， 内容如下 [Desktop Entry]...</p>
  </div>
  <footer class="entry-footer">&lt;span title=&#39;2012-05-17 09:07:00 &#43;0800 &#43;0800&#39;&gt;2012-05-17&lt;/span&gt;&amp;nbsp;·&amp;nbsp;alswl</footer>
  <a class="entry-link" aria-label="post link to 关于 NetworkManager / PolicyKit / ConsoleKit 的那些屌事" href="https://blog.alswl.com/2012/05/networkmanager-policykit-consolekit/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="https://blog.alswl.com/categories/coding/page/3/">
      «&nbsp;Prev&nbsp;
    </a>
    <a class="next" href="https://blog.alswl.com/categories/coding/page/5/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://blog.alswl.com">Log4D</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
