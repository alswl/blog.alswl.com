<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>如何免费用云服务搭建博客评论系统 | Log4D</title>
<meta name="keywords" content="blog, hugo, waline, utterances, cusdis">
<meta name="description" content="问题
博客自 2012 年从 WordPress 迁移到静态站点后，就选择了 Disqus 作为评论系统。
但最近 Disqus 硬广告过于频繁，迫切寻找新的评论系统。
Disqus 官方 明确说明，要去掉广告就付费。

What if I want to remove Ads?
If you&rsquo;d like to remove Disqus Ads from your integration, you may purchase and ads-free subscription from your Subscription and Billing page. More information on Disqus ads-free subscriptions may be found here.

OK，那再见吧 Disqus，我会找到可靠、免费、易用的评论系统。
最后既然是寻找新的评论系统，现在 2023 年了，
我希望这个新系统充分使用云服务的便利，要做到
免费、可靠、易运维。









选型原则
在进入探索之前，我先梳理一下自己的原则和选型要求：">
<meta name="author" content="alswl">
<link rel="canonical" href="https://blog.alswl.com/2023/11/build-blog-comment-system-based-on-free-cloud-service/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fd393d9f5641ed4046d063ea612203db6fe6a48fb1ef59a1359076d0c2ed9022.css" integrity="sha256-/Tk9n1ZB7UBG0GPqYSID22/mpI&#43;x71mhNZB20MLtkCI=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://blog.alswl.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.alswl.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.alswl.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://blog.alswl.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://blog.alswl.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="text/markdown" href="https://blog.alswl.com/2023/11/build-blog-comment-system-based-on-free-cloud-service/index.md">
<link rel="alternate" hreflang="en" href="https://blog.alswl.com/2023/11/build-blog-comment-system-based-on-free-cloud-service/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-7S40P40QGJ"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-7S40P40QGJ');
        }
      </script><meta property="og:title" content="如何免费用云服务搭建博客评论系统" />
<meta property="og:description" content="问题
博客自 2012 年从 WordPress 迁移到静态站点后，就选择了 Disqus 作为评论系统。
但最近 Disqus 硬广告过于频繁，迫切寻找新的评论系统。
Disqus 官方 明确说明，要去掉广告就付费。

What if I want to remove Ads?
If you&rsquo;d like to remove Disqus Ads from your integration, you may purchase and ads-free subscription from your Subscription and Billing page. More information on Disqus ads-free subscriptions may be found here.

OK，那再见吧 Disqus，我会找到可靠、免费、易用的评论系统。
最后既然是寻找新的评论系统，现在 2023 年了，
我希望这个新系统充分使用云服务的便利，要做到
免费、可靠、易运维。









选型原则
在进入探索之前，我先梳理一下自己的原则和选型要求：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.alswl.com/2023/11/build-blog-comment-system-based-on-free-cloud-service/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-25T17:23:35+08:00" />
<meta property="article:modified_time" content="2023-11-25T17:23:35+08:00" /><meta property="og:site_name" content="Log4D" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="如何免费用云服务搭建博客评论系统"/>
<meta name="twitter:description" content="问题
博客自 2012 年从 WordPress 迁移到静态站点后，就选择了 Disqus 作为评论系统。
但最近 Disqus 硬广告过于频繁，迫切寻找新的评论系统。
Disqus 官方 明确说明，要去掉广告就付费。

What if I want to remove Ads?
If you&rsquo;d like to remove Disqus Ads from your integration, you may purchase and ads-free subscription from your Subscription and Billing page. More information on Disqus ads-free subscriptions may be found here.

OK，那再见吧 Disqus，我会找到可靠、免费、易用的评论系统。
最后既然是寻找新的评论系统，现在 2023 年了，
我希望这个新系统充分使用云服务的便利，要做到
免费、可靠、易运维。









选型原则
在进入探索之前，我先梳理一下自己的原则和选型要求："/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://blog.alswl.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "如何免费用云服务搭建博客评论系统",
      "item": "https://blog.alswl.com/2023/11/build-blog-comment-system-based-on-free-cloud-service/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "如何免费用云服务搭建博客评论系统",
  "name": "如何免费用云服务搭建博客评论系统",
  "description": "问题 博客自 2012 年从 WordPress 迁移到静态站点后，就选择了 Disqus 作为评论系统。 但最近 Disqus 硬广告过于频繁，迫切寻找新的评论系统。\nDisqus 官方 明确说明，要去掉广告就付费。\nWhat if I want to remove Ads? If you\u0026rsquo;d like to remove Disqus Ads from your integration, you may purchase and ads-free subscription from your Subscription and Billing page. More information on Disqus ads-free subscriptions may be found here.\nOK，那再见吧 Disqus，我会找到可靠、免费、易用的评论系统。 最后既然是寻找新的评论系统，现在 2023 年了， 我希望这个新系统充分使用云服务的便利，要做到 免费、可靠、易运维。\n选型原则 在进入探索之前，我先梳理一下自己的原则和选型要求：\n",
  "keywords": [
    "blog", "hugo", "waline", "utterances", "cusdis"
  ],
  "articleBody": "问题 博客自 2012 年从 WordPress 迁移到静态站点后，就选择了 Disqus 作为评论系统。 但最近 Disqus 硬广告过于频繁，迫切寻找新的评论系统。\nDisqus 官方 明确说明，要去掉广告就付费。\nWhat if I want to remove Ads? If you’d like to remove Disqus Ads from your integration, you may purchase and ads-free subscription from your Subscription and Billing page. More information on Disqus ads-free subscriptions may be found here.\nOK，那再见吧 Disqus，我会找到可靠、免费、易用的评论系统。 最后既然是寻找新的评论系统，现在 2023 年了， 我希望这个新系统充分使用云服务的便利，要做到 免费、可靠、易运维。\n选型原则 在进入探索之前，我先梳理一下自己的原则和选型要求：\n数据自有是核心要求 确保评论数据完全归属于博主，不会因为使用第三方服务而失去对数据的控制。 服务部署和存储是难点 考虑到服务的稳定性和成本，选择一个易于部署且存储成本较低的方案。 访问速度是考虑项 评论系统的访问速度直接关系到用户体验， 因此需要选择一个能够提供较快访问速度的系统。 从功能上面分析需要的能力：\n邮件通知 Markdown 内容安全：No Injection 评论审核和删除 授权登录（Optional） 非功能需求：\n低成本：控制在 12 元 / 年 系统稳定 通过明晰这些原则和要求，可以更有针对性地选择合适的评论系统，确保满足核心功能和非功能需求。接下来，将根据这些原则，继续探讨如何选择和搭建评论系统。\n初步方案探索 现在我们初步试验一些方案并进行一些探索，以方便我们熟悉一下当前常见系统的特性和水准。\nutterances 经常见到的一个评论系统，流行于程序员群体，基于 Github Issues 系统因此免费，需要使用 Github 账号登录 7.8k star 托管在 Github Issues Twikoo 国产方案，基于云服务展开，需要寻找云函数部署环境（大部分收费） 880 star Cusdis 国产方案，提供免费的 Cloud 服务（但是额度比较受限） 2.4k star 支持迁移 手工通过评论 活跃度不高 我同时还看了一些外部的一些方案评测报告：\nComments | Hugo 静态博客评论系统的选择 - 腾讯云开发者社区-腾讯云 轻量级开源免费博客评论系统解决方案 （Cusdis + Railway） - 少数派 根据初步方案探索，我可以明确部署形态基本如下：\n横向对比 这是一个横向对比表格，列举我一些关心的特性以及候选者在这些特性方面的表现。除了上述提到几款常见软件， 我还额外调研了海外常用的评论 SaaS 服务：\nName self-host Official SaaS SaaS Free Star Import Disqus export data Comments Utterances x v v 7.8k v Github account required Cusdis v v v? 2.3k v v? import from Disqus failed Cactus Comments v v 100 Matrix Protocol, blocked Commento x v $10/month v v Graph Comment v Free to $7 Hyvor Talk x v $12/month IntenseDebate v ? x too old Isso v x 4.8k v sqlite storage Mutt v $16/month Remark42 v x 4.3k v v full featured, one file storage ReplyBox v $5/month Staticman v 2.3k v using github as storage Talkyard v €4.5/ month Waline v 1.5k v v Multi Storage / Service Provider supported Twikoo v x 1.1k v v FaaS / MongoDB 根据横向对比我们可以得出几个结论：\n海外传统评论系统数据透明度低，风格也是是古早型系统 官方提供 SaaS 服务普遍需要收费 self-host 的几个产品需要自己搭建服务，没有一键使用免费的 Cloud Provider 路径 小结\n符合我需求的几款产品是：Utterances、Cusdis、Waline。\nPoC 和实施 我最后选择了 utterances 和 Waline 进行 PoC， 其中我的英文博客使用了 utterances， 中文博客使用了 Waline。\n为什么不选择 Cusdis 和 Twikoo？因为 Cusdis 使用 PostgreSQL， 而 Twikoo 存储使用腾讯云函数（免费额度有限）或者 MongoDB， 存储上 Waline 选择更多。 另外，作为同类型方案，Waline 是三者贡献者数量最多的，Commit 数量也最多， 社区更有保障。\nWaline 实施 一个搞笑的点，如果这里使用 h3 标题叫做「Waline」，会直接在这里插入一个当前博客的评论框\n优点 多平台部署 多数据库支持（MongoDB、sqlite、PostgreSQL、MySQL） 评论功能强大 导入工具 活跃度尚可 缺点 功能太多，不够克制（好在可以自定义配置） 国产产品 接入流程： 找个 Storage 供应商（我选择 LeanCloud） 找个 Server 供应商部署（我选择 Vercel） 找个邮件发送供应商（我选择了 Brevo（原来叫 SendinBlue）） 前端部署（Hugo 内集成一下） 部署图：\n具体操作，跟随官方文档即可：\n快速上手 | Waline Vercel 部署 | Waline 绑定 CName 导入数据 转换 数据迁移助手 | Waline 导入 https://console.leancloud.app/apps/yours/storage/import-export 配置页面 参考配置系统禁用一些评论功能 https://waline.js.org/reference/client/props.html 启用 SMTP 配置 AUTHOR_EMAIL 配置 SENDER_NAME 配置 SENDER_EMAIL 服务端配置 https://waline.js.org/reference/server/config.html#tgtemplate 遇到的问题 Disqus 导出的用户数据没有邮箱，导致 gravatar 没有照片显示，无解 邮箱配置需要额外配置环境变量，否则会暴露自己的个人邮箱 实施 PR（仅包含前端，因为后端代码包含了密钥，不便于分享）： feat: comments on waline · alswl/blog.alswl.com@e34e348\nUtterances 实施 utterances 的部署则更为简单，一个 PR 就可以启用。 feat: comment using utteranc · alswl/en.blog.alswl.com@29028f6 (github.com)\n也没有什么特色，主打简单省事，考虑我英文博客访问量极低，就简单方案。\n小结 最后我选择了 Waline / utterances 作为我的评论系统，两者的部署成本都是 0。\n妥协牺牲了一些访问速度、安全性，但进一步增强了数据可控性，完成了 self-host。 从稳定性上面来看，尽管这个系统链路变复杂了，单机上也存在可用性风险， 但依托 Vercel / LeanCloud / Brevo 三家 SaaS 服务商，整体风险可控。\n毕竟只是一个小小评论系统，0 成本 + 正常工作就行了。\n欢迎在下面评测测试一下哦~\n",
  "wordCount" : "1904",
  "inLanguage": "en",
  "datePublished": "2023-11-25T17:23:35+08:00",
  "dateModified": "2023-11-25T17:23:35+08:00",
  "author":{
    "@type": "Person",
    "name": "alswl"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://blog.alswl.com/2023/11/build-blog-comment-system-based-on-free-cloud-service/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Log4D",
    "logo": {
      "@type": "ImageObject",
      "url": "https://blog.alswl.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.alswl.com/" accesskey="h" title="Log4D (Alt + H)">Log4D</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://en.blog.alswl.com/" title="English Blog">
                    <span>English Blog</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="https://blog.alswl.com/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://blog.alswl.com/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://blog.alswl.com/archives/" title="存档">
                    <span>存档</span>
                </a>
            </li>
            <li>
                <a href="https://blog.alswl.com/about/" title="关于我">
                    <span>关于我</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://blog.alswl.com/">Home</a>&nbsp;»&nbsp;<a href="https://blog.alswl.com/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      如何免费用云服务搭建博客评论系统
    </h1>
    <div class="post-meta"><span title='2023-11-25 17:23:35 +0800 +0800'>2023-11-25</span>&nbsp;·&nbsp;alswl

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#问题">问题</a></li>
    <li><a href="#选型原则">选型原则</a></li>
    <li><a href="#初步方案探索">初步方案探索</a>
      <ul>
        <li><a href="#utteranceshttpsutterances"><a href="https://utteranc.es/">utterances</a></a></li>
        <li><a href="#twikoohttpstwikoojsorgquick-starthtml"><a href="https://twikoo.js.org/quick-start.html">Twikoo</a></a></li>
        <li><a href="#cusdishttpscusdiscom"><a href="https://cusdis.com/">Cusdis</a></a></li>
      </ul>
    </li>
    <li><a href="#横向对比">横向对比</a></li>
    <li><a href="#poc-和实施">PoC 和实施</a>
      <ul>
        <li><a href="#waline-实施">Waline 实施</a></li>
        <li><a href="#utterances-实施">Utterances 实施</a></li>
      </ul>
    </li>
    <li><a href="#小结">小结</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="问题">问题<a hidden class="anchor" aria-hidden="true" href="#问题">#</a></h2>
<p>博客自 2012 年从 WordPress 迁移到静态站点后，就选择了 Disqus 作为评论系统。
但最近 Disqus 硬广告过于频繁，迫切<mark>寻找新的评论系统</mark>。</p>
<p><a href="https://help.disqus.com/en/articles/1717119-ads-faq">Disqus 官方</a> 明确说明，要去掉广告就付费。</p>
<blockquote>
<p>What if I want to remove Ads?
If you&rsquo;d like to remove Disqus Ads from your integration, you may purchase and ads-free subscription from your Subscription and Billing page. More information on Disqus ads-free subscriptions may be found here.</p>
</blockquote>
<p>OK，那再见吧 Disqus，我会找到可靠、免费、易用的评论系统。
最后既然是寻找新的评论系统，现在 2023 年了，
我希望这个新系统<mark>充分使用云服务的便利</mark>，要做到
<mark>免费、可靠、易运维</mark>。</p>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/202311/no-disqus-twitter.png" alt="no-disqus-twitter"  />


</p>
<h2 id="选型原则">选型原则<a hidden class="anchor" aria-hidden="true" href="#选型原则">#</a></h2>
<p>在进入探索之前，我先梳理一下自己的原则和选型要求：</p>
<ul>
<li>数据自有是核心要求
<ul>
<li>确保评论数据完全归属于博主，不会因为使用第三方服务而失去对数据的控制。</li>
</ul>
</li>
<li>服务部署和存储是难点
<ul>
<li>考虑到服务的稳定性和成本，选择一个易于部署且存储成本较低的方案。</li>
</ul>
</li>
<li>访问速度是考虑项
<ul>
<li>评论系统的访问速度直接关系到用户体验，
因此需要选择一个能够提供较快访问速度的系统。</li>
</ul>
</li>
</ul>
<p>从功能上面分析需要的能力：</p>
<ul>
<li>邮件通知</li>
<li>Markdown</li>
<li>内容安全：No Injection</li>
<li>评论审核和删除</li>
<li>授权登录（Optional）</li>
</ul>
<p>非功能需求：</p>
<ul>
<li>低成本：控制在 12 元 / 年</li>
<li>系统稳定</li>
</ul>
<p>通过明晰这些原则和要求，可以更有针对性地选择合适的评论系统，确保满足核心功能和非功能需求。接下来，将根据这些原则，继续探讨如何选择和搭建评论系统。</p>
<h2 id="初步方案探索">初步方案探索<a hidden class="anchor" aria-hidden="true" href="#初步方案探索">#</a></h2>
<p>现在我们初步试验一些方案并进行一些探索，以方便我们熟悉一下当前常见系统的<mark>特性和水准</mark>。</p>
<h3 id="utteranceshttpsutterances"><a href="https://utteranc.es/">utterances</a><a hidden class="anchor" aria-hidden="true" href="#utteranceshttpsutterances">#</a></h3>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/202311/utterances.png" alt="utterances"  />


</p>
<ul>
<li>经常见到的一个评论系统，流行于程序员群体，基于 Github Issues 系统因此免费，需要使用 Github 账号登录</li>
<li>7.8k star</li>
<li>托管在 Github Issues</li>
</ul>
<h3 id="twikoohttpstwikoojsorgquick-starthtml"><a href="https://twikoo.js.org/quick-start.html">Twikoo</a><a hidden class="anchor" aria-hidden="true" href="#twikoohttpstwikoojsorgquick-starthtml">#</a></h3>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/202311/twikoo.png" alt="twikoo"  />


</p>
<ul>
<li>国产方案，基于云服务展开，需要寻找云函数部署环境（大部分收费）</li>
<li>880 star</li>
</ul>
<h3 id="cusdishttpscusdiscom"><a href="https://cusdis.com/">Cusdis</a><a hidden class="anchor" aria-hidden="true" href="#cusdishttpscusdiscom">#</a></h3>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/202311/cusdis.png" alt="cusdis"  />


</p>
<ul>
<li>国产方案，提供免费的 Cloud 服务（但是额度比较受限）</li>
<li>2.4k star</li>
<li>支持迁移</li>
<li>手工通过评论</li>
<li>活跃度不高</li>
</ul>
<p>我同时还看了一些外部的一些方案评测报告：</p>
<ul>
<li><a href="https://gohugo.io/content-management/comments/">Comments | Hugo</a></li>
<li><a href="https://cloud.tencent.com/developer/article/2196035?areaSource=&amp;traceId=">静态博客评论系统的选择 - 腾讯云开发者社区-腾讯云</a></li>
<li><a href="https://sspai.com/post/73412">轻量级开源免费博客评论系统解决方案 （Cusdis + Railway） - 少数派</a></li>
</ul>
<p>根据初步方案探索，我可以明确部署形态基本如下：</p>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/202311/comment-system-deploy-diagram.png" alt="comment-system-deploy-diagram"  />


</p>
<h2 id="横向对比">横向对比<a hidden class="anchor" aria-hidden="true" href="#横向对比">#</a></h2>
<p>这是一个横向对比表格，列举我一些关心的特性以及候选者在这些特性方面的表现。除了上述提到几款常见软件，
我还额外调研了<mark>海外常用的评论 SaaS 服务</mark>：</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Name</th>
          <th style="text-align: left">self-host</th>
          <th style="text-align: left">Official SaaS</th>
          <th style="text-align: left">SaaS Free</th>
          <th style="text-align: left">Star</th>
          <th style="text-align: left">Import Disqus</th>
          <th style="text-align: left">export data</th>
          <th style="text-align: left">Comments</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Utterances</td>
          <td style="text-align: left">x</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">7.8k</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">Github account required</td>
      </tr>
      <tr>
          <td style="text-align: left">Cusdis</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">v?</td>
          <td style="text-align: left">2.3k</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">v?</td>
          <td style="text-align: left">import from Disqus failed</td>
      </tr>
      <tr>
          <td style="text-align: left">Cactus Comments</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">100</td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left">Matrix Protocol, blocked</td>
      </tr>
      <tr>
          <td style="text-align: left">Commento</td>
          <td style="text-align: left">x</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">$10/month</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">Graph Comment</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">Free to $7</td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">Hyvor Talk</td>
          <td style="text-align: left">x</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">$12/month</td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">IntenseDebate</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">?</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">x</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">too old</td>
      </tr>
      <tr>
          <td style="text-align: left">Isso</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">x</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">4.8k</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">sqlite storage</td>
      </tr>
      <tr>
          <td style="text-align: left">Mutt</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">$16/month</td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">Remark42</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">x</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">4.3k</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">full featured, one file storage</td>
      </tr>
      <tr>
          <td style="text-align: left">ReplyBox</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">$5/month</td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">Staticman</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left">2.3k</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">using github as storage</td>
      </tr>
      <tr>
          <td style="text-align: left">Talkyard</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">€4.5/ month</td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">Waline</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left">1.5k</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">Multi Storage / Service Provider supported</td>
      </tr>
      <tr>
          <td style="text-align: left">Twikoo</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">x</td>
          <td style="text-align: left"></td>
          <td style="text-align: left">1.1k</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">v</td>
          <td style="text-align: left">FaaS / MongoDB</td>
      </tr>
  </tbody>
</table>
<p>根据横向对比我们可以得出几个结论：</p>
<ul>
<li>海外传统评论系统数据透明度低，风格也是是古早型系统</li>
<li>官方提供 SaaS 服务普遍需要收费</li>
<li>self-host 的几个产品需要自己搭建服务，没有一键使用免费的 Cloud Provider 路径</li>
</ul>
<p><strong>小结</strong></p>
<p>符合我需求的几款产品是：Utterances、Cusdis、Waline。</p>
<h2 id="poc-和实施">PoC 和实施<a hidden class="anchor" aria-hidden="true" href="#poc-和实施">#</a></h2>
<p>我最后选择了 utterances 和 Waline 进行 PoC，
其中我的<a href="https://en.blog.alswl.com/">英文博客</a>使用了 utterances，
<a href="https://blog.alswl.com/">中文博客</a>使用了 Waline。</p>
<p>为什么不选择 Cusdis 和 Twikoo？因为 Cusdis 使用 PostgreSQL，
而 Twikoo 存储使用腾讯云函数（免费额度有限）或者 MongoDB，
存储上 Waline 选择更多。
另外，作为同类型方案，Waline 是三者贡献者数量最多的，Commit 数量也最多，
社区更有保障。</p>
<h3 id="waline-实施">Waline 实施<a hidden class="anchor" aria-hidden="true" href="#waline-实施">#</a></h3>
<blockquote>
<p>一个搞笑的点，如果这里使用 h3 标题叫做「Waline」，会直接在这里插入一个当前博客的评论框</p>
</blockquote>
<ul>
<li>优点
<ul>
<li>多平台部署</li>
<li>多数据库支持（MongoDB、sqlite、PostgreSQL、MySQL）</li>
<li>评论功能强大</li>
<li>导入工具</li>
<li>活跃度尚可</li>
</ul>
</li>
<li>缺点
<ul>
<li>功能太多，不够克制（好在可以自定义配置）</li>
<li>国产产品</li>
</ul>
</li>
<li>接入流程：
<ul>
<li>找个 Storage 供应商（我选择 <mark>LeanCloud</mark>）</li>
<li>找个 Server 供应商部署（我选择 <mark>Vercel</mark>）</li>
<li>找个邮件发送供应商（我选择了 <mark>Brevo</mark>（原来叫 SendinBlue））</li>
<li>前端部署（Hugo 内集成一下）</li>
</ul>
</li>
</ul>
<p>部署图：</p>
<p>




<img loading="lazy" src="https://e25ba8-log4d-c.dijingchao.com/202311/waline.png" alt="waline"  />


</p>
<p>具体操作，跟随官方文档即可：</p>
<ul>
<li><a href="https://waline.js.org/guide/get-started/">快速上手 | Waline</a></li>
<li><a href="https://waline.js.org/guide/deploy/vercel.html#%E5%A6%82%0E4%BD%95%E9%83%A8%E7%BD%B2">Vercel 部署 | Waline</a></li>
<li>绑定 CName</li>
<li>导入数据
<ul>
<li>转换 <a href="https://waline.js.org/migration/tool.html">数据迁移助手 | Waline</a></li>
<li>导入 <a href="https://console.leancloud.app/apps/yours/storage/import-export">https://console.leancloud.app/apps/yours/storage/import-export</a></li>
</ul>
</li>
<li>配置页面
<ul>
<li>参考配置系统禁用一些评论功能 <a href="https://waline.js.org/reference/client/props.html">https://waline.js.org/reference/client/props.html</a></li>
<li>启用 SMTP
<ul>
<li>配置 <code>AUTHOR_EMAIL</code></li>
<li>配置 <code>SENDER_NAME</code></li>
<li>配置 <code>SENDER_EMAIL</code></li>
</ul>
</li>
<li>服务端配置 <a href="https://waline.js.org/reference/server/config.html#tgtemplate">https://waline.js.org/reference/server/config.html#tgtemplate</a></li>
</ul>
</li>
<li>遇到的问题
<ul>
<li>Disqus 导出的用户数据没有邮箱，导致 gravatar 没有照片显示，无解</li>
<li>邮箱配置需要额外配置环境变量，否则会暴露自己的个人邮箱</li>
</ul>
</li>
</ul>
<p>实施 PR（仅包含前端，因为后端代码包含了密钥，不便于分享）：
<a href="https://github.com/alswl/blog.alswl.com/commit/e34e34810298fd0d716d4c4a467fada25b3a6622">feat: comments on waline · alswl/blog.alswl.com@e34e348</a></p>
<h3 id="utterances-实施">Utterances 实施<a hidden class="anchor" aria-hidden="true" href="#utterances-实施">#</a></h3>
<p>utterances 的部署则更为简单，一个 PR 就可以启用。
<a href="https://github.com/alswl/en.blog.alswl.com/commit/29028f677e362570a8bcaf5316847ddfa3e9d685">feat: comment using utteranc · alswl/en.blog.alswl.com@29028f6 (github.com)</a></p>
<p>也没有什么特色，主打简单省事，考虑我英文博客访问量极低，就简单方案。</p>
<h2 id="小结">小结<a hidden class="anchor" aria-hidden="true" href="#小结">#</a></h2>
<p>最后我选择了 Waline / utterances 作为我的评论系统，两者的部署成本都是 0。</p>
<p>妥协牺牲了一些访问速度、安全性，但进一步增强了数据可控性，完成了 self-host。
从稳定性上面来看，尽管这个系统链路变复杂了，单机上也存在可用性风险，
但依托 Vercel / LeanCloud / Brevo 三家 SaaS 服务商，整体风险可控。</p>
<p>毕竟只是一个小小评论系统，0 成本 + 正常工作就行了。</p>
<p>欢迎在下面评测测试一下哦~</p>

<hr />
<p>原文链接: <a href="https://blog.alswl.com/2023/11/build-blog-comment-system-based-on-free-cloud-service/">如何免费用云服务搭建博客评论系统 | Log4D</a></p>
<p>3a1ff193cee606bd1e2ea554a16353ee</p>
<p>欢迎关注我的微信公众号：<a
href="http://mp.weixin.qq.com/mp/getmasssendmsg?__biz=MzIyNTIwMTU3MQ==#wechat_webview_type=1&amp;wechat_redirect">窥豹</a></p>
<figure>
<img
src="https://e25ba8-log4d-c.dijingchao.com/upload_dropbox/201605/qrcode_for_gh_17e2f9c2caa4_258.jpg"
alt="窥豹" />
<figcaption aria-hidden="true">窥豹</figcaption>
</figure>

    
  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://blog.alswl.com/tags/blog/">Blog</a></li>
      <li><a href="https://blog.alswl.com/tags/hugo/">Hugo</a></li>
      <li><a href="https://blog.alswl.com/tags/waline/">Waline</a></li>
      <li><a href="https://blog.alswl.com/tags/utterances/">Utterances</a></li>
      <li><a href="https://blog.alswl.com/tags/cusdis/">Cusdis</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://blog.alswl.com/2024/01/2023-review/">
    <span class="title">« Prev</span>
    <br>
    <span>2023 年终总结</span>
  </a>
  <a class="next" href="https://blog.alswl.com/2023/09/gitops-and-version-management/">
    <span class="title">Next »</span>
    <br>
    <span>GitOps 和版本管理</span>
  </a>
</nav>

  </footer><div id="waline"></div>
<script type="module">
  import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';

    
    
    init({
      el: '#waline',
      serverURL: 'https://comments-waline-d41d8cd98f.blog.alswl.com',
      emoji: false,
      search: false,
      reaction: true, 
      requiredMeta: ['nick', 'mail'],
      login: 'disable',
      imageUploader: false,
      texRenderer: false,
    });
</script>

</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://blog.alswl.com/">Log4D</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
